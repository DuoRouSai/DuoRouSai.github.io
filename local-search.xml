<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>å¿«é€Ÿå…¥é—¨ rollup.js</title>
    <link href="/2022/06/14/%E6%B5%85%E5%85%A5%E9%97%A8%20rollup.js/"/>
    <url>/2022/06/14/%E6%B5%85%E5%85%A5%E9%97%A8%20rollup.js/</url>
    
    <content type="html"><![CDATA[<h2 id="å¿«é€Ÿå…¥é—¨-rollup-js"><a href="#å¿«é€Ÿå…¥é—¨-rollup-js" class="headerlink" title="å¿«é€Ÿå…¥é—¨ rollup.js"></a>å¿«é€Ÿå…¥é—¨ rollup.js</h2><blockquote><p>Qï¼šä¸ºå•¥è¦å­¦ä¹  rollup.js</p><p>Aï¼šå› ä¸ºå¤§å®¶éƒ½åœ¨å·ï¼ˆrollupï¼‰</p></blockquote><p>å¼€ä¸ªç©ç¬‘ï¼Œä»Šå¤©å­¦ä¹ çš„æ˜¯ JavaScript æ¨¡å—æ‰“åŒ…å™¨ â€“ <strong>rollup.js</strong>ï¼Œè¿™ä¸ªæ—¶å€™æœ‰äººä¼šé—®ï¼Œä¸ºå•¥ä¸ç”¨ webpack æ‰“åŒ…å‘¢ï¼Ÿå®ƒä¿©æœ‰å•¥ä¸ä¸€æ ·çš„å‘¢ï¼Ÿ</p><p>æ‰“åŒ…ç•Œæµä¼ ä¸€å¥è¯ï¼Œ Use webpack for apps, and Rollup for libraries</p><p>åƒæ‰“åŒ…æˆ sdk æˆ– liarary, rollup ä¼šæ¯” webpack æ›´å°æ›´å¿«ï¼Œå…·ä½“åŸå› ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸ªæ–‡ç« <a href="https://juejin.cn/post/6859539849972711437">JS SDK æ„å»ºå®ç° Webpack VS Rollup - æ˜é‡‘ (juejin.cn)</a></p><h3 id="ä½¿ç”¨-rollup-js-åˆ›å»ºç¬¬ä¸€ä¸ª-bundle"><a href="#ä½¿ç”¨-rollup-js-åˆ›å»ºç¬¬ä¸€ä¸ª-bundle" class="headerlink" title="ä½¿ç”¨ rollup.js åˆ›å»ºç¬¬ä¸€ä¸ª bundle"></a>ä½¿ç”¨ rollup.js åˆ›å»ºç¬¬ä¸€ä¸ª bundle</h3><h4 id="å‘½ä»¤è¡Œå½¢å¼"><a href="#å‘½ä»¤è¡Œå½¢å¼" class="headerlink" title="å‘½ä»¤è¡Œå½¢å¼"></a>å‘½ä»¤è¡Œå½¢å¼</h4><p>ä½¿ç”¨ rollup æœ€ç®€å•çš„æ–¹å¼ï¼Œå…¨å±€å®‰è£…</p><figure class="highlight coffeescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> i rollup -g<br></code></pre></div></td></tr></table></figure><p>å®‰è£…å®Œæ¯•ï¼Œå°±é˜”ä»¥ä½¿ç”¨ rollup å‘½ä»¤</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js">rollup <span class="hljs-comment">//å’Œ rollup -h æˆ– rollup --help æ˜¯ä¸€æ ·</span><br></code></pre></div></td></tr></table></figure><p>æˆ‘ä»¬æµ…å†™ä¸€ä¸ªæ¨¡å—åº”ç”¨</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// src/index.js</span><br><span class="hljs-keyword">import</span> module_a <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./module_a&#x27;</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">clog</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(module_a)<br>&#125;<br><span class="hljs-comment">// src/module_a.js</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> module_a = <span class="hljs-string">&#x27;ä¿ºæ˜¯æ¨¡å—A&#x27;</span><br></code></pre></div></td></tr></table></figure><p>ä½¿ç”¨ rollup å‘½ä»¤æ‰“åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">rollup src/index.js -f cjs<br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­ <code>-f</code> é€‰é¡¹ï¼ˆ<code>--output.format</code> çš„ç¼©å†™ï¼‰ï¼Œæ‰€å¯¼å‡ºçš„ commojs ç±»å‹ã€‚è¿˜å¯ä»¥æŒ‡å®š esmã€umdã€iife ç­‰</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// æ‰“åŒ…ä¹‹åçš„ bundle.js æ–‡ä»¶</span><br><span class="hljs-meta">&#x27;use strict&#x27;</span><br><br><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-built_in">exports</span>, <span class="hljs-string">&#x27;__esModule&#x27;</span>, &#123; <span class="hljs-attr">value</span>: <span class="hljs-literal">true</span> &#125;)<br><br><span class="hljs-keyword">var</span> module_a$<span class="hljs-number">1</span> = (module_a = <span class="hljs-string">&#x27;ä¿ºæ˜¯æ¨¡å—A&#x27;</span>)<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">clog</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(module_a$<span class="hljs-number">1</span>)<br>&#125;<br><br><span class="hljs-built_in">exports</span>.<span class="hljs-property">clog</span> = clog<br></code></pre></div></td></tr></table></figure><p>æ­å–œä½ é€šå…³å‘½ä»¤æ‰“åŒ… bundle çš„å…³å¡ ğŸ˜€</p><h4 id="ä½¿ç”¨é…ç½®æ–‡ä»¶"><a href="#ä½¿ç”¨é…ç½®æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨é…ç½®æ–‡ä»¶"></a>ä½¿ç”¨é…ç½®æ–‡ä»¶</h4><p>ä¸Šé¢é‚£ç§æ–¹å¼ï¼Œæ”¾åœ¨é¡¹ç›®ä¸­ï¼Œæ‰“åŒ…ä¼šç•¥æ˜¾çš„ç¹çï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ›å»º rollup.config.js æ–‡ä»¶å†™å…¥æ‰“åŒ…ç›¸å…³é…ç½®</p><p>æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªç®€æ˜“çš„ rollup.config.js</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// rollup.config.js</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-comment">// å…¥å£</span><br>  <span class="hljs-attr">input</span>: <span class="hljs-string">&#x27;src/index.js&#x27;</span>,<br>  <span class="hljs-comment">// å‡ºå£</span><br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-comment">// å†™å…¥çš„æ–‡ä»¶è·¯å¾„</span><br>    <span class="hljs-attr">file</span>: <span class="hljs-string">&#x27;dist/bundle.js&#x27;</span>,<br>    <span class="hljs-comment">// å¯¼å‡ºçš„æ ¼å¼ï¼Œcjs / esm / umd</span><br>    <span class="hljs-attr">format</span>: <span class="hljs-string">&#x27;cjs&#x27;</span>,<br>  &#125;,<br>&#125;<br></code></pre></div></td></tr></table></figure><p>è¿è¡Œ rollup å‘½ä»¤ï¼Œå…¶ä¸­ <code>-c</code> è¡¨æ˜ä½¿ç”¨é…ç½®æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-comment"># é»˜è®¤æŒ‡å‘ rollup.config.js</span><br>rollup -c<br><span class="hljs-comment"># ç¼–å†™ä¸åŒç¯å¢ƒä¸‹ï¼Œé…ç½®æ–‡ä»¶,æ›¿æ¢é»˜è®¤</span><br>rollup -c rollup.config.dev.js<br></code></pre></div></td></tr></table></figure><h3 id="ä½¿ç”¨æ’ä»¶"><a href="#ä½¿ç”¨æ’ä»¶" class="headerlink" title="ä½¿ç”¨æ’ä»¶"></a>ä½¿ç”¨æ’ä»¶</h3><p>å¯ä»¥ä½¿ç”¨å„ç§å„æ ·çš„æ’ä»¶ï¼Œæ¥ä¸ªæ€§åŒ–æ‰“åŒ…ä½ çš„ JavaScript ç¨‹åº</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬ä½¿ç”¨å‹ç¼©æ’ä»¶ï¼Œæ¥å°†ä»£ç éƒ½å‹ç¼©æˆä¸€è¡Œ</p><p>å®‰è£… <code>rollup-plugin-terser</code> ä¾èµ–</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">npm install -D rollup-plugin-terser<br></code></pre></div></td></tr></table></figure><p>ä¿®æ”¹ rollup.config.js æ–‡ä»¶</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// rollup.config.js</span><br><span class="hljs-comment">// rollup-plugin-terser --- plugin</span><br><span class="hljs-keyword">import</span> &#123; terser &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;rollup-plugin-terser&quot;</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>   ...<br>    <span class="hljs-attr">plugins</span>: [<br>      <span class="hljs-title function_">terser</span>()<br>    ]<br>  &#125;;<br></code></pre></div></td></tr></table></figure><p>è¿è¡Œ <code>rollup -c</code> æ‰“åŒ…ï¼Œæ‰“åŒ…å‡ºçš„ bundle.js å°±ä¼šå‹ç¼©åˆ°ä¸€è¡Œï¼Œå‹ç¼©äº†æ–‡ä»¶çš„ä½“ç§¯</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-meta">&#x27;use strict&#x27;</span><br><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-built_in">exports</span>, <span class="hljs-string">&#x27;__esModule&#x27;</span>, &#123; <span class="hljs-attr">value</span>: !<span class="hljs-number">0</span> &#125;)<br><span class="hljs-keyword">var</span> e = (module_a = <span class="hljs-string">&#x27;ä¿ºæ˜¯æ¨¡å—A&#x27;</span>)<br><span class="hljs-built_in">exports</span>.<span class="hljs-property">clog</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e)<br>&#125;<br></code></pre></div></td></tr></table></figure><p>okï¼Œä½ å·²ç»å®Œæˆ rollup å…¥é—¨æ•™å­¦ â­</p><p>è¿˜æœ‰è®¸å¤šå„ç§ <code>plugin</code> ç©æ³•ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹æ–‡ç« </p><p><a href="https://github.com/rollup/awesome">rollup/awesome: âš¡ï¸ Delightful Rollup Plugins, Packages, and Resources (github.com)</a></p><p><a href="https://juejin.cn/post/6844904062312251406">ã€æ°´æ–‡ã€‘å­¦ä¹  Rollup.js æ‰“åŒ…ä¹‹æ’ä»¶è¯¦è§£ - æ˜é‡‘ (juejin.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>æ‰“åŒ…å·¥å…·</category>
      
    </categories>
    
    
    <tags>
      
      <tag>rollup.js</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯ç¯å¢ƒå˜é‡ç®¡ç† .env é‚£äº›äº‹å„¿</title>
    <link href="/2022/06/08/%E5%89%8D%E7%AB%AF%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E7%AE%A1%E7%90%86%20.env%20%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/"/>
    <url>/2022/06/08/%E5%89%8D%E7%AB%AF%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E7%AE%A1%E7%90%86%20.env%20%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰ç«¯ç¯å¢ƒå˜é‡ç®¡ç†-env-é‚£äº›äº‹å„¿"><a href="#å‰ç«¯ç¯å¢ƒå˜é‡ç®¡ç†-env-é‚£äº›äº‹å„¿" class="headerlink" title="å‰ç«¯ç¯å¢ƒå˜é‡ç®¡ç† .env é‚£äº›äº‹å„¿"></a>å‰ç«¯ç¯å¢ƒå˜é‡ç®¡ç† .env é‚£äº›äº‹å„¿</h2><blockquote><p>ğŸ¬ å‰è¨€ï¼šå¼€å‘ä¸­ï¼Œç»å¸¸ä¼šç¢°åˆ° .env æ–‡ä»¶ï¼Œå¸¸ç”¨ä¿å­˜ä¸€äº›æ•æ„Ÿçš„é…ç½®ä¿¡æ¯ï¼Œå¦‚æ•°æ®åº“è¿æ¥è´¦å·å¯†ç ï¼Œç¬¬ä¸‰æ–¹æ’ä»¶çš„ token ç­‰ï¼Œå¯èƒ½æˆ‘ä»¬ç†æ‰€å½“ç„¶è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªç®¡ç†å­˜å‚¨ç¯å¢ƒå˜é‡çš„åœ°æ–¹ï¼Œå¹¶æ²¡æœ‰æ·±ç©¶å®ƒå†…éƒ¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œé€šè¿‡æ·±å…¥æµ…å‡ºçš„æ–¹å¼é‡æ–°äº†è§£ç¯å¢ƒå˜é‡ä»¥åŠå¸¸è§å‡ ç§å¼€å‘ç¯å¢ƒ</p></blockquote><h3 id="01-process-envğŸ’»"><a href="#01-process-envğŸ’»" class="headerlink" title="01 process.envğŸ’»"></a>01 process.envğŸ’»</h3><p>è®¤è¯†.env æ–‡ä»¶å‰ï¼Œé¦–å…ˆè®¤è¯†ä¸‹ process æ˜¯ Node çš„ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œprocess.env ä¿å­˜æ˜¯å½“å‰çš„è¿è¡Œçš„ç¯å¢ƒå˜é‡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// index.js</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(process.<span class="hljs-property">env</span>)<br><br><span class="hljs-comment">// é€šè¿‡ç»ˆç«¯æˆ‘ä»¬æ‰“å°å‡º process.env</span><br>node index.<span class="hljs-property">js</span><br><br><span class="hljs-comment">// æ‰“å°ä¿¡æ¯ï¼šï¼ˆæ˜¾è€Œæ˜“è§ï¼Œæ‰“å°å‡ºå½“å‰è¿è¡Œç¯å¢ƒç›¸å…³ä¿¡æ¯ï¼‰</span><br>&#123;<br>  <span class="hljs-attr">ALLUSERSPROFILE</span>: <span class="hljs-string">&#x27;C:\\ProgramData&#x27;</span>,<br>  <span class="hljs-title class_">Android</span>: <span class="hljs-string">&#x27;D:\\CodeStudy\\AndroidProj\\Sdk\\platform-tools&#x27;</span>,<br>  <span class="hljs-attr">ANDROID_SDK_HOME</span>: <span class="hljs-string">&#x27;D:\\CodeStudy\\Android Studio\\avd&#x27;</span>,<br>  <span class="hljs-attr">APPDATA</span>: <span class="hljs-string">&#x27;C:\\Users\\DuoRouSai\\AppData\\Roaming&#x27;</span>,<br>  <span class="hljs-string">&#x27;asl.log&#x27;</span>: <span class="hljs-string">&#x27;Destination=file&#x27;</span>,<br>  <span class="hljs-title class_">CommonProgramFiles</span>: <span class="hljs-string">&#x27;C:\\Program Files\\Common Files&#x27;</span>,<br>  <span class="hljs-string">&#x27;CommonProgramFiles(x86)&#x27;</span>: <span class="hljs-string">&#x27;C:\\Program Files (x86)\\Common Files&#x27;</span>,<br>  <span class="hljs-title class_">CommonProgramW6432</span>: <span class="hljs-string">&#x27;C:\\Program Files\\Common Files&#x27;</span>,<br>  <span class="hljs-attr">COMPUTERNAME</span>: <span class="hljs-string">&#x27;DUOROUSAI&#x27;</span>,<br>  ...<br>&#125;<br></code></pre></div></td></tr></table></figure><p><strong>è¯¥å¦‚ä½•æ³¨å…¥è‡ªå®šä¹‰å˜é‡ï¼Ÿ</strong></p><p>å•å•åªèƒ½æŸ¥çœ‹ process.env åŸæœ‰çš„é…ç½®ä¿¡æ¯ï¼Œå½“ç„¶ä¸èƒ½æ»¡è¶³æˆ‘ä»¬æ—¥å¸¸çš„å¼€å‘ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³æ³¨å…¥ä¸€äº›è‡ªå®šä¹‰çš„å˜é‡ï¼Œ<code>AUTHOR=Duor</code></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-comment"># é‡‡ç”¨é”®å€¼å¯¹çš„å½¢å¼åŠ å…¥</span><br>AUTHOR=Duor node index.js<br><span class="hljs-comment"># å¤šä¸ªå˜é‡</span><br>AUTHOR=Duor MESSAGE=Hello_KK! node index.js<br></code></pre></div></td></tr></table></figure><p>æ‰“å°ç»“æœï¼š</p><p><img src="https://s2.loli.net/2022/06/08/Oj87VcdNEJpCsoM.png" alt="image-20220608150552762"></p><p>è¿™æ ·åšï¼Œå¸¦æ¥ä¸€ä¸ªåæœï¼š</p><ul><li>ä¸ä¾¿ç®¡ç†ï¼šå½“å˜é‡å¤šæ—¶ï¼Œæ¯æ¬¡å¯åŠ¨éƒ½éœ€è¦æ·»åŠ ï¼Œå˜å¾—éå¸¸çš„ç¹çã€‚</li><li>å¯è¯»æ€§å·®ï¼šç›¸ä¿¡ä½ ä¸å–œæ¬¢åœ¨é•¿é•¿çš„å­—ç¬¦ä¸²å¯»æ‰¾é‚£ä¸ªä½ æƒ³è¦çš„ KEY</li></ul><h3 id="02-env-æ–‡ä»¶-ğŸ—‚ï¸"><a href="#02-env-æ–‡ä»¶-ğŸ—‚ï¸" class="headerlink" title="02 .env æ–‡ä»¶ ğŸ—‚ï¸"></a>02 .env æ–‡ä»¶ ğŸ—‚ï¸</h3><p>æ¥ä¸‹æ¥ï¼Œå°±åˆ°äº† <code>.env</code> æ–‡ä»¶å‡ºåœºäº†ï¼Œä½ å¯ä»¥å†™é…ç½®è¡¨ä¸€æ ·ï¼Œå°†ä¸€äº›é‡è¦çš„ç¯å¢ƒå˜é‡é€šè¿‡é”®å€¼å¯¹å½¢å¼ä¿å­˜åœ¨ <code>.env </code> æ–‡ä»¶ï¼Œä¾‹å¦‚åƒä¸‹é¢è¿™æ ·é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-comment"># .env</span><br><span class="hljs-comment"># APP å½“å‰æ¨¡å¼</span><br>APP_MODE: development<br><br><span class="hljs-comment"># ç¬¬ä¸‰æ–¹æ’ä»¶å¯†é’¥</span><br>OTHER_APP_TOKEN: 123456<br></code></pre></div></td></tr></table></figure><p><strong>é‚£ä¹ˆé—®é¢˜æ¥äº†</strong>ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•è¯»å– <code>.env</code> æ–‡ä»¶é‡Œé¢çš„å†…å®¹å‘¢ï¼Œç´§æ¥ç€ dotenv å‡ºåœºäº†</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-comment"># å®‰è£… dotenv ä¾èµ–</span><br>npm install -save dotenv<br></code></pre></div></td></tr></table></figure><p>å®ƒç›¸å½“äºä¸€ä¸ªè§£ææ¨¡å—ä¸€æ ·ï¼Œå¯ä»¥å°†.env æ–‡ä»¶é‡Œé¢çš„é…ç½®è§£æå‡ºæ¥ï¼Œå¹¶å¸®æˆ‘ä»¬æ³¨å…¥åˆ° process.env é‡Œé¢å»</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> dotenv = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;dotenv&#x27;</span>)<br><br><span class="hljs-comment">// 1.ä¸ä¼  path å‚æ•°ï¼Œä¼šé»˜è®¤éœ€è¦å½“å‰è·¯å¾„ä¸‹çš„ .env æ–‡ä»¶</span><br>dotenv.<span class="hljs-title function_">config</span>()<br><br><span class="hljs-comment">// 2.å½“.env æ–‡ä»¶ä¸åœ¨åŒçº§æ–‡ä»¶å¤¹ï¼Œå¯ä»¥é€šè¿‡ path ä¼ å…¥.env æ–‡ä»¶çš„è·¯å¾„</span><br>dotenv.<span class="hljs-title function_">config</span>(&#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;./.env&#x27;</span> &#125;)<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;APP_MODE:&#x27;</span>, process.<span class="hljs-property">env</span>.<span class="hljs-property">APP_MODE</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;OTHER_APP_TOKEN:&#x27;</span>, process.<span class="hljs-property">env</span>.<span class="hljs-property">OTHER_APP_TOKEN</span>)<br></code></pre></div></td></tr></table></figure><p>æ‰“å°ç»“æœï¼š</p><p><img src="https://s2.loli.net/2022/06/08/lx4TcrQjOBzWCqP.png" alt="image-20220608153428585"></p><h3 id="03-èŠèŠå¼€å‘ä¸­å¸¸è§çš„å‡ ç§ç¯å¢ƒ-ğŸŒ²"><a href="#03-èŠèŠå¼€å‘ä¸­å¸¸è§çš„å‡ ç§ç¯å¢ƒ-ğŸŒ²" class="headerlink" title="03 èŠèŠå¼€å‘ä¸­å¸¸è§çš„å‡ ç§ç¯å¢ƒ ğŸŒ²"></a>03 èŠèŠå¼€å‘ä¸­å¸¸è§çš„å‡ ç§ç¯å¢ƒ ğŸŒ²</h3><p>ä¸€ä¸ªé¡¹ç›®çš„ç”Ÿå‘½å‘¨æœŸå¤§æ¦‚åˆ†ä¸ºå¼€å‘ã€æµ‹è¯•ã€é¢„å‘å¸ƒå’Œæ­£å¼ç¯å¢ƒï¼Œç”±äºå®ƒä»¬ä¹‹é—´ç¯å¢ƒå˜é‡ä¹Ÿä¸åŒï¼Œè¿™ä¹Ÿå¯¼è‡´æˆ‘ä»¬ä¸€ä¸ªé¡¹ç›®å¼€å‘ä¹‹åˆéœ€è¦é…ç½®ä¸åŒç¯å¢ƒä¸‹çš„ .env æ–‡ä»¶</p><blockquote><p>ğŸ§‘â€ğŸ’» å¼€å‘ç¯å¢ƒï¼šä¸€èˆ¬ç”¨äºç¨‹åºåŒå­¦å¼€å‘è¿‡ç¨‹ä¸­è‡ªæµ‹ä½¿ç”¨ï¼Œå½“ä»£ç æœ¬åœ°æµ‹è¯•æ— è¯¯åï¼Œå°±å¯ä»¥éƒ¨ç½²æµ‹è¯•ç¯å¢ƒ</p><p>âš™ï¸ æµ‹è¯•ç¯å¢ƒï¼šå½“å¼€å‘ææµ‹åï¼Œç”±æµ‹è¯•åŒå­¦è¿›è¡Œä¸€ç³»åˆ—çš„åŠŸèƒ½ï¼Œè‡ªåŠ¨åŒ–ï¼Œæ¥å£æµ‹è¯•ç­‰</p><p>âŒ¨ï¸ é¢„å‘å¸ƒç¯å¢ƒï¼šå®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æµ‹è¯•ç¯å¢ƒï¼Œæ˜¯è¿‡æ¸¡åˆ°æ­£å¼ç¯å¢ƒä¹‹å‰çš„æœ€åä¸€æ­¥éªŒè¯ï¼Œä¸€èˆ¬ä½¿ç”¨çš„æ˜¯æ­£å¼ç¯å¢ƒçš„ç¯å¢ƒå˜é‡</p><p>âœ”ï¸ æ­£å¼ç¯å¢ƒï¼šä¹Ÿå«ç”Ÿäº§ç¯å¢ƒï¼Œæ˜¯ç›´æ¥é¢å‘ç”¨æˆ·æ‰€ä½¿ç”¨çš„ï¼Œä½¿ç”¨çš„æ˜¯æ­£å¼ç¯å¢ƒçš„ç¯å¢ƒå˜é‡ã€‚</p></blockquote><p>è¯è¯´åˆ°è¿™ï¼Œæœ‰äº›å°ä¼™ä¼´å¯èƒ½ç–‘é—®ï¼Œé‚£ä¹ˆå¤šç¯å¢ƒå˜é‡ï¼Œéš¾é“æˆ‘ä»¬ä¸€ä¸ªä¸ªæ‰‹åŠ¨é…ç½®ä¹ˆï¼Ÿä½œä¸ºç¨‹åºçŒ¿ï¼ˆæ‡’ ğŸ¦¥ï¼‰ï¼Œèƒ½è‡ªåŠ¨åŒ–ï¼Œå°±ç»ä¸æ‰‹åŠ¨ã€‚</p><p>ä¸‹é¢ä¾‹å­ï¼Œé€šè¿‡è¿è¡Œä¸åŒçš„å‘½ä»¤è¡Œï¼Œä»è€Œæ³¨å…¥ä¸åŒçš„ç¯å¢ƒå˜é‡</p><p><strong>å®‰è£…ä¾èµ–ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-comment"># å®‰è£… dotenv ä¾èµ–</span><br>npm install -save dotenv<br><br><span class="hljs-comment"># å®‰è£… cross-envï¼Œç”¨äºè§£å†³windowsç”¨æˆ·è®¾ç½®ç¯å¢ƒå˜é‡ç—›ç‚¹</span><br>npm install --save-dev cross-env<br></code></pre></div></td></tr></table></figure><p><strong>åˆ†åˆ«åˆ›å»ºä¸¤ä¸ªä¸åŒç¯å¢ƒå˜é‡çš„æ–‡ä»¶ï¼Œ<code>.env.production</code> å’Œ <code>.env.development</code></strong></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash"><span class="hljs-comment"># .env.development</span><br><span class="hljs-comment"># APP å½“å‰æ¨¡å¼:å¼€å‘ç¯å¢ƒ</span><br>APP_MODE: development<br><br><span class="hljs-comment"># ç¬¬ä¸‰æ–¹æ’ä»¶å¯†é’¥</span><br>OTHER_APP_TOKEN: 123456<br><br><span class="hljs-comment">#---------------------------------------------------</span><br><br><span class="hljs-comment"># .env.production</span><br><span class="hljs-comment"># APP å½“å‰æ¨¡å¼:ç”Ÿäº§ç¯å¢ƒ</span><br>APP_MODE: production<br><br><span class="hljs-comment"># ç¬¬ä¸‰æ–¹æ’ä»¶å¯†é’¥</span><br>OTHER_APP_TOKEN: 789<br></code></pre></div></td></tr></table></figure><p><strong>é…ç½® package.json çš„ scripts</strong></p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json"><span class="hljs-attr">&quot;scripts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;start:dev&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;cross-env mode=development node index.js&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;start:prod&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;cross-env mode=production node index.js&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br></code></pre></div></td></tr></table></figure><p><strong>åˆ›å»º config.js æ–‡ä»¶</strong></p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// config.js</span><br><span class="hljs-comment">// å¼•å…¥ dotenv ä¾èµ–</span><br><span class="hljs-keyword">const</span> dotenv = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;dotenv&#x27;</span>)<br><br><span class="hljs-comment">// åˆ¤æ–­å½“å‰ç¯å¢ƒï¼š ç”Ÿæˆç¯å¢ƒ / å¼€å‘ç¯å¢ƒ</span><br><span class="hljs-keyword">let</span> envFile =<br>  process.<span class="hljs-property">env</span>.<span class="hljs-property">mode</span> === <span class="hljs-string">&#x27;development&#x27;</span> ? <span class="hljs-string">&#x27;.env.development&#x27;</span> : <span class="hljs-string">&#x27;.env.production&#x27;</span><br><br><span class="hljs-comment">// æ³¨å…¥ç¯å¢ƒå˜é‡</span><br>dotenv.<span class="hljs-title function_">config</span>(&#123; <span class="hljs-attr">path</span>: envFile &#125;)<br><br><span class="hljs-comment">// å¯¼å‡ºç¯å¢ƒå˜é‡</span><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">APP_MODE</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">APP_MODE</span>,<br>  <span class="hljs-attr">OTHER_APP_TOKEN</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">OTHER_APP_TOKEN</span>,<br>&#125;<br></code></pre></div></td></tr></table></figure><p><strong>index.js</strong></p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// å¯¼å…¥ config.js æ¨¡å—</span><br><span class="hljs-keyword">const</span> &#123; <span class="hljs-variable constant_">APP_MODE</span>, <span class="hljs-variable constant_">OTHER_APP_TOKEN</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./config&#x27;</span>)<br><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;APP_MODE:&#x27;</span>, <span class="hljs-variable constant_">APP_MODE</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;OTHER_APP_TOKEN:&#x27;</span>, <span class="hljs-variable constant_">OTHER_APP_TOKEN</span>)<br></code></pre></div></td></tr></table></figure><p><strong>åˆ†åˆ«è¿è¡Œ<code>npm run start:dev</code> å’Œ <code>npm run start:prod</code></strong></p><p><img src="../AppData/Roaming/Typora/typora-user-images/image-20220608174033367.png" alt="image-20220608174033367"></p><p>é€šè¿‡ç»ˆç«¯æ‰“å°çš„ä¿¡æ¯å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å·²ç»å®ç°äº†ï¼Œé€šè¿‡ npm å‘½ä»¤ï¼Œè½»æ¾å®ç°è‡ªåŠ¨æ³¨å…¥ä¸åŒçš„ç¯å¢ƒå˜é‡</p>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯å·¥ç¨‹åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰ç«¯å·¥ç¨‹åŒ–</tag>
      
      <tag>ç¯å¢ƒå˜é‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>React â€˜s Context ç”¨æ³•</title>
    <link href="/2022/06/07/React%20%E2%80%98s%20Context%20%E7%94%A8%E6%B3%95/"/>
    <url>/2022/06/07/React%20%E2%80%98s%20Context%20%E7%94%A8%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h2 id="React-â€˜s-Context-ç”¨æ³•"><a href="#React-â€˜s-Context-ç”¨æ³•" class="headerlink" title="React â€˜s Context ç”¨æ³•"></a>React â€˜s Context ç”¨æ³•</h2><blockquote><p>æ­¤æ–‡ç« æ‰€æåŠ context æŒ‡çš„æ˜¯æ–°ç‰ˆ Context APIï¼ˆReact 16.3 å¼•å…¥ï¼‰ï¼Œåœ¨è¿™ä¸ªç‰ˆæœ¬ä»¥ä¸‹çš„ context æŒ‡çš„æ˜¯æ—§æ—¶ Context API</p></blockquote><h3 id="01-What-is-Context-API"><a href="#01-What-is-Context-API" class="headerlink" title="01 What is Context API ?"></a>01 What is Context API ?</h3><p>ä¸€èˆ¬ React å¼€å‘åº”ç”¨ï¼Œ æ•°æ®ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡ props è‡ªä¸Šè€Œä¸‹ä¼ é€’ã€‚ä½†æ˜¯å¯¹äºä¸€äº›ç±»ä¼¼ç”¨æˆ·åå¥½ã€ä¸»é¢˜ themes é‡‡ç”¨è¿™ç§æ–¹å¼å±‚å±‚ä¼ é€’ï¼Œéšç€å±‚æ•°çš„å¢å¤šï¼Œä¼šæ˜¾å¾—åŠå…¶ç¹çã€‚æ‰€ä»¥ React å®˜æ–¹å°±æå‡ºäº† <code>Context API</code> æ–¹æ¡ˆï¼Œå®ƒåŸç†æ˜¯åœ¨ä¸Šå±‚å®¹å™¨ä¸­ï¼Œæš´éœ²å‡ºä¸Šä¸‹æ–‡ context ,å­ç»„ä»¶é€šè¿‡ <code>context.Consumer</code> ã€<code>Class.contextType</code> æˆ– <code>useContext</code> æ–¹å¼</p><p>æ¥æ”¶å‚æ•°ã€‚èµ·åˆ° <code>ä¼ é€’</code> å’Œ <code>å…±äº«</code> çš„ä½œç”¨</p><h3 id="02-æ¡ˆä¾‹åœºæ™¯"><a href="#02-æ¡ˆä¾‹åœºæ™¯" class="headerlink" title="02 æ¡ˆä¾‹åœºæ™¯"></a>02 æ¡ˆä¾‹åœºæ™¯</h3><blockquote><p>ä¸è¦ä¸€è‚¡è„‘çƒ­å»ä½¿ç”¨ context ï¼Œå®ƒçš„ä½¿ç”¨åŒæ—¶ä¹Ÿä¼šå¸¦æ¥ä¸€ä¸ªå‰¯ä½œç”¨ï¼Œè¿™æ ·ä¼šä½¿å¾—ç»„ä»¶çš„å¤ç”¨æ€§å˜å·®ã€‚</p></blockquote><ul><li>themesã€ç”¨æˆ·åå¥½ç­‰ï¼Œéœ€è¦å…¨å±€å…±äº«çš„æ•°æ®</li><li>react-redux, å®ƒå…¶å®å°±æ˜¯ä½¿ç”¨ context å»å®ç° React å’Œ Redux å»ºç«‹è¿æ¥</li></ul><h3 id="03-Context-API-ç”¨æ³•"><a href="#03-Context-API-ç”¨æ³•" class="headerlink" title="03 Context API ç”¨æ³•"></a>03 Context API ç”¨æ³•</h3><h4 id="åˆ›å»º-context"><a href="#åˆ›å»º-context" class="headerlink" title="åˆ›å»º context"></a>åˆ›å»º context</h4><h5 id="context-createContext"><a href="#context-createContext" class="headerlink" title="context.createContext"></a>context.createContext</h5><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">//åˆ›å»ºä¸€ä¸ª Context å¯¹è±¡</span><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">MyContext</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createContext</span>(defaultValue)<br></code></pre></div></td></tr></table></figure><h4 id="ä¼ é€’-context"><a href="#ä¼ é€’-context" class="headerlink" title="ä¼ é€’ context"></a>ä¼ é€’ context</h4><h5 id="context-Provider"><a href="#context-Provider" class="headerlink" title="context.Provider"></a>context.Provider</h5><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// ä¼ é€’ context</span><br>&lt;<span class="hljs-title class_">MyContext</span>.<span class="hljs-property">Provider</span> value=&#123;<span class="hljs-comment">/* æŸä¸ªå€¼ */</span>&#125;&gt;<br></code></pre></div></td></tr></table></figure><h4 id="æ¥æ”¶-context"><a href="#æ¥æ”¶-context" class="headerlink" title="æ¥æ”¶ context"></a>æ¥æ”¶ context</h4><p>æ–¹å¼ï¼š</p><ul><li>useContextï¼ˆå‡½æ•°ç»„ä»¶ï¼‰</li><li>Context.Consumerï¼ˆé€šç”¨ï¼‰</li><li>Context.contextTypeï¼ˆç±»åç»„ä»¶ï¼‰</li></ul><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, &#123; useContext, <span class="hljs-title class_">Component</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><br><span class="hljs-keyword">const</span> themes = &#123;<br>  <span class="hljs-attr">light</span>: &#123;<br>    <span class="hljs-attr">foreground</span>: <span class="hljs-string">&#x27;#000000&#x27;</span>,<br>    <span class="hljs-attr">background</span>: <span class="hljs-string">&#x27;#eeeeee&#x27;</span>,<br>  &#125;,<br>  <span class="hljs-attr">dark</span>: &#123;<br>    <span class="hljs-attr">foreground</span>: <span class="hljs-string">&#x27;#ffffff&#x27;</span>,<br>    <span class="hljs-attr">background</span>: <span class="hljs-string">&#x27;#222222&#x27;</span>,<br>  &#125;,<br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ThemeContext</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createContext</span>(&#123;<br>  <span class="hljs-attr">theme</span>: themes.<span class="hljs-property">light</span>,<br>  <span class="hljs-attr">toggleTheme</span>: <span class="hljs-function">() =&gt;</span> &#123;&#125;,<br>&#125;)<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> [theme, setTheme] = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useState</span>(themes.<span class="hljs-property">light</span>)<br><br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">toggleTheme</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-title function_">setTheme</span>(theme === themes.<span class="hljs-property">dark</span> ? themes.<span class="hljs-property">light</span> : themes.<span class="hljs-property">dark</span>)<br>  &#125;<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeContext.Provider</span></span></span><br><span class="hljs-tag"><span class="language-xml">      <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;&#123;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">theme</span>,</span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">toggleTheme</span>,</span></span><br><span class="hljs-tag"><span class="language-xml">      &#125;&#125;</span></span><br><span class="hljs-tag"><span class="language-xml">    &gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">Toolbar</span> /&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeContext.Provider</span>&gt;</span></span><br>  )<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Toolbar</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">ThemedButton</span> /&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  )<br>&#125;<br><br><span class="hljs-comment">// 1. useContext æ¥æ”¶ context ä¸­çš„å€¼ï¼ˆå‡½æ•°ç»„ä»¶ï¼‰</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">ThemedButton</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> &#123; theme, toggleTheme &#125; = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">ThemeContext</span>)<br><br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span></span></span><br><span class="hljs-tag"><span class="language-xml">      <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">background:</span> <span class="hljs-attr">theme.background</span>, <span class="hljs-attr">color:</span> <span class="hljs-attr">theme.foreground</span> &#125;&#125;</span></span><br><span class="hljs-tag"><span class="language-xml">      <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;toggleTheme&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">    &gt;</span></span><br><span class="language-xml">      toggleTheme</span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br>  )<br>&#125;<br><br><span class="hljs-comment">// 2. Context.Consumer æ¥æ”¶ context ä¸­çš„å€¼ï¼ˆé€šç”¨ï¼‰</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">ThemedButton</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeContext.Consumer</span>&gt;</span></span><br><span class="language-xml">      &#123;(&#123; theme, toggleTheme &#125;) =&gt; (</span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">button</span></span></span><br><span class="hljs-tag"><span class="language-xml">          <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">background:</span> <span class="hljs-attr">theme.background</span>, <span class="hljs-attr">color:</span> <span class="hljs-attr">theme.foreground</span> &#125;&#125;</span></span><br><span class="hljs-tag"><span class="language-xml">          <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;toggleTheme&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        &gt;</span></span><br><span class="language-xml">          toggleTheme</span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">      )&#125;</span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeContext.Consumer</span>&gt;</span></span><br>  )<br>&#125;<br><br><span class="hljs-comment">// 3. Context.contextType æ¥æ”¶ context ä¸­çš„å€¼ï¼ˆç±»åç»„ä»¶ï¼‰</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ThemedButton</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Component</span> &#123;<br>  <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">let</span> &#123; theme, toggleTheme &#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span><br>    <span class="hljs-keyword">return</span> (<br>      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span></span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">background:</span> <span class="hljs-attr">theme.background</span>, <span class="hljs-attr">color:</span> <span class="hljs-attr">theme.foreground</span> &#125;&#125;</span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;toggleTheme&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">      &gt;</span></span><br><span class="language-xml">        toggleTheme</span><br><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br>    )<br>  &#125;<br>&#125;<br><span class="hljs-title class_">ThemedButton</span>.<span class="hljs-property">contextType</span> = <span class="hljs-title class_">ThemeContext</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
    </categories>
    
    
    <tags>
      
      <tag>React</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MySQL ä½œä¸š</title>
    <link href="/2022/06/07/MySQL%20%E4%BD%9C%E4%B8%9A/"/>
    <url>/2022/06/07/MySQL%20%E4%BD%9C%E4%B8%9A/</url>
    
    <content type="html"><![CDATA[<h2 id="MySQL-ä½œä¸š"><a href="#MySQL-ä½œä¸š" class="headerlink" title="MySQL ä½œä¸š"></a>MySQL ä½œä¸š</h2><h3 id="é¢˜ç›®-1"><a href="#é¢˜ç›®-1" class="headerlink" title="é¢˜ç›® 1"></a>é¢˜ç›® 1</h3><p>1.æ»¡è¶³ WHERE æ¡ä»¶çš„æ•°æ®æœ‰ 10W è¡Œï¼Œè¯·é—®è¿™ä¸ªæ—¶å€™ä½¿ç”¨ LIMIT 1 æ¥è¿›è¡ŒæŸ¥è¯¢æ—¶ï¼Œéœ€è¦æ‰«æå¤šå°‘è¡Œæ•°æ®ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><blockquote><p>é€šè¿‡æ‰“å°æ‰§è¡Œè®¡åˆ’å‘ç°ï¼Œä½¿ç”¨ LIMIT 1 è¿›è¡Œæ‰«æè¡Œæ•°æ˜¯ 100207</p></blockquote><p><strong>SQL è¯­å¥æ‰§è¡Œé¡ºåº:</strong></p><blockquote><p>FROM =&gt; ON =&gt; JOIN =&gt; WHERE =&gt; â€¦ =&gt; LIMIT</p></blockquote><p><strong>åŸç†ï¼š</strong>åœ¨å®é™… SQL è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ˜¯ç”± <code>FROM</code> å¼€å§‹ï¼Œ æ¯ä¸ªæ­¥éª¤éƒ½ä¼šä¸ºä¸‹ä¸€æ­¥éª¤ç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿè¡¨ï¼Œå†æ‰§è¡Œ <code>LIMIT</code> ä¹‹å‰å…ˆæ‰§è¡Œ <code>WHERE</code>ï¼Œé€šè¿‡æ‰§è¡Œè®¡åˆ’ <code>using where</code>å‘ç°ï¼Œ limit 1 æŸ¥è¯¢æ—¶å¹¶æ²¡æœ‰æ‰¾åˆ°å¯ç”¨çš„ç´¢å¼•ï¼Œä»è€Œåªèƒ½é€šè¿‡ WHERE æ¡ä»¶è¿‡æ»¤è·å–ç»“æœã€‚</p><p><img src="https://s2.loli.net/2022/05/23/uT1DlApUJKHtiM4.png" alt="image-20220523150148384"></p><h3 id="é¢˜ç›®-2"><a href="#é¢˜ç›®-2" class="headerlink" title="é¢˜ç›® 2"></a>é¢˜ç›® 2</h3><p>2.åˆ¤æ–­åœ¨ä¸åŒçš„ SQL è¯­å¥ä¸­ä½¿ç”¨ AS åˆ«åæ˜¯å¦æ­£ç¡®ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> order_number <span class="hljs-keyword">AS</span> order_no,<br>       <span class="hljs-built_in">SUM</span>(price <span class="hljs-operator">*</span> quantity) <span class="hljs-keyword">AS</span> amount<br><span class="hljs-keyword">FROM</span> orderdetails<br><span class="hljs-keyword">WHERE</span> order_no <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;001&#x27;</span>(é”™è¯¯âŒ)<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> order_noï¼ˆæ­£ç¡®âœ”ï¼‰<br><span class="hljs-keyword">HAVING</span> total <span class="hljs-operator">&gt;</span> <span class="hljs-number">60000</span>;<br></code></pre></div></td></tr></table></figure><blockquote><p>åœ¨ MySQL ä¸­ï¼Œ<code>WHERE</code> é”™è¯¯ ï¼›<code>GROUP BY</code> æ­£ç¡®</p></blockquote><p><strong>åŸç†ï¼š</strong></p><p>åœ¨æ ‡å‡† SQL è¯­å¥æ‰§è¡Œé¡ºåºä¸‹ï¼Œ <code>WHERE</code> å’Œ <code>GROUP BY</code> éƒ½æ˜¯ä¸å¯ä»¥ä½¿ç”¨åˆ«åçš„</p><blockquote><p>FROM =&gt; ON =&gt; JOIN =&gt; WHERE =&gt; GROUP BY =&gt; â€¦ =&gt; SELECT =&gt; â€¦</p></blockquote><p>ä½†æ˜¯ï¼Œ<a href="https://dev.mysql.com/doc/refman/5.7/en/problems-with-alias.html">MySQL ä¸‹ <code>GROUP BY</code> æ˜¯å¯ä»¥çš„</a>ï¼Œ åŸå› æ˜¯ MySQL å¯¹æŸ¥è¯¢è¿›è¡ŒåŠ å¼º</p><p><img src="https://s2.loli.net/2022/05/23/s3qBE6jLJxN4tCA.png" alt="image-20220523171715797"></p><h3 id="é¢˜ç›®-3"><a href="#é¢˜ç›®-3" class="headerlink" title="é¢˜ç›® 3"></a>é¢˜ç›® 3</h3><p>3.å¦‚æœè¡¨ T ä¸­æ²¡æœ‰å­—æ®µ kï¼Œè€Œä½ æ‰§è¡Œäº†è¿™ä¸ªè¯­å¥ <code>select * from T where k=1</code>ï¼Œé‚£è‚¯å®šæ˜¯ä¼šæŠ¥â€œä¸å­˜åœ¨è¿™ä¸ªåˆ—â€çš„é”™è¯¯ï¼šâ€œ<code>Unknown column &#39;a&#39; in &#39;where clause&#39;</code>â€ã€‚é‚£ä¹ˆè¿™ä¸ªé”™è¯¯æ˜¯åœ¨æˆ‘ä»¬ä¸Šé¢æåˆ°çš„å“ªä¸ªé˜¶æ®µæŠ¥å‡ºæ¥çš„å‘¢ï¼Ÿ</p><blockquote><p><code>åˆ†æå™¨é˜¶æ®µ</code>æŠ¥é”™</p></blockquote><p><img src="https://s2.loli.net/2022/05/23/D3Q7b8wMShfFONc.png"></p><p><strong>åŸç†ï¼š</strong>åœ¨ MySQL çš„ server å±‚ä¸­ï¼Œ åˆ†æå™¨ä¼šå¯¹ SQL è¯­å¥è¿›è¡Œ<strong>è¯æ³•åˆ†æï¼Œè¯­æ³•åˆ†æï¼Œè¯­ä¹‰åˆ†æ</strong>ï¼Œå…¶ä¸­ï¼š</p><blockquote><p>è¯æ³•åˆ†æï¼šåˆ†æ SQL è¯­å¥ä¸­çš„å­—ç¬¦ä¸²ä»£è¡¨ä»€ä¹ˆï¼Œç”Ÿæˆè§£ææ ‘ã€‚å¦‚å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºè¡¨ã€åˆ—ç­‰â€¦</p><p>è¯­æ³•åˆ†æï¼šæ ¹æ®è¯æ³•åˆ†æçš„ç»“æœï¼Œè¯­æ³•åˆ†æå™¨ä¼šæ ¹æ®è¯­æ³•è§„åˆ™ï¼Œåˆ¤æ–­ä½ è¾“å…¥çš„è¿™ä¸ª SQL è¯­å¥æ˜¯å¦æ»¡è¶³ MySQL è¯­æ³•ã€‚ å¦‚é€šè¿‡å…³é”®å­— select å¾—çŸ¥æ˜¯ä¸€æ¡æŸ¥è¯¢è¯­å¥</p><p>é¢„å¤„ç†å™¨ï¼šå¯¹ SQL ä¸­çš„è¡¨ï¼Œå­—æ®µç­‰å†…å®¹æ£€æŸ¥æ˜¯å¦å­˜åœ¨ï¼Œå¦‚ xx è¡¨æ˜¯å¦å­˜åœ¨ï¼Œxx è¡¨ xx åˆ—æ˜¯å¦å­˜åœ¨</p></blockquote><p>ç”±æ­¤å¯è§ï¼Œå½“è¡¨ T ä¸­æ²¡æœ‰å­—æ®µ k ä¸å­˜åœ¨æ—¶ï¼Œåœ¨åˆ†æå™¨é˜¶æ®µçš„é¢„å¤„ç†å™¨é˜¶æ®µå°±ä¼šæŠ¥é”™</p><h3 id="é¢˜ç›®-4"><a href="#é¢˜ç›®-4" class="headerlink" title="é¢˜ç›® 4"></a>é¢˜ç›® 4</h3><p>4.ä»¥ä¸‹ SQL æ˜¯å¦ä¼šå¼‚å¸¸ï¼Ÿå¦‚æœå¼‚å¸¸ï¼Œé‚£ä¹ˆæ­£ç¡®çš„åº”è¯¥æ€ä¹ˆå†™ï¼Ÿ</p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> order_number <span class="hljs-keyword">AS</span> order_no,<br>       <span class="hljs-built_in">SUM</span>(price <span class="hljs-operator">*</span> quantity) <span class="hljs-keyword">AS</span> amount<br><span class="hljs-keyword">FROM</span> orderdetails<br><span class="hljs-keyword">WHERE</span> <span class="hljs-built_in">SUM</span>(price <span class="hljs-operator">*</span> quantity) <span class="hljs-operator">&gt;</span> <span class="hljs-number">100</span><br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> order_no;<br></code></pre></div></td></tr></table></figure><blockquote><p>ä¸Šè¿° SQL æ˜¯<strong>é”™è¯¯</strong>çš„</p></blockquote><p><strong>å»ºè¡¨è¯­å¥ï¼š</strong></p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-comment">-- åˆ›å»ºè¡¨orderdetails</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `orderdetails` (<br>  `order_number` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT,<br>  `price` <span class="hljs-type">float</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>  `quantity` <span class="hljs-type">int</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>,<br>  <span class="hljs-keyword">PRIMARY</span> KEY (`order_number`)<br>) ENGINE<span class="hljs-operator">=</span>InnoDB AUTO_INCREMENT<span class="hljs-operator">=</span><span class="hljs-number">3</span> <span class="hljs-keyword">DEFAULT</span> CHARSET<span class="hljs-operator">=</span>utf8mb4 <span class="hljs-keyword">COLLATE</span><span class="hljs-operator">=</span>utf8mb4_bin;<br><br><span class="hljs-comment">-- æ’å…¥ä¸¤æ¡æ•°æ®</span><br><span class="hljs-comment">-- 1ã€‚</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> testsql.orderdetails<br>(price, quantity)<br><span class="hljs-keyword">VALUES</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>);<br><span class="hljs-comment">-- 2.</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> testsql.orderdetails<br>(price, quantity)<br><span class="hljs-keyword">VALUES</span>(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>);<br></code></pre></div></td></tr></table></figure><p><strong>éªŒè¯è¿‡ç¨‹ï¼š</strong></p><p>ä¸éš¾å‘ç°ï¼Œå› ä¸ºåœ¨ <code>WHERE</code> å­å¥ä¸­ä½¿ç”¨äº† group function å¯¼è‡´æŠ¥é”™ï¼Œå› ä¸ºåœ¨ SQL è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œ<code>WHERE</code> æ‰§è¡Œæ˜¯è¦æ¯” <code>AGG_FUNC</code> è¦æ—©ï¼Œå¯¼è‡´åœ¨æ‰§è¡Œ <code>WHERE</code> æ— æ³•è¯†åˆ«èšåˆå‡½æ•°å¯¼è‡´æŠ¥é”™ã€‚</p><p><img src="https://s2.loli.net/2022/05/23/vN6UyMfnCoV8wud.png" alt="image-20220523181020640"></p><p><strong>æ­£ç¡®å†™æ³•ï¼š</strong></p><p><code>HAVING</code> å­å¥æ˜¯åœ¨ <code>AGG_FUNC</code> æ­¥éª¤ä¹‹åï¼Œ æ‰€ä»¥ä½¿ç”¨å…¶ä»£æ›¿ <code>WHERE</code> è¿›è¡Œåˆ¤æ–­</p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> order_number <span class="hljs-keyword">AS</span> order_no,<br>       <span class="hljs-built_in">SUM</span>(price <span class="hljs-operator">*</span> quantity) <span class="hljs-keyword">AS</span> amount<br><span class="hljs-keyword">FROM</span> orderdetails<br><span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> order_no;<br><span class="hljs-keyword">HAVING</span> amount <span class="hljs-operator">&gt;</span><span class="hljs-number">100</span><br></code></pre></div></td></tr></table></figure><p><img src="https://s2.loli.net/2022/05/23/TUODY6zXhwqP3uG.png" alt="image-20220523181700483"></p><h3 id="é¢˜ç›®-5"><a href="#é¢˜ç›®-5" class="headerlink" title="é¢˜ç›® 5"></a>é¢˜ç›® 5</h3><p>5.ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± ï¼Ÿè¿æ¥æ± å¦‚ä½•ä¿æ´»ï¼Ÿ</p><blockquote><p>æ•°æ®è¿æ¥æ± ä¸»è¦ä½œç”¨è®©æ•°æ®åº“è¿æ¥å¾—åˆ°å¤ç”¨ï¼Œé¿å…äº†é¢‘ç¹å»ºç«‹ï¼Œé‡Šæ”¾è¿æ¥è€Œäº§ç”Ÿå¤§é‡æ€§èƒ½å’Œæ—¶é—´æ¶ˆè€—ï¼Œæå‡æ•°æ®åº“æ€§èƒ½å’Œç¼©çŸ­å“åº”æ—¶é—´ã€‚å¦ä¸€æ–¹é¢è¿˜å¯ä»¥ç»Ÿä¸€ç®¡ç†è¿æ¥ï¼Œé˜²æ­¢æ•°æ®åº“è¿æ¥æ³„æ¼å¯¼è‡´çš„å®‰å…¨çš„éšæ‚£ã€‚</p><p>è¿æ¥æ± ä¿æ´»æœºåˆ¶ï¼Œä¸šåŠ¡ä»£ç åœ¨ä½å³°æ—¶ä¼šé™ä½ get()åŠ¨ä½œï¼Œæ‰€ä»¥è¿æ¥æ± ä¸­çš„è¿æ¥åœ¨é•¿æ—¶é—´ä¸ç”¨æ—¶ä¼šå¯¼è‡´å¤±æ•ˆï¼Œæ­¤æ—¶ä¿æ´»çº¿ç¨‹åœ¨ç›‘æµ‹åˆ° get()çš„ä½¿ç”¨é¢‘ç‡è¾ƒä½æ—¶ï¼Œä¼šæ¨¡æ‹Ÿä¸šåŠ¡ç¨‹åºè°ƒç”¨ get()è·å–è¿æ¥åå‘é€å¿ƒè·³åŒ…ï¼Œç„¶åå†é€šè¿‡ free()å°†è¢«ä¿æ´»çš„è¿æ¥æ”¾å›é˜Ÿåˆ—ä¸­ï¼Œè¾¾åˆ°è¿æ¥æ± ä¸­æ‰€æœ‰è¿æ¥ä¿æ´»çš„ç›®çš„ã€‚</p></blockquote><h3 id="é¢˜ç›®-6"><a href="#é¢˜ç›®-6" class="headerlink" title="é¢˜ç›® 6"></a>é¢˜ç›® 6</h3><p>6.ä»¥ä¸‹ä¸¤æ¡ SQLï¼Œå‡è®¾å­—æ®µéƒ½ä¸å­˜åœ¨ç´¢å¼•çš„å‰æä¸‹ï¼š</p><ol><li>å“ªä¸ªæ€§èƒ½æ›´å¥½ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</li><li>è¿™ä¸¤æ¡è¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹ã€‚</li></ol><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> a <span class="hljs-keyword">from</span> t <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> a <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-keyword">null</span>;<br><span class="hljs-keyword">select</span> <span class="hljs-keyword">distinct</span> a <span class="hljs-keyword">from</span> t;<br></code></pre></div></td></tr></table></figure><ul><li><strong>æ‰“å°æ‰§è¡Œè®¡åˆ’å‘ç°ï¼š</strong></li></ul><p>ç¬¬ä¸€æ¡ SQL è¯­å¥</p><p><img src="https://s2.loli.net/2022/05/24/eKfER8n5ztNPGJv.png" alt="image-20220524142321457"></p><p>ç¬¬äºŒæ¡ SQL è¯­å¥</p><p><img src="https://s2.loli.net/2022/05/24/BG8MgEi5xcIjVT6.png" alt="image-20220524142655749"></p><blockquote><p>ç¬¬äºŒæ¡ SQL æ€§èƒ½ä¼šæ›´å¥½ï¼Œå‰è€…æ€»å…±æ‰§è¡Œ 4 ä¸ªæ­¥éª¤ï¼Œè€Œåè€…æ€»å…±æ‰§è¡Œ 3 ä¸ªæ­¥éª¤</p></blockquote><ul><li><p>ä¸¤æ¡è¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹</p><ul><li><p>ç¬¬ä¸€æ¡ SQL è¯­å¥</p><blockquote><p>a.æ‰§è¡Œ FROM è·å–æ•°æ®è¡¨ï¼Œç”Ÿæˆè™šæ‹Ÿè¡¨ vt1</p><p>b.æ‰§è¡Œ GROUP BY æ“ä½œï¼ŒæŒ‰ç…§åˆ—å a è¿›è¡Œåˆ†ç»„ =&gt; vt2</p><p>c.æ‰§è¡Œ SLELECT æ“ä½œï¼ŒæŒ‰ç…§åˆ—å a è¿›è¡Œé€‰å–æ“ä½œ =&gt; vt3</p><p>d.æ‰§è¡Œ ORDER BY æ“ä½œï¼Œç”Ÿæˆæ¸¸æ ‡ vc4</p></blockquote></li><li><p>ç¬¬äºŒæ¡ SQL è¯­å¥</p><blockquote><p>a.æ‰§è¡Œ FROM è·å–æ•°æ®è¡¨ï¼Œç”Ÿæˆè™šæ‹Ÿè¡¨ vt1</p><p>b.æ‰§è¡Œ SLELECT æ“ä½œï¼ŒæŒ‰ç…§åˆ—å a è¿›è¡Œé€‰å–æ“ä½œ =&gt; vt2</p><p>c.æ‰§è¡Œ DISTINCT æ“ä½œï¼Œæ ¹æ®åˆ—å aï¼Œå»é‡ =&gt; vt3</p></blockquote></li></ul></li></ul><h3 id="é¢˜ç›®-7"><a href="#é¢˜ç›®-7" class="headerlink" title="é¢˜ç›® 7"></a>é¢˜ç›® 7</h3><p>7.ä»€ä¹ˆæ ·çš„è¡¨ï¼Œé€‚åˆä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><blockquote><p>ä¸€èˆ¬æ¥è¯´ï¼Œæ•°æ®ç›¸å¯¹ç¨³å®šã€ä¸å¸¸æ›´æ–°çš„è¡¨é€‚åˆä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ã€‚ å› ä¸ºè¿™ç±»æ•°æ®è¡¨ä¸éœ€è¦å¸¸å¸¸çš„æ›´æ–°ï¼Œæ›´å¤šèµ·åˆ°ä¸€ä¸ªæŸ¥è¯¢çš„ä½œç”¨ã€‚è‹¥é‡åˆ°é¢‘ç¹çš„è¯·æ±‚æ—¶ï¼Œé€šè¿‡æŸ¥è¯¢ç¼“å­˜ï¼Œå‘½ä¸­åˆ™ç›´æ¥è¿”å›ç»“æœé›†ï¼Œä»è€Œå‡å°‘ SQL æ‰§è¡Œæ¬¡æ•°ï¼Œä¼˜åŒ– SQL çš„æ€§èƒ½ã€‚</p><p>å…·ä½“ä¸¾ä¾‹ï¼Œæ¯”å¦‚åœ°ç†åŒºåŸŸæ•°æ®è¡¨ï¼ŒåŒºåŸŸä»£å·è¿™ç±»æ•°æ®è¡¨ç­‰ç­‰</p><p>æ¯”å¦‚åœ¨æŸç”µå•†å¹³å°ï¼Œæœ‰ä¸ªåœ°å€ç®¡ç†ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡é€‰æ‹©çœå¸‚åŒºå­˜å‚¨è‡ªå·±çš„åœ°å€ï¼Œè€Œ çœå¸‚åŒºè¿™äº›åœ°å€ï¼Œå¾€å¾€æ˜¯ä¸éœ€è¦é¢‘ç¹æ›´æ–°çš„ï¼Œèµ·åˆ°å¾€å¾€æ˜¯æ ‡è¯†å’Œé€‰æ‹©çš„ä½œç”¨ï¼Œæ‰€ä»¥ç”¨æˆ·åœ¨é€‰æ‹©çœå¸‚åŒºè”åŠ¨æ—¶ï¼Œä¼šé¢‘ç¹æŸ¥è¯¢çœå¸‚åŒºæ•°æ®è¡¨ï¼Œç»è¿‡æŸ¥è¯¢ç¼“å­˜æ­¥éª¤æ—¶ï¼Œåˆ°æŸ¥è¯¢å¼•ç”¨è¡¨ï¼Œé€šè¿‡ä¸€ä¸ªå“ˆå¸Œå€¼ï¼ˆæŸ¥è¯¢çš„æ•°æ®åº“ï¼Œå®¢æˆ·ç«¯åè®®ï¼ŒæŸ¥è¯¢æœ¬èº«ç­‰ï¼‰ï¼Œåˆ¤æ–­æ˜¯å¦å‘½ä¸­ï¼ˆå¯¹æ¯”åŸå§‹ SQL è¯­å¥ï¼Œæ‰€ä»¥ä»»ä½•å­—ç¬¦ä¸Šçš„ä¸åŒï¼Œä¾‹å¦‚ç©ºæ ¼ï¼Œæ³¨é‡Šç­‰éƒ½ä¼šå¯¼è‡´ç¼“å­˜ä¸ä¼šå‘½ä¸­ï¼‰ï¼Œå‡è‹¥å‘½ä¸­ï¼Œåˆ™ç›´æ¥è¿”å›ç¼“å­˜ä¸­çš„ç»“æœï¼Œå¦åˆ™æ­£å¸¸èµ°æ‰§è¡Œ SQL è¯­å¥ã€‚</p></blockquote><h3 id="é¢˜ç›®-8"><a href="#é¢˜ç›®-8" class="headerlink" title="é¢˜ç›® 8"></a>é¢˜ç›® 8</h3><p>8.ä»¥ä¸‹ SQL ä¼šæŠ¥ä»€ä¹ˆé”™ï¼Ÿæ˜¯åœ¨åˆ†æå™¨å“ªä¸ªæ­¥éª¤æŠ›å‡ºçš„é”™è¯¯ï¼Ÿ</p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql">elect id, name <span class="hljs-keyword">from</span> `<span class="hljs-keyword">user</span>` <span class="hljs-keyword">where</span> `id` <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;<br></code></pre></div></td></tr></table></figure><blockquote><p>è¯æ³•åˆ†æé˜¶æ®µæŠ¥é”™</p></blockquote><p><strong>åˆ†æå™¨æ‰§è¡Œè¿‡ç¨‹ï¼š</strong></p><blockquote><p>è¯æ³•åˆ†æï¼šåˆ†æ SQL è¯­å¥ä¸­çš„å­—ç¬¦ä¸²ä»£è¡¨ä»€ä¹ˆï¼Œç”Ÿæˆè§£ææ ‘ã€‚å¦‚å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºè¡¨ã€åˆ—ç­‰â€¦</p><p>è¯­æ³•åˆ†æï¼šæ ¹æ®è¯æ³•åˆ†æçš„ç»“æœï¼Œè¯­æ³•åˆ†æå™¨ä¼šæ ¹æ®è¯­æ³•è§„åˆ™ï¼Œåˆ¤æ–­ä½ è¾“å…¥çš„è¿™ä¸ª SQL è¯­å¥æ˜¯å¦æ»¡è¶³ MySQL è¯­æ³•ã€‚ å¦‚é€šè¿‡å…³é”®å­— select å¾—çŸ¥æ˜¯ä¸€æ¡æŸ¥è¯¢è¯­å¥</p><p>é¢„å¤„ç†å™¨ï¼šå¯¹ SQL ä¸­çš„è¡¨ï¼Œå­—æ®µç­‰å†…å®¹æ£€æŸ¥æ˜¯å¦å­˜åœ¨ï¼Œå¦‚ xx è¡¨æ˜¯å¦å­˜åœ¨ï¼Œxx è¡¨ xx åˆ—æ˜¯å¦å­˜åœ¨</p></blockquote><p>ç”±æ­¤å¯è§ï¼Œå½“ SQL è¯­å¥ï¼Œæ‰§è¡Œåˆ°<code>è¯æ³•åˆ†æ</code>æ—¶ï¼Œå‘ç°æ— æ³•è§£æ <code>elect</code> è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä»æ— æ³•ç”Ÿæˆè§£ææ ‘</p><h3 id="é¢˜ç›®-9"><a href="#é¢˜ç›®-9" class="headerlink" title="é¢˜ç›® 9"></a>é¢˜ç›® 9</h3><p>9.å¯¹ä»¥ä¸‹ SQL è¿›è¡Œä¼˜åŒ–å™¨åˆ†æï¼Œä¼šå‡ºç°å“ªäº›æƒ…å†µï¼Ÿ</p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> t1 <span class="hljs-keyword">join</span> t2 <span class="hljs-keyword">on</span> t1.c <span class="hljs-operator">=</span> <span class="hljs-number">10</span> <span class="hljs-keyword">and</span> t2.d <span class="hljs-operator">=</span> <span class="hljs-number">20</span>;<br></code></pre></div></td></tr></table></figure><p><strong>a.t1 å’Œ t2 éƒ½æ— ç´¢å¼•æ—¶ï¼Œå„ 100 æ¡æ•°æ®</strong></p><p><img src="https://s2.loli.net/2022/05/25/jKaRmZnMIbF48Hf.png" alt="image-20220524220236404"></p><p><strong>b.t1 å’Œ t2 éƒ½æ— ç´¢å¼•æ—¶ï¼Œå„ 10w æ¡æ•°æ®</strong></p><p><img src="https://s2.loli.net/2022/05/25/W7UiTMCPGusLjb6.png" alt="image-20220524221455728"></p><p><strong>c.t1ï¼ˆæ·»åŠ ï¼‰ï¼Œt2 å…¶ä¸­ä¸€ä¸ªæœ‰ç´¢å¼•ï¼Œå„ 100 æ¡æ•°æ®</strong></p><p><img src="https://s2.loli.net/2022/05/25/SPpNxA25i6Lab7O.png" alt="image-20220524223037569"></p><p><strong>d.t1ï¼ˆæ·»åŠ ï¼‰ï¼Œt2 å…¶ä¸­ä¸€ä¸ªæœ‰ç´¢å¼•ï¼Œå„ 10w æ•°æ®</strong></p><p><img src="https://s2.loli.net/2022/05/25/R38ISgNVYEbBxzr.png" alt="image-20220524222136239"></p><p><strong>e.t1ï¼Œt2 éƒ½æœ‰ç´¢å¼•ï¼Œå„ 100 æ¡æ•°æ®</strong></p><p><img src="https://s2.loli.net/2022/05/25/BkEzZHVY14ySUwA.png" alt="image-20220524223128738"></p><p><strong>f.t1ï¼Œt2 éƒ½æœ‰ç´¢å¼•ï¼Œå„ 10w æ¡æ•°æ®</strong></p><p><img src="https://s2.loli.net/2022/05/25/PUh9QfydI5rsTGB.png" alt="image-20220524222256582"></p><p><strong>g.å½“ t1 æ•°æ®é‡å¤§äº t2 æ•°æ®é‡</strong></p><p><img src="https://s2.loli.net/2022/05/25/7DNFmMjHJTLCycz.png" alt="image-20220524223816271"></p><p><strong>h.å½“ t2 æ•°æ®é‡å¤§äº t1 æ•°æ®é‡</strong></p><p><img src="https://s2.loli.net/2022/05/25/7N91neHYTVC3Bq5.png" alt="image-20220524223956446"></p><p><strong>åˆ†æå¯å¾—ï¼š</strong></p><blockquote><p>é»˜è®¤æƒ…å†µï¼šï¼ˆæ•°æ®é‡ä¸€è‡´ï¼Œæ— ç´¢å¼•ï¼‰</p><p>1.é€‰æ‹© join å…³é”®å­—å‰é¢çš„è¡¨ä½œä¸ºé©±åŠ¨è¡¨</p><p>å½“ t1, t2 å…¶ä¸­ä¸€ä¸ªæ‹¥æœ‰ç´¢å¼•</p><p>1.æ•°æ®é‡å°‘ï¼Œä¼˜åŒ–å™¨é€‰æ‹©å…¶ä¸­æœ‰ç´¢å¼•ä¸€æ–¹ï¼ˆæ•°æ®è¡¨ï¼‰ï¼Œä½œä¸ºé©±åŠ¨è¡¨</p><p>2.æ•°æ®é‡å¤§ï¼Œä¼˜åŒ–å™¨é€‰æ‹©å…¶ä¸­æœ‰ç´¢å¼•ä¸€æ–¹ï¼ˆæ•°æ®è¡¨ï¼‰ï¼Œä½œä¸ºé©±åŠ¨è¡¨ï¼Œéšç€æ•°æ®é‡å¢å¤§ï¼Œæ‰«æ rows è¶Šå°‘</p><p>å½“ t1, t2 éƒ½æ‹¥æœ‰ç´¢å¼•</p><p>1.é€‰ä¸­æ•°æ®é‡å°‘çš„ä¸€æ–¹ï¼ˆæ•°æ®è¡¨ï¼‰ï¼Œä½œä¸ºé©±åŠ¨è¡¨</p><p>2.æ•°æ®é‡ä¸€è‡´ï¼Œé€‰æ‹©é»˜è®¤ join å…³é”®å­—å‰é¢çš„è¡¨ä½œä¸ºé©±åŠ¨è¡¨</p></blockquote><p><strong>æ€»ç»“ï¼š</strong></p><ul><li><p>MySQL ä¼˜åŒ–å™¨æ˜¯åŸºäºæˆæœ¬æ¥é€‰æ‹©æœ€ä¼˜æ‰§è¡Œæ–¹æ¡ˆçš„ï¼Œå“ªä¸ªæˆæœ¬(rows)æœ€å°‘é€‰å“ªä¸ª</p></li><li><p>æ•°æ®é‡å¤§çš„æ—¶å€™ï¼Œé€‚å½“ä½¿ç”¨ç´¢å¼•å¯ä»¥ï¼Œå‡å°‘æ‰«ææˆæœ¬</p></li></ul><h3 id="é¢˜ç›®-10"><a href="#é¢˜ç›®-10" class="headerlink" title="é¢˜ç›® 10"></a>é¢˜ç›® 10</h3><p>10.å¦‚ä¸‹è¡¨ï¼Œè¯·ç¼–å†™ SQLï¼Œå®Œæˆä»¥ä¸‹é¢˜ç›®ï¼š</p><p><strong>score è¡¨æ•°æ®å¦‚ä¸‹ï¼š</strong></p><p><img src="https://s2.loli.net/2022/05/24/9QTehy8jWmzxIZw.png" alt="image-20220524182200241"></p><p>1.ä»æ¯ä¸ªåˆ†ç»„ä¸­æ‰¾åˆ°åˆ†æ•°æ’åç¬¬ä¸€çš„ç”¨æˆ·ï¼›</p><p><img src="https://s2.loli.net/2022/05/24/Xfk3cy6ZvxQ2ENF.png" alt="image-20220524181758561"></p><p>â€‹ 2.ä»æ¯ä¸ªåˆ†ç»„ä¸­æ‰¾åˆ°åˆ†æ•°æ’åå‰äºŒçš„ç”¨æˆ·ï¼›</p><p><img src="https://s2.loli.net/2022/05/24/osYugqISCLZFGed.png" alt="image-20220524181813817"></p><p>â€‹ 3.è·å–æ¯ä¸ªæ¯ç»„ä¸‹æœ€åä¸¤ååˆ†æ•°çš„å¹³å‡å€¼ï¼›</p><p><img src="https://s2.loli.net/2022/05/24/9AENMnSgUTRY6BQ.png" alt="image-20220524182118477"></p><h3 id="é¢˜ç›®-11"><a href="#é¢˜ç›®-11" class="headerlink" title="é¢˜ç›® 11"></a>é¢˜ç›® 11</h3><p>11.å¦‚æœç”¨ left join çš„è¯ï¼Œå·¦è¾¹çš„è¡¨ä¸€å®šæ˜¯é©±åŠ¨è¡¨å—ï¼Ÿè¯·ä¸¾ä¾‹è¯´æ˜ã€‚</p><blockquote><p>ä¸ä¸€å®šï¼Œä¸‹æ–¹ä¸¾ä¸ªæ —å­</p></blockquote><p>åˆ›å»ºä¸¤ä¸ªç»“æ„ç›¸åŒçš„è¡¨ t1 å’Œ t2 ï¼Œå…¶ä¸­è¡¨ t1 çš„ c å­—æ®µæœ‰ç´¢å¼•ï¼Œè€Œè¡¨ t2 æ²¡æœ‰</p><p><strong>åˆ†åˆ«æ‰§è¡Œä¸¤ä¸ªä¸åŒ SQL è¯­å¥</strong></p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-comment">-- ç¬¬ä¸€æ¡SQL</span><br>explain <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> t1 <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> t2 <span class="hljs-keyword">on</span> t1.c <span class="hljs-operator">=</span> t2.c <span class="hljs-keyword">and</span>  t2.d <span class="hljs-operator">=</span> t1.d ;<br><span class="hljs-comment">-- ç¬¬äºŒæ¡ SQL</span><br>explain <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> t1 <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> t2 <span class="hljs-keyword">on</span> t1.c <span class="hljs-operator">=</span> t2.c <span class="hljs-keyword">where</span>  t2.d <span class="hljs-operator">=</span> t1.d ;<br></code></pre></div></td></tr></table></figure><p><strong>æ‰“å° explainï¼š</strong></p><p><img src="https://s2.loli.net/2022/05/25/uD3lmx8IkP6YdCH.png" alt="image-20220524233059949"></p><p><img src="https://s2.loli.net/2022/05/24/v9LW7eSrfQFdUu3.png" alt="image-20220524234121992"></p><blockquote><p>å¯ä»¥å‘ç°ï¼Œå½“æŠŠè¢«é©±åŠ¨è¡¨çš„å­—æ®µæ”¾åœ¨ where æ¡ä»¶é‡Œé¢åšç­‰å€¼åˆ¤æ–­æˆ–ä¸ç­‰å€¼åˆ¤æ–­ï¼Œä¼šä½¿å¾— left join å…³é”®å­—å³è¾¹ t2 ä½œä¸ºé©±åŠ¨è¡¨ã€‚</p><p>é€šè¿‡ show warnings, å¯ä»¥çœ‹åˆ°ï¼ŒMySQL ä¼˜åŒ–å™¨æŠŠè¿™æ¡è¯­å¥çš„ left join æ”¹å†™æˆäº† joinï¼Œç„¶åå› ä¸ºè¡¨ t1 çš„ c ä¸Šæœ‰ç´¢å¼•ï¼Œå°±æŠŠè¡¨ t2 ä½œä¸ºé©±åŠ¨è¡¨ï¼Œè¿™æ ·å°±å¯ä»¥ç”¨ä¸Šè¡¨ t1 çš„ c ç´¢å¼•ã€‚</p></blockquote><h1 id="è¯¾å¤–é¢˜"><a href="#è¯¾å¤–é¢˜" class="headerlink" title="è¯¾å¤–é¢˜"></a>è¯¾å¤–é¢˜</h1><ol><li><p>è¯¾ç¨‹ä¸­ï¼Œè¯¦ç»†è®²è¿°äº†ä¸€æ¡æŸ¥è¯¢ SQL æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Œé‚£ä¹ˆï¼Œä¸€æ¡æ›´æ–° SQL åˆæ˜¯å¦‚ä½•æ‰§è¡Œå‘¢ï¼Ÿ</p><p><img src="https://upload-images.jianshu.io/upload_images/5229824-491ffbb8cbe104d6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/658/format/webp" alt="img"></p></li><li><p>MySQL é€šè¿‡å“ªä¸ªå‚æ•°å¯ä»¥è®¾ç½®ä¸ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ï¼Ÿ</p><p>æŸ¥è¯¢æ—¶å¢åŠ ä¸€ä¸ª SQL_NO_CACHE æŒ‡ä»¤</p><figure class="highlight sql"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> SQL_NO_CACHE field_1, field_2, ... <span class="hljs-keyword">from</span> table_1;<br></code></pre></div></td></tr></table></figure></li></ol>]]></content>
    
    
    <categories>
      
      <category>MySQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MySQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ·±å…¥ç†è§£:ç®€å•å®ç° redux å’Œ react-redux</title>
    <link href="/2022/06/07/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%20%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0%20redux%20%E5%92%8C%20react-redux/"/>
    <url>/2022/06/07/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%20%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0%20redux%20%E5%92%8C%20react-redux/</url>
    
    <content type="html"><![CDATA[<h2 id="æ·±å…¥ç†è§£-ç®€å•å®ç°-redux-å’Œ-react-redux"><a href="#æ·±å…¥ç†è§£-ç®€å•å®ç°-redux-å’Œ-react-redux" class="headerlink" title="æ·±å…¥ç†è§£: ç®€å•å®ç° redux å’Œ react-redux"></a>æ·±å…¥ç†è§£: ç®€å•å®ç° redux å’Œ react-redux</h2><p>CodeSandboxï¼š<a href="https://codesandbox.io/s/easy-redux-app-f20fgl">easy-redux-app - CodeSandbox</a></p><blockquote><p>Redux æ˜¯ä¸€ä¸ªåŸºäºå•æ–¹å‘æ•°æ®æµçš„çŠ¶æ€ç®¡ç†ï¼Œ react-redux çš„ä½œç”¨å¸®åŠ© Redux å’Œ React å»ºç«‹é“¾æ¥</p></blockquote><h3 id="01-redux"><a href="#01-redux" class="headerlink" title="01 redux"></a>01 redux</h3><img src="https://s2.loli.net/2022/05/20/x3feWN8UFSBnsED.gif" alt="GIF 2022-5-20 11-16-44" style="zoom:33%;" /><h4 id="æ ¸å¿ƒåŸç†"><a href="#æ ¸å¿ƒåŸç†" class="headerlink" title="æ ¸å¿ƒåŸç†"></a>æ ¸å¿ƒåŸç†</h4><h5 id="createStore"><a href="#createStore" class="headerlink" title="createStore"></a>createStore</h5><p>createStore æ˜¯æ•´ä¸ª redux çš„æ ¸å¿ƒåŸç†ï¼Œå…¶ä¸»è¦çš„åŠŸèƒ½å°±æ˜¯åˆ›å»º store , å¹¶æš´éœ²<code>getState</code>,<code>dispatch</code>,<code>subscribe</code> æ–¹æ³•</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createStore</span>(<span class="hljs-params">reducer</span>) &#123;<br>  <span class="hljs-comment">// ä¿å­˜å…¨å±€çŠ¶æ€</span><br>  <span class="hljs-keyword">let</span> state = <span class="hljs-literal">undefined</span><br>  <span class="hljs-comment">// è®¢é˜…åˆ—è¡¨</span><br>  <span class="hljs-keyword">let</span> listeners = []<br><br>  <span class="hljs-comment">// åˆå§‹åŒ–state</span><br>  <span class="hljs-title function_">dispatch</span>(&#123; <span class="hljs-attr">type</span>: <span class="hljs-title class_">ActionTypes</span>.<span class="hljs-property">INIT</span> &#125;)<br><br>  <span class="hljs-comment">// è·å–å…¨å±€çŠ¶æ€</span><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">getState</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> state<br>  &#125;<br><br>  <span class="hljs-comment">// dispatch ç”¨äºä¼ é€’ action è§¦å‘ reducer</span><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">dispatch</span>(<span class="hljs-params">action</span>) &#123;<br>    state = <span class="hljs-title function_">reducer</span>(state, action)<br>    <span class="hljs-comment">// state å‘ç”Ÿæ”¹å˜ï¼Œå‘å¸ƒï¼ˆå¤„ç†è®¢é˜…ï¼Œæ›´æ–°ç»„ä»¶ï¼‰</span><br>    listeners.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">listener</span>) =&gt;</span> <span class="hljs-title function_">listener</span>())<br>  &#125;<br><br>  <span class="hljs-comment">// å‘å¸ƒè®¢é˜…ï¼šä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šåœ¨æ¯æ¬¡ state æ›´æ–°çš„æ—¶å€™è¢«è°ƒç”¨</span><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">subscribe</span>(<span class="hljs-params">listener</span>) &#123;<br>    <span class="hljs-comment">// åŠ å…¥æ›´æ–°åˆ—è¡¨</span><br>    listeners.<span class="hljs-title function_">push</span>(listener)<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">unsubscribe</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-comment">// ç”¨äºå¸è½½ç»„ä»¶æ—¶ï¼Œå–æ¶ˆè®¢é˜…</span><br>      listeners = listeners.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">func</span>) =&gt;</span> func !== listener)<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> &#123;<br>    getState,<br>    dispatch,<br>    subscribe,<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="ä¸­é—´ä»¶"><a href="#ä¸­é—´ä»¶" class="headerlink" title="ä¸­é—´ä»¶"></a>ä¸­é—´ä»¶</h4><h5 id="applyMiddleware"><a href="#applyMiddleware" class="headerlink" title="applyMiddleware"></a>applyMiddleware</h5><p>applyMiddleware ç”¨äºæ‰©å±• Redux æ·»åŠ ä¸­é—´ä»¶ï¼ŒMiddleware å¯ä»¥è®©ä½ åŒ…è£… <code>store</code> çš„ <code>dispatch</code> æ–¹æ³•æ¥è¾¾åˆ°ä½ æƒ³è¦çš„ç›®çš„ï¼Œå…¶ä¸­ <code>compose</code> æ–¹æ³•ï¼Œå¯ä»¥è®©å¤šä¸ª middleware å¯ä»¥è¢«ç»„åˆåˆ°ä¸€èµ·ä½¿ç”¨ï¼Œå½¢æˆ middleware é“¾ã€‚å¸¸è§ middleware æ¯”å¦‚è¯´ æ—¥å¿—æ”¶é›†å™¨ï¼Œ å´©æºƒæ—¥å¿—æ”¶é›†å™¨ç­‰</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// applyMiddleware æ‰©å±• Redux</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">applyMiddleware</span>(<span class="hljs-params">...middleWares</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">createStore</span>) =&gt;</span> <span class="hljs-function">(<span class="hljs-params">reducer</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> store = <span class="hljs-title function_">createStore</span>(reducer)<br>    <span class="hljs-keyword">let</span> dispatch = store.<span class="hljs-property">dispatch</span><br>    <span class="hljs-keyword">const</span> middlewareAPI = &#123;<br>      <span class="hljs-attr">getState</span>: store.<span class="hljs-property">getState</span>,<br>      dispatch,<br>    &#125;<br>    <span class="hljs-keyword">const</span> chain = middleWares.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">middleware</span>) =&gt;</span> <span class="hljs-title function_">middleware</span>(middlewareAPI))<br>    dispatch = <span class="hljs-title function_">compose</span>(...chain)(dispatch)<br>    <span class="hljs-keyword">return</span> &#123;<br>      ...store,<br>      dispatch,<br>    &#125;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// compose èšåˆå‡½æ•°</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">compose</span>(<span class="hljs-params">...funcs</span>) &#123;<br>  <span class="hljs-keyword">if</span> (funcs.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">args</span>) =&gt;</span> args<br>  &#125;<br><br>  <span class="hljs-keyword">if</span> (funcs.<span class="hljs-property">length</span> === <span class="hljs-number">1</span>) &#123;<br>    <span class="hljs-keyword">return</span> funcs[<span class="hljs-number">0</span>]<br>  &#125;<br>  <span class="hljs-keyword">return</span> funcs.<span class="hljs-title function_">reduce</span>(<br>    <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span><br>      <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span><br>        <span class="hljs-title function_">a</span>(<span class="hljs-title function_">b</span>(...args))<br>  )<br>&#125;<br></code></pre></div></td></tr></table></figure><h4 id="åˆå¹¶-reducer-è¾…åŠ©å‡½æ•°"><a href="#åˆå¹¶-reducer-è¾…åŠ©å‡½æ•°" class="headerlink" title="åˆå¹¶ reducer è¾…åŠ©å‡½æ•°"></a>åˆå¹¶ reducer è¾…åŠ©å‡½æ•°</h4><h5 id="combineReducers"><a href="#combineReducers" class="headerlink" title="combineReducers"></a>combineReducers</h5><p>combineReducers ç”¨äºåˆå¹¶å¤šä¸ª reducer , é‡åˆ°å¤æ‚çš„åº”ç”¨æˆ‘ä»¬éœ€è¦æ‹†åˆ†ä¸åŒçš„ reducer ï¼Œæ‹†åˆ†åçš„æ¯ä¸ªå‡½æ•°è´Ÿè´£ç‹¬ç«‹ç®¡ç† state çš„ä¸€éƒ¨åˆ†ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">combineReducers</span>(<span class="hljs-params">reducers</span>) &#123;<br>  <span class="hljs-keyword">let</span> nextState = &#123;&#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">combination</span>(<span class="hljs-params">state, action</span>) &#123;<br>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(reducers).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[key, reducers]</span>) =&gt;</span> &#123;<br>      nextState[key] = <span class="hljs-title function_">reducers</span>(nextState[key], action)<br>    &#125;)<br>    <span class="hljs-keyword">return</span> nextState<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="02-react-redux"><a href="#02-react-redux" class="headerlink" title="02 react-redux"></a>02 react-redux</h3><p><img src="https://s2.loli.net/2022/05/20/AJ8K1VD4HGRpa3Q.png" alt="image-20220520114557068"></p><h4 id="æ ¸å¿ƒåŸç†-1"><a href="#æ ¸å¿ƒåŸç†-1" class="headerlink" title="æ ¸å¿ƒåŸç†"></a>æ ¸å¿ƒåŸç†</h4><h5 id="Provider"><a href="#Provider" class="headerlink" title="Provider"></a>Provider</h5><p>Provider ç”¨äºä¸Šå±‚ç»„ä»¶æ³¨å…¥ store ï¼Œå…¶åŸç†ï¼Œå°±æ˜¯é€šè¿‡ react <code>createContext</code> æ–¹æ³•ï¼Œå°† store æš´éœ²åˆ°ä¸Šä¸‹æ–‡ , ä»¥ä¾¿å®¹å™¨ç»„ä»¶å¯ä»¥æ¥æ”¶ store</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, &#123; createContext &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><br><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ª context</span><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ReactReduxContext</span> = <span class="hljs-title function_">createContext</span>()<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Provider</span>(<span class="hljs-params">&#123; store, children &#125;</span>) &#123;<br>  <span class="hljs-keyword">return</span> (<br>    <span class="hljs-comment">// æ³¨å…¥ store</span><br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ReactReduxContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&#123;store&#125;</span>&gt;</span></span><br><span class="language-xml">      &#123;children&#125;</span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">ReactReduxContext.Provider</span>&gt;</span></span><br>  )<br>&#125;<br></code></pre></div></td></tr></table></figure><h5 id="connect"><a href="#connect" class="headerlink" title="connect"></a>connect</h5><p>connect åˆ›å»ºå®¹å™¨ç»„ä»¶ï¼Œå°†æ¥æ”¶åˆ° store é€šè¿‡ props æ³¨å…¥åˆ° <code>Component</code> ç»„ä»¶ä¸­ï¼Œå…¶ä¸­ <code>mapStateToProps</code>ï¼Œ <code>mapDispatchToProps</code> åˆ†åˆ«ç”¨äºæ˜ å°„ state å’Œ dispatch å¯¹åº” action</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">connect</span> = (<span class="hljs-params">mapStateToProps, mapDispatchToProps</span>) =&gt; <span class="hljs-function">(<span class="hljs-params">Component</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">extends</span> <span class="hljs-title class_">React</span>.<span class="hljs-property">Component</span> &#123;<br>        <span class="hljs-comment">// æ¥æ”¶ context ä¸Šä¸‹æ–‡</span><br>        <span class="hljs-keyword">static</span> contextType = <span class="hljs-title class_">ReactReduxContext</span>;<br>        <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) &#123;<br>            <span class="hljs-variable language_">super</span>(props);<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = &#123;&#125;<br>        &#125;<br>        <span class="hljs-title function_">componentDidMount</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">const</span> &#123; subscribe, getState,dispatch &#125; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>;<br>            <span class="hljs-comment">// æŒ‚è½½å®Œæ¯•åï¼Œåˆæ¬¡æ¸²æŸ“</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123;<br>                <span class="hljs-comment">// è¿”å›ä¸€ä¸ªçº¯å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¼šä¸ç»„ä»¶çš„ props åˆå¹¶</span><br>                ...<span class="hljs-title function_">mapStateToProps</span>(<span class="hljs-title function_">getState</span>()),<br>                <span class="hljs-comment">// å‡½æ•°ä¸­dispatchæ–¹æ³•ä¼šå°†action creatorçš„è¿”å›å€¼ä½œä¸ºå‚æ•°æ‰§è¡Œã€‚è¿™äº›å±æ€§ä¼šè¢«åˆå¹¶åˆ°ç»„ä»¶çš„ props ä¸­</span><br>                ...<span class="hljs-title function_">mapDispatchToProps</span>(dispatch)<br>            &#125;)<br>            <span class="hljs-comment">// è®¢é˜…æ›´æ–°</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">unsubscribe</span> = <span class="hljs-title function_">subscribe</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setState</span>(&#123;<br>                    ...<span class="hljs-title function_">mapStateToProps</span>(<span class="hljs-title function_">getState</span>()),<br>                    ...<span class="hljs-title function_">mapDispatchToProps</span>(dispatch)<br>                &#125;)<br>            &#125;)<br>        &#125;<br>        <span class="hljs-title function_">componentWillUnmount</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-comment">// å–æ¶ˆæ›´æ–°</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">unsubscribe</span>();<br>        &#125;<br>        <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">return</span> (<br>                &#123;<span class="hljs-comment">// é€šè¿‡ props å°† state å’Œ action æ³¨å…¥åˆ° Component ç»„ä»¶ä¸­&#125;</span><br>                <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Component</span></span></span><br><span class="hljs-tag"><span class="language-xml">                    &#123;<span class="hljs-attr">...this.props</span>&#125;</span></span><br><span class="hljs-tag"><span class="language-xml">                    &#123;<span class="hljs-attr">...this.state</span>&#125;</span></span><br><span class="hljs-tag"><span class="language-xml">                /&gt;</span></span><br>            )<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></div></td></tr></table></figure><h5 id=""><a href="#" class="headerlink" title=""></a></h5>]]></content>
    
    
    <categories>
      
      <category>Redux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redux æºç </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Redux å®˜æ–¹å®ç°æ’¤é”€é‡åš -- è§£æ</title>
    <link href="/2022/06/07/Redux%20%E5%AE%98%E6%96%B9%E5%AE%9E%E7%8E%B0%E6%92%A4%E9%94%80%E9%87%8D%E5%81%9A%20--%20%E8%A7%A3%E6%9E%90/"/>
    <url>/2022/06/07/Redux%20%E5%AE%98%E6%96%B9%E5%AE%9E%E7%8E%B0%E6%92%A4%E9%94%80%E9%87%8D%E5%81%9A%20--%20%E8%A7%A3%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="Redux-å®˜æ–¹å®ç°æ’¤é”€é‡åš-â€“-è§£æ"><a href="#Redux-å®˜æ–¹å®ç°æ’¤é”€é‡åš-â€“-è§£æ" class="headerlink" title="Redux å®˜æ–¹å®ç°æ’¤é”€é‡åš â€“ è§£æ"></a>Redux å®˜æ–¹å®ç°æ’¤é”€é‡åš â€“ è§£æ</h2><blockquote><p>å®˜æ–¹çš„åœ°å€ï¼š<a href="https://www.redux.org.cn/docs/recipes/ImplementingUndoHistory.html">https://www.redux.org.cn/docs/recipes/ImplementingUndoHistory.html</a></p></blockquote><p>å®˜æ–¹æä¾›äº†ä¸€ä¸ªæä¾›<code>å¯æ’¤é”€</code>åŠŸèƒ½çš„ reducer enhancer çš„åº“ï¼Œå®˜æ–¹ä¹Ÿæœ‰æç®€æ˜“å®ç°çš„æ•™ç¨‹ã€‚ä»¥ä¸‹æ˜¯æˆ‘ä¸ªäººæ€»ç»“ï¼Œå³ä¾¿å¤§å®¶è¯»äº†ä¹‹åï¼Œå¯¹å®ç°å¯æ’¤é”€é‡åšåŸç†æœ‰åˆæ­¥çš„ç†è§£ï¼Œå¯å‘ä¸‹æ€ç»´ã€‚</p><h3 id="01-æ•°æ®ç»“æ„è®¾è®¡"><a href="#01-æ•°æ®ç»“æ„è®¾è®¡" class="headerlink" title="01 æ•°æ®ç»“æ„è®¾è®¡"></a>01 æ•°æ®ç»“æ„è®¾è®¡</h3><p>State æ˜¯å•ä¸€æ•°æ®æºï¼Œæ˜¯ redux ç®¡ç†æ•°æ®åœ°æ–¹ï¼Œæ•°æ®ç»“æ„è®¾è®¡å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js">&#123;<br>  <span class="hljs-attr">past</span>: <span class="hljs-title class_">Array</span>&lt;T&gt;,<br>  <span class="hljs-attr">present</span>: T,<br>  <span class="hljs-attr">future</span>: <span class="hljs-title class_">Array</span>&lt;T&gt;<br>&#125;<br></code></pre></div></td></tr></table></figure><ul><li><code>past</code> ç”¨äºå­˜æ”¾â€œè¿‡å»â€å†å²è®°å½•æ•°ç»„</li><li><code>present</code> ç”¨äºå­˜æ”¾å½“å‰æ•°æ®</li><li><code>future</code> ç”¨äºå­˜æ”¾å‘ç”Ÿæ’¤é€€æ—¶ï¼Œâ€œæœªæ¥â€å†å²è®°å½•çš„æ•°ç»„</li></ul><p>å¤ªå¹²ï¼Œå¯èƒ½å¬ç€ä¸€å¤´é›¾æ°´ï¼Œä¾‹å¦‚ï¼Œè¿™è¾¹ä»¥ä¸€ä¸ªè®¡æ•°å™¨ä¸ºä¾‹ï¼ˆåˆå§‹ä¸º 0ï¼Œç‚¹å‡»ä¸€æ¬¡++1ï¼‰</p><p><strong>1.ç‚¹å‡»ä¸€æ¬¡</strong></p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css">// å°† &#123;count:<span class="hljs-number">0</span> &#125; ä½œä¸ºå†å²è®°å½•æ¨å…¥ past ä¸­ï¼Œå°†æœ€æ–°çš„å€¼ &#123;count:<span class="hljs-number">1</span>&#125; æ”¾åˆ° present<br>&#123;<br>  past: [&#123;count:<span class="hljs-number">0</span>&#125;],<br>  present: &#123;count:<span class="hljs-number">1</span>&#125;,<br>  future: []<br>&#125;<br></code></pre></div></td></tr></table></figure><p><strong>2.å†ç‚¹å‡»ä¸€æ¬¡</strong></p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css">// å°† &#123;count:<span class="hljs-number">1</span> &#125; ä½œä¸ºå†å²è®°å½•æ¨å…¥ past ä¸­ï¼Œå°†æœ€æ–°çš„å€¼ &#123;count:<span class="hljs-number">2</span>&#125; æ”¾åˆ° present<br>&#123;<br>  past: [&#123;count:<span class="hljs-number">0</span>&#125;ï¼Œ&#123;count:<span class="hljs-number">1</span>&#125;],<br>  present: &#123;count:<span class="hljs-number">2</span>&#125;,<br>  future: []<br>&#125;<br></code></pre></div></td></tr></table></figure><p><strong>3.å‘ç”Ÿä¸€æ¬¡æ’¤é€€</strong></p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css">// å‘ç”Ÿä¸€æ¬¡æ’¤é€€ï¼Œå°† &#123;count:<span class="hljs-number">1</span> &#125; ä½œä¸ºå†å²è®°å½•æ¨å‡º past,æ”¾å…¥ presentï¼Œå¹¶å°†åŸæ¥ present &#123;count:<span class="hljs-number">2</span>&#125; æ¨å…¥ future ä¸­<br>&#123;<br>  past: [&#123;count:<span class="hljs-number">0</span>&#125;],<br>  present: &#123;count:<span class="hljs-number">1</span>&#125;,<br>  future: [&#123;count:<span class="hljs-number">2</span>&#125;]<br>&#125;<br></code></pre></div></td></tr></table></figure><p><strong>4.å‘ç”Ÿä¸€æ¬¡é‡åš</strong></p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css">// å‘ç”Ÿä¸€æ¬¡é‡åšï¼Œå°† &#123;count:<span class="hljs-number">2</span>&#125; æ¨å‡º futureï¼Œæ”¾å…¥æœ€æ–°å€¼ present ä¸Šï¼Œå¹¶å°†åŸæ¥ present &#123;count:<span class="hljs-number">1</span>&#125; æ¨å› past ä¸­<br>&#123;<br>  past: [&#123;count:<span class="hljs-number">0</span>&#125;ï¼Œ&#123;count:<span class="hljs-number">1</span>&#125;],<br>  present: &#123;count:<span class="hljs-number">2</span>&#125;,<br>  future: []<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç›¸ä¿¡å¤§å®¶çœ‹åˆ°è¿™é‡Œï¼Œå·²ç»æœ‰æ‰€äº†è§£ï¼Œè®¾è®¡è¿™ä¸ªæ•°æ®ç»“æ„çš„åˆè¡·äº†ã€‚æ˜¯ä»¥ä¸€ç§<strong>å¿«ç…§å¼</strong>è®°å½•æ‰€æœ‰å†å²æ•°æ®ï¼Œå°±åƒæ˜¯ç»™ä½ æ¯æ¬¡æ“ä½œçš„æ‰€æœ‰æ•°æ®æ‹ä¸ªç…§ï¼Œè®°å½•æˆå†å²è®°å½•å­˜æ”¾åˆ°æ•°ç»„ä¸­</p><h3 id="02-æ’¤é€€é‡åšç®—æ³•"><a href="#02-æ’¤é€€é‡åšç®—æ³•" class="headerlink" title="02 æ’¤é€€é‡åšç®—æ³•"></a>02 æ’¤é€€é‡åšç®—æ³•</h3><h4 id="å¤„ç†-Undo"><a href="#å¤„ç†-Undo" class="headerlink" title="å¤„ç† Undo"></a>å¤„ç† Undo</h4><ul><li>ç§»é™¤ <code>past</code> ä¸­çš„<strong>æœ€åä¸€ä¸ª</strong>å…ƒç´ ã€‚</li><li>å°†ä¸Šä¸€æ­¥ç§»é™¤çš„å…ƒç´ èµ‹äºˆ <code>present</code>ã€‚</li><li>å°†åŸæ¥çš„ <code>present</code> æ’å…¥åˆ° <code>future</code> çš„<strong>æœ€å‰é¢</strong>ã€‚</li></ul><h4 id="å¤„ç†-Redo"><a href="#å¤„ç†-Redo" class="headerlink" title="å¤„ç† Redo"></a>å¤„ç† Redo</h4><ul><li>ç§»é™¤ <code>future</code> ä¸­çš„<strong>ç¬¬ä¸€ä¸ª</strong>å…ƒç´ ã€‚</li><li>å°†ä¸Šä¸€æ­¥ç§»é™¤çš„å…ƒç´ èµ‹äºˆ <code>present</code>ã€‚</li><li>å°†åŸæ¥çš„ <code>present</code> è¿½åŠ åˆ° <code>past</code> çš„<strong>æœ€åé¢</strong>ã€‚</li></ul><h4 id="å¤„ç†å…¶ä»–-Action"><a href="#å¤„ç†å…¶ä»–-Action" class="headerlink" title="å¤„ç†å…¶ä»– Action"></a>å¤„ç†å…¶ä»– Action</h4><ul><li>å°†å½“å‰çš„ <code>present</code> è¿½åŠ åˆ° <code>past</code> çš„<strong>æœ€åé¢</strong>ã€‚</li><li>å°†å¤„ç†å®Œ action æ‰€äº§ç”Ÿçš„æ–°çš„ state èµ‹äºˆ <code>present</code>ã€‚</li><li>æ¸…ç©º <code>future</code>ã€‚</li></ul><h3 id="03-é«˜é˜¶-reducer-Reducer-Enhancers"><a href="#03-é«˜é˜¶-reducer-Reducer-Enhancers" class="headerlink" title="03 é«˜é˜¶ reducer (Reducer Enhancers)"></a>03 é«˜é˜¶ reducer (Reducer Enhancers)</h3><p><strong>reducer enhancer</strong>ï¼ˆæˆ–è€… <strong>higher order reducer</strong>ï¼‰,é«˜é˜¶ reducer å’Œ react çš„é«˜é˜¶ç»„ä»¶éå¸¸ç±»ä¼¼ï¼Œå®ƒæ˜¯é€šè¿‡æ¥æ”¶ä¸€ä¸ª reducer å¹¶ç”Ÿæˆè¿”å›ä¸€ä¸ªæ–°çš„ reducer ,ä½¿å¾—æ–°çš„ reducer æ‹¥æœ‰æ–°çš„ç‰¹æ€§ã€‚ä¸¾ä¸€ä¸ªä¾‹å­</p><p>å¾ˆæƒ³æ˜¯æˆ‘ä»¬ IDE æ’ä»¶ï¼ŒIDE å¯ä»¥ç¼–å†™ä»£ç ï¼Œè£…äº†ä»£ç æç¤ºæ’ä»¶ä¹‹åï¼Œæœ‰äº†æ›´å¥½ä»£ç ä¹¦å†™ä½“éªŒï¼Œä½†æ˜¯å½“æ’ä»¶å¸è½½äº†ä¹Ÿå¹¶ä¸å½±å“åŸæ¥å†™ä»£ç çš„åŠŸèƒ½ã€‚ä¸‹å›¾å°±æ˜¯ä½¿ç”¨é«˜é˜¶ reducer å‰ååŒºåˆ«å›¾ã€‚</p><p><img src="https://s2.loli.net/2022/05/13/WqUoOS3dPGF6VgB.png" alt="image-20220513180319247"></p><h3 id="04-ç¼–å†™-Reducer-Enhancer"><a href="#04-ç¼–å†™-Reducer-Enhancer" class="headerlink" title="04 ç¼–å†™ Reducer Enhancer"></a>04 ç¼–å†™ Reducer Enhancer</h3><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">undoable</span>(<span class="hljs-params">reducer</span>) &#123;<br>  <span class="hljs-comment">// ä»¥ä¸€ä¸ªç©ºçš„ action è°ƒç”¨ reducer æ¥äº§ç”Ÿåˆå§‹çš„ state</span><br>  <span class="hljs-keyword">const</span> initialState = &#123;<br>    <span class="hljs-attr">past</span>: [],<br>    <span class="hljs-attr">present</span>: <span class="hljs-title function_">reducer</span>(<span class="hljs-literal">undefined</span>, &#123;&#125;),<br>    <span class="hljs-attr">future</span>: [],<br>  &#125;<br><br>  <span class="hljs-comment">// è¿”å›ä¸€ä¸ªå¯ä»¥æ‰§è¡Œæ’¤é”€å’Œé‡åšçš„æ–°çš„reducer</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">state = initialState, action</span>) &#123;<br>    <span class="hljs-keyword">const</span> &#123; past, present, future &#125; = state<br><br>    <span class="hljs-keyword">switch</span> (action.<span class="hljs-property">type</span>) &#123;<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;UNDO&#x27;</span>:<br>        <span class="hljs-keyword">const</span> previous = past[past.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]<br>        <span class="hljs-keyword">const</span> newPast = past.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, past.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">return</span> &#123;<br>          <span class="hljs-attr">past</span>: newPast,<br>          <span class="hljs-attr">present</span>: previous,<br>          <span class="hljs-attr">future</span>: [present, ...future],<br>        &#125;<br>      <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;REDO&#x27;</span>:<br>        <span class="hljs-keyword">const</span> next = future[<span class="hljs-number">0</span>]<br>        <span class="hljs-keyword">const</span> newFuture = future.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">return</span> &#123;<br>          <span class="hljs-attr">past</span>: [...past, present],<br>          <span class="hljs-attr">present</span>: next,<br>          <span class="hljs-attr">future</span>: newFuture,<br>        &#125;<br>      <span class="hljs-attr">default</span>:<br>        <span class="hljs-comment">// å°†å…¶ä»– action å§”æ‰˜ç»™åŸå§‹çš„ reducer å¤„ç†</span><br>        <span class="hljs-keyword">const</span> newPresent = <span class="hljs-title function_">reducer</span>(present, action)<br>        <span class="hljs-keyword">if</span> (present === newPresent) &#123;<br>          <span class="hljs-keyword">return</span> state<br>        &#125;<br>        <span class="hljs-keyword">return</span> &#123;<br>          <span class="hljs-attr">past</span>: [...past, present],<br>          <span class="hljs-attr">present</span>: newPresent,<br>          <span class="hljs-attr">future</span>: [],<br>        &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="05-å®˜æ–¹æ’ä»¶"><a href="#05-å®˜æ–¹æ’ä»¶" class="headerlink" title="05 å®˜æ–¹æ’ä»¶"></a>05 å®˜æ–¹æ’ä»¶</h3><p>Redux Undo æ˜¯ä¸€ä¸ªåº“èƒ½å¸®åŠ©æˆ‘ä»¬å®ç°<code>å¯æ’¤é”€</code>åŠŸèƒ½ã€‚</p><figure class="highlight ada"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ada">npm install <span class="hljs-comment">--save redux-undo</span><br></code></pre></div></td></tr></table></figure><p>è¯¦ç»†è¯·è§ï¼Œ<a href="https://github.com/omnidan/redux-undo">å®˜æ–¹ github</a></p>]]></content>
    
    
    <categories>
      
      <category>Redux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redux</tag>
      
      <tag>å®ç°æ—¥å¿—æµæ°´</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æµ…ç”¨é«˜é˜¶ReduxåŸç†å®ç°æ—¥å¿—æµæ°´--å®ç°ç¯‡</title>
    <link href="/2022/06/07/%E6%B5%85%E7%94%A8%E9%AB%98%E9%98%B6Redux%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0%E6%8F%92%E4%BB%B6%E5%BC%8F%E6%97%A5%E5%BF%97%E6%B5%81%E6%B0%B4--%E5%AE%9E%E7%8E%B0%E7%AF%87/"/>
    <url>/2022/06/07/%E6%B5%85%E7%94%A8%E9%AB%98%E9%98%B6Redux%E5%8E%9F%E7%90%86%E5%AE%9E%E7%8E%B0%E6%8F%92%E4%BB%B6%E5%BC%8F%E6%97%A5%E5%BF%97%E6%B5%81%E6%B0%B4--%E5%AE%9E%E7%8E%B0%E7%AF%87/</url>
    
    <content type="html"><![CDATA[<h2 id="æµ…ç”¨é«˜é˜¶-Redux-åŸç†å®ç°æ—¥å¿—æµæ°´â€“å®ç°ç¯‡"><a href="#æµ…ç”¨é«˜é˜¶-Redux-åŸç†å®ç°æ—¥å¿—æµæ°´â€“å®ç°ç¯‡" class="headerlink" title="æµ…ç”¨é«˜é˜¶ Redux åŸç†å®ç°æ—¥å¿—æµæ°´â€“å®ç°ç¯‡"></a>æµ…ç”¨é«˜é˜¶ Redux åŸç†å®ç°æ—¥å¿—æµæ°´â€“å®ç°ç¯‡</h2><blockquote><p>Demo B è¦å®ç°ä½ä»£ç æ“ä½œæµæ°´è®°å½•ï¼Œå®ç°æ’¤å›é‡åšçš„åŠŸèƒ½ï¼Œä¸€å¼€å§‹çš„æƒ³æ³•æ¯”è¾ƒç®€å•ï¼Œç›´æ¥åœ¨ action ä¸­å®Œå–„æ’¤å›é‡åšåŠŸèƒ½ï¼Œä½†æ˜¯åé¢å‚è€ƒå®˜æ–¹çš„ redux ï¼Œå…¶å®æœ‰ä¸ªé«˜çº§çš„å†™æ³•ï¼Œä¹Ÿå°±æ˜¯é«˜é˜¶ Reduxï¼Œå¯ä»¥å®ç°å¯æ’ä»¶å¼çš„å¯æ’¤é€€é‡åšæ—¥å¿—ã€‚å…·ä½“é«˜é˜¶ Redux ä»‹ç»ï¼Œå¯ä»¥ç§»æ­¥åˆ°ï¼Œæ–‡ç« ï¼šRedux å®˜æ–¹å®ç°æ’¤é”€é‡åš â€“ è§£æ</p><p>å‚è€ƒï¼š<a href="https://juejin.cn/post/6844903921878564872#heading-8">Web åº”ç”¨çš„æ’¤é”€é‡åšå®ç° - æ˜é‡‘ (juejin.cn)</a></p><p>â€‹ <a href="https://www.redux.org.cn/docs/recipes/ImplementingUndoHistory.html">å®ç°æ’¤é”€é‡åš Â· Redux</a></p></blockquote><h3 id="01-å®ç°æ’¤å›é‡åšçš„æ–¹æ¡ˆ"><a href="#01-å®ç°æ’¤å›é‡åšçš„æ–¹æ¡ˆ" class="headerlink" title="01 å®ç°æ’¤å›é‡åšçš„æ–¹æ¡ˆ"></a>01 å®ç°æ’¤å›é‡åšçš„æ–¹æ¡ˆ</h3><ul><li><strong>æ•°æ®å¿«ç…§å¼</strong>ï¼Œä¹Ÿå°±æ˜¯å°†æ¯æ¬¡æ“ä½œå®Œä¹‹åï¼Œæ•°æ®çŠ¶æ€è¿›è¡Œä¿å­˜ï¼Œä»è€Œå½¢æˆå†å²è®°å½•<ul><li>ä¼˜ç‚¹ï¼šé€šç”¨æ€§å¹¿ï¼Œå®ç°å®¹æ˜“ï¼Œå¯å°è£…æˆç»„ä»¶æˆå¯æ’æ‹”æ’ä»¶</li><li>ç¼ºç‚¹ï¼šå‡è‹¥æ•°æ®ç»“æ„å¤æ‚åºå¤§ï¼Œéšç€æ“ä½œå†å²è®°å½•å˜å¤šï¼Œå¯¼è‡´æ•°æ®é‡å†—ä½™ï¼Œä¸å¤ªå¥½ç®¡ç†</li></ul></li><li><strong>è·¯å¾„æ–°æ—§å€¼å¼</strong>ï¼Œå•ä¸€æ•°æ®æºï¼Œå¯¹æ¯æ¬¡æ“ä½œåï¼Œå°†æ“ä½œæ•°æ®çš„è·¯å¾„ã€æ–°å€¼å’Œæ—§å€¼ä½œä¸ºè®°å½•è¿›è¡Œä¿å­˜<ul><li>ä¼˜ç‚¹ï¼šåªéœ€è®°å½•æ“ä½œè·¯å¾„å’Œæ–°æ—§å€¼ï¼Œå‡å°‘å¤§é‡çš„å†…å­˜æ¶ˆè€—ï¼Œæ–¹ä¾¿ç®¡ç†æ•°æ®</li><li>ç¼ºç‚¹ï¼šå®ç°æ¯”è¾ƒéš¾ï¼Œ éœ€è¦å¯¹ action çš„ä¼ å…¥æ•°æ®çš„ç»“æ„æœ‰æ‰€è¦æ±‚ï¼ˆè·¯å¾„ã€æ–°æ—§å€¼ï¼‰</li></ul></li></ul><p>ä¸‹æ–‡å°†é‡‡ç”¨çš„æ˜¯è·¯åŠ²æ–°æ—§å€¼å¼çš„æ–¹æ¡ˆ</p><h3 id="02-æ•°æ®ç»“æ„çš„è®¾è®¡"><a href="#02-æ•°æ®ç»“æ„çš„è®¾è®¡" class="headerlink" title="02 æ•°æ®ç»“æ„çš„è®¾è®¡"></a>02 æ•°æ®ç»“æ„çš„è®¾è®¡</h3><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js">&#123;<br>  <span class="hljs-attr">histories</span>: [],<br>  <span class="hljs-attr">historyIndex</span>: -<span class="hljs-number">1</span>,<br>  <span class="hljs-attr">current</span>:&#123;&#125;<br>&#125;<br><br><span class="hljs-comment">// ä¾‹ï¼šhistorieså­˜æ”¾ä¸€ä¸ªæ›´æ–°æ“ä½œ</span><br>histories = [<br>    &#123;<br>        <span class="hljs-attr">path</span>:[<span class="hljs-string">&quot;state&quot;</span>,<span class="hljs-string">&quot;Data&quot;</span>,<span class="hljs-number">0</span>,<span class="hljs-string">&quot;name&quot;</span>],<br>        <span class="hljs-attr">newValue</span>: <span class="hljs-string">&quot;xiaoming&quot;</span>,<br>        <span class="hljs-attr">oldValue</span>: <span class="hljs-string">&quot;KK&quot;</span><br>    &#125;<br>]<br></code></pre></div></td></tr></table></figure><p>å…¶ä¸­ï¼Œ</p><ul><li><strong>histories:</strong> ç”¨äºå­˜æ”¾è®°å½•æ•°ç»„</li><li><strong>historyIndexï¼š</strong> æ¸¸æ ‡ï¼Œç”¨äºæ ‡è¯†å½“å‰å†å²è®°å½•çš„æŒ‡é’ˆ</li><li><strong>currentï¼š</strong>å­˜æ”¾ä¸šåŠ¡ reducer è¿”å›æœ€æ–°çš„ä¸šåŠ¡ state</li></ul><h3 id="03-æ’¤é”€é‡åšç®—æ³•"><a href="#03-æ’¤é”€é‡åšç®—æ³•" class="headerlink" title="03 æ’¤é”€é‡åšç®—æ³•"></a>03 æ’¤é”€é‡åšç®—æ³•</h3><h4 id="æ’¤é”€-undo"><a href="#æ’¤é”€-undo" class="headerlink" title="æ’¤é”€ undo"></a>æ’¤é”€ undo</h4><ul><li>åˆ¤æ–­ <code>historyIndex</code> çš„å€¼ï¼Œä»è€Œåˆ¤æ–­æ’¤é€€è¿›è¡Œåˆ°ä»€ä¹ˆçŠ¶æ€ã€‚<ul><li>0 ï¼Œè¯´æ˜å·²ç»æ‰§è¡Œåˆ°æ ˆåº•äº†</li><li>-1ï¼Œæœªå‘ç”Ÿæ’¤é€€æ“ä½œ</li><li><code>!= -1 &amp;&amp; != 0</code>ï¼Œæ­£åœ¨è¿›è¡Œæ’¤é€€æ“ä½œ</li></ul></li></ul><p><img src="https://s2.loli.net/2022/05/14/9VacFp7rWzBhwgt.png" alt="image-20220514111615614"></p><ul><li>æ‰§è¡Œæ’¤å›æ“ä½œ<ul><li>è‹¥ <code>newValue === null</code>ï¼Œ ä¸ºåˆ é™¤æ“ä½œï¼Œå¯¹åº”æ’¤å›æ“ä½œ =&gt; æ–°å¢æ“ä½œ</li><li>è‹¥ <code>oldValue === null</code>ï¼Œ ä¸ºæ–°å¢æ“ä½œï¼Œå¯¹åº”æ’¤å›æ“ä½œ =&gt; åˆ é™¤æ“ä½œ</li><li>è‹¥ <code>newValue !== null &amp;&amp; oldValue !== null</code> ,ä¸ºæ›´æ–°æ“ä½œï¼Œå¯¹åº”æ’¤å›æ“ä½œ =&gt; æ›´æ–°æ“ä½œ</li></ul></li></ul><h4 id="é‡åš-redo"><a href="#é‡åš-redo" class="headerlink" title="é‡åš redo"></a>é‡åš redo</h4><ul><li><p>åˆ¤æ–­ <code>historyIndex</code> çš„å€¼ï¼Œæ˜¯å¦å·²ç»å‘ç”Ÿæ’¤å›æ“ä½œ</p><p><img src="https://s2.loli.net/2022/05/14/HQsproaURAPNFOt.png" alt="image-20220514113531299"></p></li><li><p>æ‰§è¡Œé‡åšæ“ä½œ</p><ul><li>è‹¥ <code>newValue === null</code>ï¼Œ ä¸ºåˆ é™¤æ“ä½œï¼Œå¯¹åº”é‡åšæ“ä½œ =&gt; åˆ é™¤æ“ä½œ</li><li>è‹¥ <code>oldValue === null</code>ï¼Œ ä¸ºæ–°å¢æ“ä½œï¼Œå¯¹åº”æ’¤é‡å›æ“ä½œ =&gt;æ–°å¢æ“ä½œ</li><li>è‹¥ <code>newValue !== null &amp;&amp; oldValue !== null</code> ,ä¸ºæ›´æ–°æ“ä½œï¼Œå¯¹åº”é‡åšæ“ä½œ =&gt; æ›´æ–°æ“ä½œ</li></ul></li><li><p>æœ€åï¼Œåˆ¤æ–­ <code>historyIndex</code> æ˜¯å¦åˆ°è¾¾æ ˆé¡¶</p><ul><li>åˆ°è¾¾æ ˆé¡¶ï¼Œé‡ç½®æ¸¸æ ‡<code>historyIndex = -1</code></li><li>æœªåˆ°è¾¾æ ˆé¡¶ï¼Œ<code>historyIndex ++1</code></li></ul></li></ul><h4 id="å…¶ä»–ä¸šåŠ¡-Action"><a href="#å…¶ä»–ä¸šåŠ¡-Action" class="headerlink" title="å…¶ä»–ä¸šåŠ¡ Action"></a>å…¶ä»–ä¸šåŠ¡ Action</h4><ul><li><p>ç‰¹æ®Šæƒ…å†µï¼šå½“åœ¨å‘ç”Ÿæ’¤é€€é‡åšæ—¶ï¼Œè‹¥å‘ç”Ÿå…¶ä»–ä¸šåŠ¡ Action æ“ä½œï¼Œåº”è¯¥æŠŠå½“å‰æ¸¸æ ‡åé¢çš„è®°å½•æ¸…ç©ºï¼Œå¹¶æ¨å…¥æ–°çš„ä¸šåŠ¡ Action æ“ä½œ</p></li><li><p>æ‰§è¡Œå…¶ä»–ä¸šåŠ¡çš„ Actionï¼Œå§”æ‰˜ç»™ä¸šåŠ¡çš„ reducer è¿›è¡Œå¤„ç†ï¼Œå¹¶å°†ä¸šåŠ¡ reducer è¿”å›æ–°çš„ ä¸šåŠ¡ state å­˜å‚¨åˆ° current</p></li><li><p>é«˜é˜¶ reducer æ¥æ”¶ <code>include</code> æ•°ç»„å‚æ•°ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦å°†è¿™ä¸ªæ“ä½œåŠ å…¥æ’¤é€€é‡åšè®°å½•ä¸­</p><ul><li>å±äºï¼Œå°†å…¶å°è£…æˆè®°å½•ï¼Œå¹¶æ¨å…¥ <code>histories</code></li><li>ä¸å±äºï¼Œæ— å¤„ç†</li></ul></li><li><p>é¢å¤–æ“ä½œï¼šå½“é«˜é˜¶ reducer æ¥æ”¶ <code>limit</code> å‚æ•°ï¼Œç”¨äºé™åˆ¶è®°å½•çš„æœ€å¤§é•¿åº¦</p><ul><li>é»˜è®¤, <code>limit = false</code>ï¼Œä¸è¿›è¡Œè®°å½•é•¿åº¦çš„é™åˆ¶</li><li>limit ä¸ºæ•°å­—ï¼Œä¸”å¤§äº 0ã€‚å¯¹è®°å½•è¿›è¡Œé™åˆ¶</li></ul></li></ul><h3 id="03-å®ç°æºç "><a href="#03-å®ç°æºç " class="headerlink" title="03 å®ç°æºç "></a>03 å®ç°æºç </h3><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> _ <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;lodash&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">undoReducerEnhancer</span>(<span class="hljs-params"></span><br><span class="hljs-params">  reducer,</span><br><span class="hljs-params">  &#123;</span><br><span class="hljs-params">    limit = <span class="hljs-literal">false</span>, // æ—¥å¿—æµæ°´æœ€å¤§é•¿åº¦</span><br><span class="hljs-params">    undoType = <span class="hljs-string">&#x27;UNDO&#x27;</span>, // æ’¤é”€æ“ä½œç±»å‹</span><br><span class="hljs-params">    redoType = <span class="hljs-string">&#x27;REDO&#x27;</span>, // é‡åšæ“ä½œç±»å‹</span><br><span class="hljs-params">    include = [], // éœ€è¦åŠ å…¥æ—¥å¿—æµæ°´çš„æ“ä½œç±»å‹</span><br><span class="hljs-params">  &#125;</span><br><span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">//  ä»¥ä¸€ä¸ªç©ºçš„ action è°ƒç”¨ reducerï¼Œæ¥åˆå§‹åŒ– state</span><br>  <span class="hljs-keyword">const</span> initialState = &#123;<br>    <span class="hljs-attr">histories</span>: [], <span class="hljs-comment">//æ—¥å¿—æµæ°´æ•°ç»„</span><br>    <span class="hljs-attr">historyIndex</span>: -<span class="hljs-number">1</span>, <span class="hljs-comment">// æ¸¸æ ‡, -1: è¯´æ˜æ˜¯ç¬¬ä¸€æ¬¡æ’¤é”€</span><br>    <span class="hljs-comment">// eslint-disable-next-line no-undefined</span><br>    <span class="hljs-attr">current</span>: <span class="hljs-title function_">reducer</span>(<span class="hljs-literal">undefined</span>, &#123;&#125;), <span class="hljs-comment">// å½“å‰çŠ¶æ€</span><br>  &#125;<br><br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">Add</span> = (<span class="hljs-params">list = [], &#123; path, newValue &#125;</span>) =&gt; &#123;<br>    <span class="hljs-keyword">let</span> newList = _.<span class="hljs-title function_">cloneDeep</span>(list)<br><br>    <span class="hljs-comment">// éœ€è¦å­˜æ”¾çš„ç›®æ ‡æ•°ç»„</span><br>    <span class="hljs-keyword">const</span> target = path.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, path.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment">// éœ€è¦å­˜æ”¾çš„ç›®æ ‡æ•°ç»„çš„æ¸¸æ ‡</span><br>    <span class="hljs-keyword">const</span> targetIndex = path[path.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">const</span> newTarget = _.<span class="hljs-title function_">get</span>(newList, target)<br>    newTarget.<span class="hljs-title function_">splice</span>(targetIndex, <span class="hljs-number">0</span>, newValue)<br>    newList = _.<span class="hljs-title function_">set</span>(newList, target, newTarget)<br>    <span class="hljs-keyword">return</span> newList<br>  &#125;<br><br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">Update</span> = (<span class="hljs-params">list = [], &#123; path = [], newValue &#125;</span>) =&gt; &#123;<br>    <span class="hljs-comment">// éœ€è¦å­˜æ”¾çš„ç›®æ ‡æ•°ç»„</span><br>    <span class="hljs-keyword">let</span> newList = _.<span class="hljs-title function_">cloneDeep</span>(list)<br><br>    <span class="hljs-comment">// path è·¯å¾„ä¸ºç©ºï¼Œ ä¿®æ”¹å°±æ˜¯å½“å‰å¯¹è±¡</span><br>    <span class="hljs-keyword">if</span> (path.<span class="hljs-property">length</span> !== <span class="hljs-number">0</span>) &#123;<br>      newList = _.<span class="hljs-title function_">set</span>(newList, path, newValue)<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      newList = newValue<br>    &#125;<br>    <span class="hljs-keyword">return</span> newList<br>  &#125;<br><br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">Delete</span> = (<span class="hljs-params">list = [], &#123; path &#125;</span>) =&gt; &#123;<br>    <span class="hljs-keyword">let</span> newList = _.<span class="hljs-title function_">cloneDeep</span>(list)<br><br>    <span class="hljs-comment">// éœ€è¦å­˜æ”¾çš„ç›®æ ‡æ•°ç»„</span><br>    <span class="hljs-keyword">const</span> target = path.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, path.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>)<br><br>    <span class="hljs-comment">// éœ€è¦å­˜æ”¾çš„ç›®æ ‡æ•°ç»„çš„æ¸¸æ ‡</span><br>    <span class="hljs-keyword">const</span> targetIndex = path[path.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">let</span> newTarget = _.<span class="hljs-title function_">get</span>(newList, target)<br>    newTarget.<span class="hljs-title function_">splice</span>(targetIndex, <span class="hljs-number">1</span>)<br>    newList = _.<span class="hljs-title function_">set</span>(newList, target, newTarget)<br>    <span class="hljs-keyword">return</span> newList<br>  &#125;<br><br>  <span class="hljs-comment">// æ ¹æ®åˆ¤æ–­æ˜¯å¦åŠ å…¥æ’¤é”€é‡åšæµæ°´æ“ä½œ</span><br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">isInclude</span> = (<span class="hljs-params">actionType</span>) =&gt;<br>    include.<span class="hljs-title function_">indexOf</span>(actionType) === -<span class="hljs-number">1</span> ? <span class="hljs-literal">false</span> : <span class="hljs-literal">true</span><br><br>  <span class="hljs-comment">// è¿”å›ä¸€ä¸ªå¯æ’¤é”€å’Œé‡åšçš„æ–°çš„ reducer</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">state = initialState, action</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> &#123; histories, historyIndex &#125; = state<br><br>    <span class="hljs-comment">// æ’¤é”€æ“ä½œ</span><br>    <span class="hljs-keyword">if</span> (action.<span class="hljs-property">type</span> === undoType) &#123;<br>      <span class="hljs-keyword">if</span> (historyIndex === -<span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-comment">// ç¬¬ä¸€æ¬¡æ’¤é€€</span><br>        state.<span class="hljs-property">historyIndex</span> = histories.<span class="hljs-property">length</span> - <span class="hljs-number">1</span><br>      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (historyIndex &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-comment">// éç¬¬ä¸€æ¬¡æ’¤é€€</span><br>        state.<span class="hljs-property">historyIndex</span>--<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// æ’¤é€€end,è¿”å›</span><br>        <span class="hljs-keyword">return</span> state<br>      &#125;<br><br>      <span class="hljs-comment">// æ‰§è¡Œæ’¤é€€æ“ä½œ</span><br>      <span class="hljs-keyword">const</span> &#123; path, newValue, oldValue &#125; = histories[state.<span class="hljs-property">historyIndex</span>]<br>      <span class="hljs-keyword">if</span> (newValue === <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-comment">// åˆ é™¤æ“ä½œ =&gt; æ–°å¢æ“ä½œ</span><br>        state.<span class="hljs-property">current</span> = <span class="hljs-title class_">Add</span>(state.<span class="hljs-property">current</span>, &#123; path, <span class="hljs-attr">newValue</span>: oldValue &#125;)<br>      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (oldValue === <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-comment">// æ–°å¢æ“ä½œ =&gt; åˆ é™¤æ“ä½œ</span><br>        state.<span class="hljs-property">current</span> = <span class="hljs-title class_">Delete</span>(state.<span class="hljs-property">current</span>, &#123; path &#125;)<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// æ›´æ–°æ“ä½œ =&gt; æ›´æ–°æ“ä½œ</span><br>        state.<span class="hljs-property">current</span> = <span class="hljs-title class_">Update</span>(state.<span class="hljs-property">current</span>, &#123; path, <span class="hljs-attr">newValue</span>: oldValue &#125;)<br>      &#125;<br>      <span class="hljs-keyword">return</span> _.<span class="hljs-title function_">cloneDeep</span>(state)<br>    &#125;<br><br>    <span class="hljs-comment">// é‡åšæ“ä½œ</span><br>    <span class="hljs-keyword">if</span> (action.<span class="hljs-property">type</span> === redoType) &#123;<br>      <span class="hljs-keyword">if</span> (historyIndex === -<span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-comment">// æœªå‘ç”Ÿæ’¤é”€</span><br>        <span class="hljs-keyword">return</span> state<br>      &#125;<br><br>      <span class="hljs-comment">// æ‰§è¡Œé‡åšæ“ä½œ</span><br>      <span class="hljs-keyword">const</span> &#123; path, newValue, oldValue &#125; = histories[state.<span class="hljs-property">historyIndex</span>]<br>      <span class="hljs-keyword">if</span> (newValue === <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-comment">// åˆ é™¤æ“ä½œ =&gt; åˆ é™¤æ“ä½œ</span><br>        state.<span class="hljs-property">current</span> = <span class="hljs-title class_">Delete</span>(state.<span class="hljs-property">current</span>, &#123; path &#125;)<br>      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (oldValue === <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-comment">// æ–°å¢æ“ä½œ =&gt; æ–°å¢æ“ä½œ</span><br>        state.<span class="hljs-property">current</span> = <span class="hljs-title class_">Add</span>(state.<span class="hljs-property">current</span>, &#123; path, newValue &#125;)<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// æ›´æ–°æ“ä½œ =&gt; æ›´æ–°æ“ä½œ</span><br>        state.<span class="hljs-property">current</span> = <span class="hljs-title class_">Update</span>(state.<span class="hljs-property">current</span>, &#123; path, newValue &#125;)<br>      &#125;<br><br>      <span class="hljs-keyword">if</span> (state.<span class="hljs-property">historyIndex</span> &lt; histories.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-comment">// ç»§ç»­é‡åš</span><br>        state.<span class="hljs-property">historyIndex</span>++<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// é‡åšend,è¿”å›</span><br>        state.<span class="hljs-property">historyIndex</span> = -<span class="hljs-number">1</span><br>      &#125;<br>      <span class="hljs-keyword">return</span> _.<span class="hljs-title function_">cloneDeep</span>(state)<br>    &#125;<br><br>    <span class="hljs-comment">// å…¶ä»–ä¸šåŠ¡æ“ä½œ, å§”æ‰˜ç»™ä¸šåŠ¡reducerå¤„ç†</span><br>    <span class="hljs-comment">// ç‰¹æ®Šæƒ…å†µï¼šæ‰“æ–­æ’¤é”€é‡åšæ“ä½œï¼Œæ¸…ç©º historyIndex åé¢æ‰€æœ‰æ“ä½œæµæ°´,å¹¶ç½® historyIndex ä¸º -1</span><br>    <span class="hljs-keyword">if</span> (state.<span class="hljs-property">historyIndex</span> !== -<span class="hljs-number">1</span>) &#123;<br>      state.<span class="hljs-property">histories</span> = state.<span class="hljs-property">histories</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, state.<span class="hljs-property">historyIndex</span>)<br>      state.<span class="hljs-property">historyIndex</span> = -<span class="hljs-number">1</span><br>    &#125;<br>    <span class="hljs-keyword">const</span> newState = <span class="hljs-title function_">reducer</span>(state.<span class="hljs-property">current</span>, action)<br>    state.<span class="hljs-property">current</span> = newState<br><br>    <span class="hljs-comment">// å¦‚æœæ˜¯ actonType æ˜¯å±äº Include ï¼Œåˆ™åŠ å…¥æ’¤é”€é‡åšæµæ°´</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isInclude</span>(action.<span class="hljs-property">type</span>)) &#123;<br>      state.<span class="hljs-property">histories</span>.<span class="hljs-title function_">push</span>(&#123;<br>        <span class="hljs-attr">type</span>: action.<span class="hljs-property">type</span>,<br>        ...action.<span class="hljs-property">payload</span>,<br>      &#125;)<br>    &#125;<br><br>    <span class="hljs-comment">// å½“æµæ°´é•¿åº¦è¶…è¿‡äº† limit é•¿åº¦æ—¶</span><br>    <span class="hljs-keyword">if</span> (limit &amp;&amp; limit &gt; <span class="hljs-number">0</span>) &#123;<br>      state.<span class="hljs-property">histories</span> = state.<span class="hljs-property">histories</span>.<span class="hljs-title function_">slice</span>(-limit)<br>    &#125;<br>    <span class="hljs-keyword">return</span> _.<span class="hljs-title function_">cloneDeep</span>(state)<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p><strong>ä½¿ç”¨æ–¹å¼ï¼š</strong></p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> undoReducerEnhancer <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./undoReducerEnhancer&#x27;</span><br><br><span class="hljs-comment">// æ¥å—ä¸€ä¸ªä¸šåŠ¡refucer,è¿”å›ä¸€ä¸ªå…·æœ‰å¯æ’¤é€€é‡åšçš„æ–°çš„reducer</span><br><span class="hljs-keyword">const</span> undoCustomComponent = <span class="hljs-title function_">undoReducerEnhancer</span>(customComponent, &#123;<br>  <span class="hljs-attr">limit</span>: <span class="hljs-number">10</span>, <span class="hljs-comment">// é™åˆ¶è®°å½•é•¿åº¦</span><br>  <span class="hljs-attr">undoType</span>: <span class="hljs-title class_">Types</span>.<span class="hljs-property">UNDO_HISTORY</span>, <span class="hljs-comment">// æ’¤é€€æ“ä½œåˆ«å</span><br>  <span class="hljs-attr">redoType</span>: <span class="hljs-title class_">Types</span>.<span class="hljs-property">REDO_HISTORY</span>, <span class="hljs-comment">// é‡åšæ“ä½œåˆ«å</span><br>  <span class="hljs-attr">include</span>: [<br>    <span class="hljs-title class_">Types</span>.<span class="hljs-property">ADD_COMPONENT</span>,<br>    <span class="hljs-title class_">Types</span>.<span class="hljs-property">PASTE_COMPONENT</span>,<br>    <span class="hljs-title class_">Types</span>.<span class="hljs-property">UPDATE_COMPONENT_CONFIG</span>,<br>    <span class="hljs-title class_">Types</span>.<span class="hljs-property">UPDATE_FORM_CONFIG</span>,<br>    <span class="hljs-title class_">Types</span>.<span class="hljs-property">UPDATE_DATA_SORT</span>,<br>    <span class="hljs-title class_">Types</span>.<span class="hljs-property">DELETE_COMPONENT</span>,<br>    <span class="hljs-title class_">Types</span>.<span class="hljs-property">DELETE_ALL_COMPONENTS</span>,<br>  ],<br>  <span class="hljs-comment">// åŠ å…¥éœ€è¦è®°å½•æµæ°´çš„æ“ä½œ action</span><br>&#125;)<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> undoCustomComponent<br></code></pre></div></td></tr></table></figure><h3 id="04-ä¸è¶³ä¹‹å¤„"><a href="#04-ä¸è¶³ä¹‹å¤„" class="headerlink" title="04 ä¸è¶³ä¹‹å¤„"></a>04 ä¸è¶³ä¹‹å¤„</h3><ul><li>è¿˜æœªè§£å†³ï¼Œå°è£…ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ä½¿å¾—ä¸šåŠ¡ action æ— éœ€æŒ‰ç…§é«˜é˜¶ reducer çš„éœ€è¦çš„æ•°æ®æ ¼å¼è¿›è¡Œæ•°æ®åŒ…è£…ï¼Œåšåˆ°çœŸæ­£åœ°å¯æ’æ‹”å¼</li><li>æä¾›æ›´å¤šçš„å‚æ•°ï¼Œä»¥ä¾¿åšåˆ°èŒè´£åˆ†æ˜ï¼Œå‡å°‘è€¦åˆä¾èµ–</li></ul>]]></content>
    
    
    <categories>
      
      <category>Redux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Redux</tag>
      
      <tag>å®ç°æ—¥å¿—æµæ°´</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‡½æ•°ç»„ä»¶ useRef -ç»„ä»¶è®¾è®¡</title>
    <link href="/2022/06/07/%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6%20useRef%20%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"/>
    <url>/2022/06/07/%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6%20useRef%20%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/</url>
    
    <content type="html"><![CDATA[<h2 id="å‡½æ•°ç»„ä»¶-useRef-ç»„ä»¶è®¾è®¡"><a href="#å‡½æ•°ç»„ä»¶-useRef-ç»„ä»¶è®¾è®¡" class="headerlink" title="å‡½æ•°ç»„ä»¶ useRef -ç»„ä»¶è®¾è®¡"></a>å‡½æ•°ç»„ä»¶ useRef -ç»„ä»¶è®¾è®¡</h2><blockquote><p>React ç»„ä»¶çš„ ref å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ‹¿åˆ°ç»„ä»¶çš„å®ä¾‹æˆ–è€… DOM å¯¹è±¡ï¼Œä»è€Œå¯¹ç»„ä»¶å†…éƒ¨è¿›è¡Œä¿®æ”¹ã€‚æ—¥å¸¸å¼€å‘ä¸­ï¼Œä¸ºäº†ä½¿å¾—ç»„ä»¶å…·æœ‰é€šç”¨æ€§ï¼Œå°±éœ€è¦å‡å°‘ç»„ä»¶ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚åˆç†åœ°ä½¿ç”¨ ref ,ä½¿å¾—å­ç»„ä»¶åªéœ€æš´éœ²å‡º ref å®ä¾‹æ–¹æ³• ,çˆ¶ç»„ä»¶æ— éœ€å…³æ³¨å­ç»„ä»¶å†…éƒ¨è°ƒç”¨å­ç»„ä»¶çš„å®ä¾‹æ–¹æ³•ã€‚</p></blockquote><p>æ¶‰åŠåˆ° React ç›¸å…³çš„ API</p><ol><li>[useRef](<a href="https://react.docschina.org/docs/hooks-reference.html#useref">Hook API ç´¢å¼• â€“ React (docschina.org)</a>)</li><li>[forwardRef](<a href="https://zh-hans.reactjs.org/docs/react-api.html#reactforwardref">React é¡¶å±‚ API â€“ React (reactjs.org)</a>)</li><li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#useimperativehandle">useImperativeHandle</a></li><li><a href="https://react-redux.js.org/api/connect">connect</a></li></ol><p><strong>åœºæ™¯ï¼š</strong>ä¸€ä¸ªé¡µé¢æœ‰ä¸ªæŒ‰é’®ï¼Œå¸Œæœ›ç‚¹å‡»åå‡ºç°ä¸€ä¸ªå¼¹çª—ï¼Œæ‰€ä»¥è¿™ä¸ªé¡µé¢å’Œå¼¹çª—ç»„æˆçˆ¶å­ç»„ä»¶çš„å…³ç³»ã€‚ï¼ˆå¼¹çª—å†…éƒ¨æ•°æ®æ˜¯ç”± redux ç®¡ç†ï¼‰</p><p><strong>éœ€æ±‚ï¼š</strong>å¼¹çª—ç»„ä»¶ visible å±æ€§äº¤ç»™è‡ªå·±ç®¡ç†ï¼Œå¸Œæœ›é€šè¿‡ useRef æš´éœ²å‡ºä¸€ä¸ª open() æ–¹æ³•ï¼Œç»™çˆ¶ç»„ä»¶å»ä½¿ç”¨ï¼Œæ— éœ€å…³æ³¨ç»„ä»¶å®ç°ç»†èŠ‚</p><p><strong>å­ç»„ä»¶ï¼š</strong>å¼¹çª—ç»„ä»¶</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@file</span> å¼¹çª—ç»„ä»¶</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, &#123; useState, forwardRef, useImperativeHandle &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Form</span>, <span class="hljs-title class_">Modal</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;antd&#x27;</span><br><span class="hljs-keyword">import</span> &#123; connect &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-redux&#x27;</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Child</span>(<span class="hljs-params">&#123; refInstance &#125;</span>) &#123;<br>  <span class="hljs-comment">// ç»„ä»¶å†…éƒ¨çš„ visible å±æ€§ï¼Œäº¤ç”±ç»„ä»¶è‡ªå·±ç®¡ç†</span><br>  <span class="hljs-keyword">const</span> [visible, setVisible] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>)<br><br>  <span class="hljs-comment">// é€šè¿‡ useImperativeHandle å¯ä»¥æš´éœ²å‡ºç‰¹å®šçš„å®ä¾‹æ–¹æ³•</span><br>  <span class="hljs-title function_">useImperativeHandle</span>(<br>    refInstance,<br>    <span class="hljs-function">() =&gt;</span> (&#123;<br>      <span class="hljs-comment">// æš´éœ²ç»„ä»¶ open() æ–¹æ³•ç»™çˆ¶ç»„ä»¶</span><br>      <span class="hljs-attr">open</span>: <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-title function_">setVisible</span>(<span class="hljs-literal">true</span>)<br>      &#125;,<br>    &#125;),<br>    []<br>  )<br><br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Modal</span></span></span><br><span class="hljs-tag"><span class="language-xml">      <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;è¡¨å•é¢„è§ˆ&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">      <span class="hljs-attr">visible</span>=<span class="hljs-string">&#123;visible&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">      <span class="hljs-attr">footer</span>=<span class="hljs-string">&#123;null&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">      <span class="hljs-attr">onCancel</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> setVisible(false)&#125;</span><br><span class="language-xml">    &gt;</span><br><span class="language-xml">      &#123;</span><br><span class="language-xml">        // å±•ç¤º redux æ•°æ®</span><br><span class="language-xml">        redux_data</span><br><span class="language-xml">      &#125;</span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">Modal</span>&gt;</span></span><br>  )<br>&#125;<br><br><span class="hljs-comment">// connect ç”¨äºæ¥æ”¶ redux æ•°æ®</span><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ChildrRefWrap</span> = <span class="hljs-title function_">connect</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> (&#123;<br>  <span class="hljs-attr">redux_data</span>: state.<span class="hljs-property">redux_data</span>,<br>&#125;))(<span class="hljs-title class_">Render</span>)<br><br><span class="hljs-comment">// forwardRef åµŒå¥—åˆ°æœ€å¤–ä¸€å±‚</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">forwardRef</span>(<span class="hljs-function">(<span class="hljs-params">props, ref</span>) =&gt;</span> (<br>  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">RenderRefWrap</span> &#123;<span class="hljs-attr">...props</span>&#125; <span class="hljs-attr">refInstance</span>=<span class="hljs-string">&#123;ref&#125;</span> /&gt;</span></span><br>))<br></code></pre></div></td></tr></table></figure><p><strong>çˆ¶ç»„ä»¶ï¼š</strong>Father</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, &#123;useRef&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Button</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;antd&quot;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Father</span>(<span class="hljs-params"></span>) &#123;<br>    onst modalRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>)<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">onPreviewClick</span> = (<span class="hljs-params"></span>)=&gt; &#123;<br><span class="hljs-comment">// é€šè¿‡ modalRef å®ä¾‹æš´éœ²å‡º open() æ–¹æ³•ï¼Œæ‰“å¼€é¢„è§ˆModal</span><br>modalRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">open</span>()<br>&#125;<br>  <span class="hljs-keyword">return</span> (<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;primary&quot;</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;small&quot;</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;onPreviewClick&#125;</span>&gt;</span>é¢„è§ˆæ•ˆæœ<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  )<br>&#125;<br><br></code></pre></div></td></tr></table></figure><p><strong>å‚è€ƒï¼š</strong><a href="https://juejin.cn/post/6844904070843482119">React å‡½æ•°å¼ç»„ä»¶ä½¿ç”¨ Ref - æ˜é‡‘ (juejin.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
    </categories>
    
    
    <tags>
      
      <tag>React</tag>
      
      <tag>useRef</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Js ç½‘ç»œè¯·æ±‚ï¼šFetch</title>
    <link href="/2022/06/07/Js%20%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%EF%BC%9AFetch/"/>
    <url>/2022/06/07/Js%20%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%EF%BC%9AFetch/</url>
    
    <content type="html"><![CDATA[<h2 id="Js-ç½‘ç»œè¯·æ±‚ï¼šFetch"><a href="#Js-ç½‘ç»œè¯·æ±‚ï¼šFetch" class="headerlink" title="Js ç½‘ç»œè¯·æ±‚ï¼šFetch"></a>Js ç½‘ç»œè¯·æ±‚ï¼šFetch</h2><blockquote><p>â€‹ å‰è¨€ï¼Œä¸ºäº†å‡å°‘ SDK çš„ä½“ç§¯ï¼Œè®¡åˆ’ä½¿ç”¨åº•å±‚ API è¿›è¡Œå¼€å‘ï¼Œä¹‹å‰æœ‰å¬è¿‡ Fetchï¼Œç‰¹åœ°è¿‡æ¥è°ƒç ”è®°å½•ä¸‹</p></blockquote><p>å®˜æ–¹æ–‡æ¡£ï¼š</p><p>Fetch API:<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API/Using_Fetch">ä½¿ç”¨ Fetch - Web API æ¥å£å‚è€ƒ | MDN (mozilla.org)</a></p><p>XMLHttpRequest API: <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest">ä½¿ç”¨ XMLHttpRequest - Web API æ¥å£å‚è€ƒ | MDN (mozilla.org)</a></p><h3 id="01-å†å²åŸå› "><a href="#01-å†å²åŸå› " class="headerlink" title="01 å†å²åŸå› "></a>01 å†å²åŸå› </h3><p>XMLHttpRequest ï¼Œåˆç§° xhrã€‚å¾ˆæ—©å°±é—®ä¸–äº†ï¼Œæ‰€ä»¥åœ¨ä»¥å¾€çš„åº”ç”¨ä¸­ï¼Œå¸¸å¸¸ä½¿ç”¨ Promise å°è£…å¥½çš„å½¢å¼ï¼ˆaxiosï¼‰å‡ºç°åœ¨æˆ‘ä»¬è§†é‡ä¸­ã€‚ä½†æ˜¯å®ƒæœ‰äº›æ˜æ˜¾çš„ç¼ºç‚¹ï¼Œé…ç½®ç¹æ‚ï¼Œä¸æ”¯æŒ Promise å’Œæ¥å£å•ä¸€ï¼Œå®¹æ˜“å†™å‡ºéå¸¸æ··ä¹±çš„ä»£ç ã€‚</p><p>åæ¥ï¼ŒFetch ä½œä¸ºåæµªå‡ºé“äº†ï¼Œæ±Ÿæ¹–äººç§° xhr çš„å‡çº§ç‰ˆï¼Œä½†ï¼Fetch å¹¶ä¸å±äº xhr ï¼Œä»–ä»¬ä¿©åŒçº§ï¼Œéƒ½å±äº JS çš„åº•å±‚ APIï¼Œæœ€å¤šç®¡å«å“¥ä»¬ã€‚</p><blockquote><p>Fetch ä¼˜ç‚¹ï¼š</p><ul><li>é‡‡ç”¨ Promise ï¼Œä½¿å¾—ä»£ç æ›´ç®€æ´ä¼˜é›…</li><li>é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼ŒAPI è®¾è®¡æ›´åŠ åˆç†ï¼Œæ¥å£åˆ†ç¦»åˆ°ä¸‰ä¸ªå¯¹è±¡ä¸Šï¼ŒResponse å¯¹è±¡ï¼ŒRequest å¯¹è±¡ï¼ŒHeader å¯¹è±¡</li><li>é€šè¿‡æ•°æ®æµå¤„ç†æ•°æ®ï¼Œæ”¯æŒåˆ†å—è¯»å–ï¼Œå¯¹äºè¯·æ±‚å¤§æ–‡ä»¶å’Œç½‘é€Ÿæ…¢æœ‰å¥‡æ•ˆ</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>å…¼å®¹æ€§æ²¡æœ‰ xhr æ”¯æŒé‚£ä¹ˆå¥½</li><li>åŸç”Ÿ Fetch ä¸æ”¯æŒç›‘æµ‹è¿›åº¦ï¼Œä½† xhr å¯ä»¥</li></ul></blockquote><h3 id="02-ä»£ç å¯¹æ¯”"><a href="#02-ä»£ç å¯¹æ¯”" class="headerlink" title="02 ä»£ç å¯¹æ¯”"></a>02 ä»£ç å¯¹æ¯”</h3><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// ä¼ ç»Ÿçš„ xhr è¯·æ±‚</span><br><span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;GET&#x27;</span>, url);<br>xhr.<span class="hljs-property">responseType</span> = <span class="hljs-string">&#x27;json&#x27;</span>;<br><br>xhr.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(xhr.<span class="hljs-property">response</span>);<br>&#125;;<br><br>xhr.<span class="hljs-property">onerror</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Oops, error&quot;</span>);<br>&#125;;<br><br>xhr.<span class="hljs-title function_">send</span>();<br><br><span class="hljs-comment">// fetch è¯·æ±‚</span><br><span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;http://example.com/movies.json&#x27;</span>)<br>  .<span class="hljs-title function_">then</span>( <span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> response.<span class="hljs-title function_">json</span>() )<br>  .<span class="hljs-title function_">then</span>( <span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data) );<br>  .<span class="hljs-title function_">catch</span>( <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err))<br></code></pre></div></td></tr></table></figure><p>ç›¸æ¯”ä¸‹ï¼ŒFetch API æ›´åŠ ç®€æ´æ˜äº†ã€‚</p><p><strong>ä½†æ˜¯ï¼Œä¸ä¼ ç»Ÿ ajax ç›¸æ¯”ï¼š</strong></p><ul><li>å½“æ¥æ”¶åˆ°ä¸€ä¸ªä»£è¡¨é”™è¯¯çš„ HTTP çŠ¶æ€ç æ—¶ï¼Œä» <code>fetch()</code> è¿”å›çš„ Promise <strong>ä¸ä¼šè¢«æ ‡è®°ä¸º reject</strong>ï¼Œå³ä½¿å“åº”çš„ HTTP çŠ¶æ€ç æ˜¯ 404 æˆ– 500ã€‚ç›¸åï¼Œå®ƒä¼šå°† Promise çŠ¶æ€æ ‡è®°ä¸º resolve ï¼ˆå¦‚æœå“åº”çš„ HTTP çŠ¶æ€ç ä¸åœ¨ 200 - 299 çš„èŒƒå›´å†…ï¼Œåˆ™è®¾ç½® resolve è¿”å›å€¼çš„ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Response/ok"><code>ok</code></a> å±æ€§ä¸º false ï¼‰ï¼Œä»…å½“ç½‘ç»œæ•…éšœæ—¶æˆ–è¯·æ±‚è¢«é˜»æ­¢æ—¶ï¼Œæ‰ä¼šæ ‡è®°ä¸º rejectã€‚</li><li><code>fetch</code> <strong>ä¸ä¼šå‘é€è·¨åŸŸ cookies</strong>ï¼Œéœ€è¦é…ç½® <code>credentials=&quot;include&quot;</code></li></ul><p><strong>æˆ‘ä»¬å¯ä»¥æ”¹é€ ä¸Šé¢çš„å†™æ³•</strong>ï¼š</p><p>Promise å¯ä»¥ä½¿ç”¨ await è¯­æ³•æ”¹å†™ï¼Œä½¿å¾—è¯­ä¹‰æ›´æ¸…æ™°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// ä¸‹é¢ç¤ºä¾‹ä¸­ï¼Œawaitè¯­å¥å¿…é¡»æ”¾åœ¨try...catché‡Œé¢ï¼Œè¿™æ ·æ‰èƒ½æ•æ‰å¼‚æ­¥æ“ä½œä¸­å¯èƒ½å‘ç”Ÿçš„é”™è¯¯ã€‚</span><br><span class="hljs-keyword">try</span> &#123;<br>  <span class="hljs-keyword">let</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(url)<br>  <span class="hljs-keyword">let</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>()<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)<br>&#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Oops, error&#x27;</span>, e)<br>&#125;<br></code></pre></div></td></tr></table></figure><p>03 å°è£… Fetch API</p>]]></content>
    
    
    <categories>
      
      <category>Fetch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¼‚æ­¥è¯·æ±‚</tag>
      
      <tag>Fetch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XHR  API -- withCredentials</title>
    <link href="/2022/06/07/XHR%20%20API%20--%20withCredentials/"/>
    <url>/2022/06/07/XHR%20%20API%20--%20withCredentials/</url>
    
    <content type="html"><![CDATA[<h2 id="XHR-API-â€“-withCredentials"><a href="#XHR-API-â€“-withCredentials" class="headerlink" title="XHR API â€“ withCredentials"></a>XHR API â€“ withCredentials</h2><blockquote><p>å‰è¨€ï¼š ä»Šå¤©æƒ³è®²è®²è¿™ä¸ª APIï¼Œå‰å‡ å¤©å°è£…çš„ XHRï¼Œåœ¨ä½¿ç”¨é™¤äº†é—®é¢˜ï¼Œå‘é€ POST è¯·æ±‚æ— è®ºå¦‚ä½•éƒ½æç¤ºè·¨åŸŸäº†ã€‚ï¼ˆæœåŠ¡ç«¯å“åº”å¤´éƒ½è®¾ç½®å¥½æƒ…å†µä¸‹ï¼‰</p></blockquote><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/withCredentials">XMLHttpRequest.withCredentials - Web API æ¥å£å‚è€ƒ | MDN (mozilla.org)</a></p><h3 id="01-è¿˜åŸç°åœº"><a href="#01-è¿˜åŸç°åœº" class="headerlink" title="01 è¿˜åŸç°åœº"></a>01 è¿˜åŸç°åœº</h3><p>ä¸‹é¢ä»£ç æ˜¯ç®€å•çš„ XHR å°è£…ï¼Œ ä¸»è¦å‡ºé—®é¢˜çš„å‚æ•°æ˜¯ <code>withCredentials = true</code></p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">request</span> (&#123;<br>    <span class="hljs-attr">method</span>: string<br><span class="hljs-attr">url</span>: string<br>data?: string | object<br>success?: <span class="hljs-function">(<span class="hljs-params">res: <span class="hljs-built_in">Object</span></span>) =&gt;</span> <span class="hljs-keyword">void</span><br>fail?: <span class="hljs-function">(<span class="hljs-params">status: number</span>) =&gt;</span> <span class="hljs-keyword">void</span><br>&#125;) &#123;<br>    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªè¯·æ±‚</span><br>    <span class="hljs-keyword">const</span> request = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span> ()<br><br>    <span class="hljs-comment">// è®¾ç½®è¯·æ±‚æ–¹æ³•ã€è¯·æ±‚åœ°å€ã€æ˜¯å¦å¼‚æ­¥</span><br>    request.<span class="hljs-title function_">open</span>(method.<span class="hljs-title function_">toUpperCase</span>(), url, <span class="hljs-literal">true</span>)<br><br>    <span class="hljs-comment">// è®¾ç½®è¯·æ±‚å¤´</span><br>    request.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">&quot;Content-Type&quot;</span>, <span class="hljs-string">&quot;application/json&quot;</span>)<br><br>    <span class="hljs-comment">// &gt;--------é—®é¢˜å‡ºå¤„--------&lt;</span><br>    request.<span class="hljs-property">withCredentials</span> = <span class="hljs-literal">true</span><br>    <span class="hljs-comment">// &gt;-----------------------&lt;</span><br><br>    <span class="hljs-comment">// å‘é€è¯·æ±‚</span><br>    request.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data))<br><br>    <span class="hljs-comment">// æ¥æ”¶å“åº”</span><br>    request.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-keyword">if</span> (request.<span class="hljs-property">readyState</span> !== <span class="hljs-number">4</span>) &#123;<br>            <span class="hljs-keyword">return</span><br>        &#125;<br><br>        <span class="hljs-comment">// åˆ¤æ–­å“åº”çŠ¶æ€</span><br>        <span class="hljs-keyword">if</span> (request.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) &#123;<br>            <span class="hljs-comment">// è¯·æ±‚æˆåŠŸ</span><br>            <span class="hljs-keyword">const</span> res = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(request.<span class="hljs-property">responseText</span>)<br>            success &amp;&amp; <span class="hljs-title function_">success</span>(res)<br>            <span class="hljs-title function_">resolve</span>(res)<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// è¯·æ±‚å¤±è´¥</span><br>            fail &amp;&amp; <span class="hljs-title function_">fail</span>(request.<span class="hljs-property">status</span>)<br>            <span class="hljs-title function_">reject</span>(<span class="hljs-string">&quot;è¯·æ±‚å¤±è´¥,è¯·æ£€æŸ¥ç½‘ç»œ!&quot;</span>)<br>        &#125;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-comment">// &gt;---å‘é€ä¸€ä¸ª POST è¯·æ±‚---&lt;</span><br><span class="hljs-title function_">request</span>(&#123;<br>    <span class="hljs-attr">method</span>:<span class="hljs-string">&quot;POST&quot;</span>,<br>    <span class="hljs-attr">URL</span>:<span class="hljs-string">&quot;XXXXX&quot;</span>,<br>    <span class="hljs-attr">data</span>:&#123;<br>        <span class="hljs-attr">name</span>:<span class="hljs-string">&quot;DuoR&quot;</span><br>    &#125;<br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res)<br>&#125;).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err)<br>&#125;)<br></code></pre></div></td></tr></table></figure><p><strong>æŠ¥é”™ä¿¡æ¯ï¼š</strong></p><p><img src="https://s2.loli.net/2022/06/06/pcogUiSCLjv3GWf.png" alt="image-20220606173840097"></p><h3 id="02-åŸå› åˆ†æ"><a href="#02-åŸå› åˆ†æ" class="headerlink" title="02 åŸå› åˆ†æ"></a>02 åŸå› åˆ†æ</h3><blockquote><p>withCredentials API é»˜è®¤ä¸º false ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å½“å‘é€è·¨åŸŸè¯·æ±‚æ—¶ï¼Œæ— è®º Access-Control- Header è®¾ç½®ä»€ä¹ˆï¼Œéƒ½ä¸æ— æ³•ä¸ºç«™ç‚¹è®¾ç½® Cookie å€¼ï¼Œåªæœ‰å½“è®¾ç½®ä¸º true æ‰èƒ½è®¾ç½®ã€‚</p></blockquote><p>ä¸Šé¢çš„æŠ¥é”™è§£é‡Šï¼Œå½“ credentials mode ä¸º include æ—¶ï¼ŒAccess-Control-Allow-Origin å“åº”å¤´ä¸å¯ä»¥è®¾ç½®ä¸º â€œ*â€ï¼Œå¿…é¡»æ˜ç¡® urlï¼ˆå¯èƒ½æ˜¯å‡ºäºå®‰å…¨è€ƒè™‘ï¼‰ã€‚ é€šè¿‡ XMLHttpRequest çš„ withCredentials å¯ä»¥è®¾ç½®ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>XMLHttpRequest</category>
      
    </categories>
    
    
    <tags>
      
      <tag>XMLHttpRequest</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XHRåŸå‹é“¾æ”¹é€ æ€è·¯</title>
    <link href="/2022/06/07/XHR%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%94%B9%E9%80%A0%E6%80%9D%E8%B7%AF/"/>
    <url>/2022/06/07/XHR%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%94%B9%E9%80%A0%E6%80%9D%E8%B7%AF/</url>
    
    <content type="html"><![CDATA[<h2 id="XHR-åŸå‹é“¾æ”¹é€ æ€è·¯"><a href="#XHR-åŸå‹é“¾æ”¹é€ æ€è·¯" class="headerlink" title="XHR åŸå‹é“¾æ”¹é€ æ€è·¯"></a>XHR åŸå‹é“¾æ”¹é€ æ€è·¯</h2><blockquote><p>é€šè¿‡ä¸‹é¢çš„æ¡ˆä¾‹ï¼Œä¸ºå¤§å®¶å‘æ•£ä¸‹æ€ç»´ï¼Œæ”¹é€ åŸå‹é“¾ä¸Šçš„æ–¹æ³•ï¼Œå¯ä»¥åšå¾—äº‹æƒ…å¾ˆå¤šã€‚æ¯”å¦‚æˆ‘ä»¬é€šè¿‡æ”¹é€  XMLHttpRequest å¯¹è±¡åŸå‹é“¾ä¸Šçš„ <code>open</code>ã€<code>send</code>æ–¹æ³•ï¼Œå¯ä»¥å®ç°å‰ç«¯åŸ‹ç‚¹ï¼Œxhr, axios è¯·æ±‚æ‹¦æˆªå™¨ç­‰ç­‰</p></blockquote><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * xhr, axiosè¯·æ±‚æ‹¦æˆª</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">interceptAjax</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> &#123; open, send &#125; = <span class="hljs-title class_">XMLHttpRequest</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span><br><br>  <span class="hljs-comment">// åŠ«æŒ openæ–¹æ³•</span><br>  <span class="hljs-title class_">XMLHttpRequest</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">open</span> = <span class="hljs-keyword">function</span> <span class="hljs-title function_">openXHR</span>(<span class="hljs-params">...args</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;%c - open -&#x27;</span>, <span class="hljs-string">&#x27;background: orange;color: white&#x27;</span>)<br>    <span class="hljs-keyword">return</span> open.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args)<br>  &#125;<br><br>  <span class="hljs-comment">// åŠ«æŒ sendæ–¹æ³•</span><br>  <span class="hljs-title class_">XMLHttpRequest</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">send</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">body</span>) &#123;<br>    <span class="hljs-comment">// body å°±æ˜¯postæ–¹æ³•æºå¸¦çš„å‚æ•°</span><br><br>    <span class="hljs-comment">// readyStateå‘ç”Ÿæ”¹å˜æ—¶è§¦å‘,ä¹Ÿå°±æ˜¯è¯·æ±‚çŠ¶æ€æ”¹å˜æ—¶</span><br>    <span class="hljs-comment">// readyState ä¼šä¾æ¬¡å˜ä¸º 2,3,4 ä¹Ÿå°±æ˜¯ä¼šè§¦å‘ä¸‰æ¬¡è¿™é‡Œ</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;readystatechange&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-keyword">const</span> &#123;<br>        readyState,<br>        status,<br>        responseURL = _config.<span class="hljs-property">src</span>,<br>        responseText,<br>      &#125; = <span class="hljs-variable language_">this</span><br>      <span class="hljs-keyword">if</span> (readyState === <span class="hljs-number">4</span>) &#123;<br>        <span class="hljs-comment">// è¯·æ±‚å·²å®Œæˆ,ä¸”å“åº”å·²å°±ç»ª</span><br>        <span class="hljs-keyword">if</span> (status === <span class="hljs-number">200</span> || status === <span class="hljs-number">304</span>) &#123;<br>          <span class="hljs-comment">// è¯·æ±‚æˆåŠŸ</span><br>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<br>            <span class="hljs-string">&#x27;%c - response successful -&#x27;</span>,<br>            <span class="hljs-string">&#x27;background: green;color: white&#x27;</span><br>          )<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-comment">// è¯·æ±‚å¤±è´¥ï¼Œè¿™é‡Œå¯ä»¥åšå‰ç«¯åŸ‹ç‚¹ï¼Œæ¯”å¦‚è¯´é”™è¯¯ä¸ŠæŠ¥ç­‰</span><br>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;%c - response failed -&#x27;</span>, <span class="hljs-string">&#x27;background: red;color: white&#x27;</span>)<br>        &#125;<br>      &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">return</span> send.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, body)<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p><strong>æ•ˆæœå›¾ï¼š</strong></p><p><img src="https://s2.loli.net/2022/06/02/NrhCMi58ptqcI4w.gif" alt="GIF 2022-6-2 0-21-42"></p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>XMLHttpRequest</tag>
      
      <tag>åŸå‹é“¾æ”¹é€ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®¤è¯† HTMLElement.dataset</title>
    <link href="/2022/06/07/%E8%AE%A4%E8%AF%86%20HTMLElement.dataset/"/>
    <url>/2022/06/07/%E8%AE%A4%E8%AF%86%20HTMLElement.dataset/</url>
    
    <content type="html"><![CDATA[<h2 id="è®¤è¯†-HTMLElement-dataset"><a href="#è®¤è¯†-HTMLElement-dataset" class="headerlink" title="è®¤è¯† HTMLElement.dataset"></a>è®¤è¯† HTMLElement.dataset</h2><p>å®˜æ–¹è§£é‡Šï¼š<a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/dataset">HTMLElement.dataset - Web APIs | MDN (mozilla.org)</a></p><blockquote><p>åšäº›ä½ä»£ç ç¢°åˆ°ä¸€ä¸ªæ ‡ç­¾ä¼ å‚çš„é—®é¢˜ï¼Œé€šè¿‡æ ‡ç­¾ dataset è§£å†³çš„</p></blockquote><h3 id="01-dataSet-æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Ÿ"><a href="#01-dataSet-æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Ÿ" class="headerlink" title="01 dataSet æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Ÿ"></a>01 dataSet æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Ÿ</h3><p>å®ƒæ˜¯ H5 æ ‡å‡†å…è®¸ä½ åœ¨æ™®é€šçš„å…ƒç´ æ ‡ç­¾é‡Œï¼ŒåµŒå…¥ç±»ä¼¼ data-*çš„å±æ€§ï¼Œæ¥å®ç°ä¸€äº›ç®€å•æ•°æ®çš„å­˜å–ã€‚å¸¸è§çš„ä½¿ç”¨åœºæ™¯ï¼Œæ¯”å¦‚æœ‰äº›æ ‡ç­¾ï¼Œä½ æ˜¯æƒ³å¸¦å…¥ä¸€äº›å‚æ•°çš„ï¼Œæ–¹ä¾¿å…¶ä»–é¡µé¢æ‹¿åˆ°æ ‡ç­¾ï¼Œå¯ä»¥è·å–å…¶ä¸­çš„å‚æ•°ï¼Œå°±å¯ä»¥ä½¿ç”¨ dataset è¿›è¡Œæ•°æ®é¢„è®¾æˆ–å­˜å‚¨ã€‚</p><h3 id="02-ä½¿ç”¨æ¡ˆä¾‹"><a href="#02-ä½¿ç”¨æ¡ˆä¾‹" class="headerlink" title="02 ä½¿ç”¨æ¡ˆä¾‹"></a>02 ä½¿ç”¨æ¡ˆä¾‹</h3><ul><li>åˆ©ç”¨ DOM èŠ‚ç‚¹ getAttribute</li></ul><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;article&quot;</span> <span class="hljs-attr">data-id</span>=<span class="hljs-string">&quot;1&quot;</span> <span class="hljs-attr">data-author</span>=<span class="hljs-string">&quot;DuoR&quot;</span>&gt;</span>æ–‡ç« <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></div></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// é€šè¿‡ getAttribute</span><br><span class="hljs-keyword">var</span> article = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;article&#x27;</span>)<br><span class="hljs-keyword">var</span> id = article.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;data-id&#x27;</span>)<br><span class="hljs-keyword">var</span> author = article.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">&#x27;data-author&#x27;</span>)<br></code></pre></div></td></tr></table></figure><ul><li><p>åˆ©ç”¨ dataset API</p><p>é€šè¿‡ dataset APIï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ–¹ä¾¿çš„è·å–å…ƒç´ çš„æ‰€æœ‰ data å­—æ®µï¼Œå¹¶ä»¥å¯¹è±¡çš„æ–¹å¼ï¼Œæ–¹ä¾¿å­˜å–å’Œéå†</p></li></ul><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// dataset API</span><br><span class="hljs-keyword">var</span> article = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;article&#x27;</span>)<br><span class="hljs-keyword">var</span> ds = article.<span class="hljs-property">dataset</span><br><span class="hljs-keyword">var</span> id = ds.<span class="hljs-property">id</span><br><span class="hljs-keyword">var</span> author = da.<span class="hljs-property">author</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>HTML</category>
      
    </categories>
    
    
    <tags>
      
      <tag>HTML</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯ä¼˜åŒ–ï¼šç«æ€æ¡ä»¶</title>
    <link href="/2022/06/07/%E5%89%8D%E7%AB%AF%E4%BC%98%E5%8C%96%EF%BC%9A%E7%AB%9E%E6%80%81%E6%9D%A1%E4%BB%B6/"/>
    <url>/2022/06/07/%E5%89%8D%E7%AB%AF%E4%BC%98%E5%8C%96%EF%BC%9A%E7%AB%9E%E6%80%81%E6%9D%A1%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰ç«¯ä¼˜åŒ–ï¼šç«æ€æ¡ä»¶"><a href="#å‰ç«¯ä¼˜åŒ–ï¼šç«æ€æ¡ä»¶" class="headerlink" title="å‰ç«¯ä¼˜åŒ–ï¼šç«æ€æ¡ä»¶"></a>å‰ç«¯ä¼˜åŒ–ï¼šç«æ€æ¡ä»¶</h2><h3 id="01-ä»€ä¹ˆæ˜¯ç«æ€æ¡ä»¶ï¼Ÿ"><a href="#01-ä»€ä¹ˆæ˜¯ç«æ€æ¡ä»¶ï¼Ÿ" class="headerlink" title="01 ä»€ä¹ˆæ˜¯ç«æ€æ¡ä»¶ï¼Ÿ"></a>01 ä»€ä¹ˆæ˜¯ç«æ€æ¡ä»¶ï¼Ÿ</h3><blockquote><p>åœ¨æ—¥å¸¸ Web å¼€å‘ä¸­ï¼Œæ¸²æŸ“ç•Œé¢ä¸€èˆ¬æ˜¯ç»è¿‡è¯·æ±‚ AJAXï¼Œç»è¿‡å¤æ‚çš„ç½‘ç»œç¯å¢ƒï¼Œå°†å¾—åˆ°æ•°æ®æ¸²æŸ“åˆ°é¡µé¢ä¸Šã€‚ç”±äºè¦ç»è¿‡å¤æ‚ç½‘ç»œç¯å¢ƒï¼Œéš¾å…ä¼šé‡åˆ°ç‰¹æ®Šæƒ…å†µï¼Œå½“æˆ‘ä»¬å…ˆåè¯·æ±‚ä¸¤ä¸ªæ•°æ®ï¼Œç”±äºç½‘ç»œåŸå› ï¼Œå¯èƒ½ç¬¬äºŒæ¡æ¯”ç¬¬ä¸€æ¡å…ˆå“åº”ï¼Œå¯¼è‡´ç¬¬äºŒæ¡æ•°æ®ä¼šæ¯”ç¬¬ä¸€æ¡å…ˆæ¸²æŸ“åˆ°é¡µé¢ä¸Šï¼Œæ¥ç€å½“ç¬¬ä¸€æ¡æ•°æ®å“åº”åï¼Œä¼šå°†ç¬¬äºŒæ¡æ¸²æŸ“çš„æ•°æ®è¦†ç›–æ¸²æŸ“åˆ°é¡µé¢ä¸Šã€‚å¯¼è‡´ç”¨æˆ·ä½“éªŒéå¸¸ä¸å¥½ã€‚</p></blockquote><p>æ¥ï¼ä¸Š GIF å›¾æ›´åŠ ç›´è§‚ã€‚</p><ol><li>é¦–å…ˆï¼Œç‚¹å‡» Git çš„é‚£äº›äº‹</li><li>ä¹‹åï¼Œå†ç‚¹å‡» EventLoop å’Œæµè§ˆå™¨æ¸²æŸ“</li><li>å‘ç°ï¼Œåè€Œç¬¬ä¸€æ¬¡ç‚¹å‡»æ•°æ•°æ®è¦†ç›–ç¬¬äºŒæ¬¡ç‚¹å‡»çš„æ•°æ®</li></ol><p><img src="https://s2.loli.net/2022/06/01/NSF7WZmBkrv5UEb.gif" alt="GIF 2022-6-1 0-01-46"></p><h3 id="02-è§£å†³æ–¹æ¡ˆ"><a href="#02-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="02 è§£å†³æ–¹æ¡ˆ"></a>02 è§£å†³æ–¹æ¡ˆ</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸­æ­¢ä¸Šä¸€ä¸ªè¯·æ±‚ä»è€Œè¾¾åˆ°ç›®çš„ï¼Œæ–¹æ¡ˆå¦‚ä¸‹ï¼š</p><blockquote><ol><li>axios æä¾› CancelToken API</li><li>åŸç”Ÿ XHR æä¾› abort API</li></ol></blockquote><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// ---------ä¼ªä»£ç ---------</span><br><br><span class="hljs-keyword">const</span> cancelToken = axios.<span class="hljs-property">CancelToken</span><br><span class="hljs-keyword">let</span> request = <span class="hljs-literal">null</span> <span class="hljs-comment">// è®°å½•ä¸Šæ¬¡è¯·æ±‚</span><br><br><span class="hljs-comment">// æ¯å½“æ–°çš„è¯·æ±‚æ—¶ï¼Œå‡ºå‘ä¸‹é¢çš„å‡½æ•°</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getArticleRequest</span> (articleId)&#123;<br>  <span class="hljs-keyword">if</span>(request)&#123;<br>    <span class="hljs-comment">// ä¸­æ­¢ä¸Šä¸€ä¸ªè¯·æ±‚</span><br>   request.<span class="hljs-title function_">cancel</span>()<br>  &#125;<br>  <span class="hljs-comment">// CancelToken.source()å·¥å‚å‡½æ•°ï¼Œè®°å½•ä¸Šæ¬¡è¯·æ±‚</span><br>  source = cancelToken.<span class="hljs-title function_">source</span>()<br>  axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">`/getarticle/<span class="hljs-subst">$&#123;articleId&#125;</span>`</span>ï¼Œ &#123;<br>  <span class="hljs-attr">cancelToken</span>: source.<span class="hljs-property">token</span> <span class="hljs-comment">// å–æ¶ˆè¯·æ±‚token</span><br>  &#125;)<br>&#125;<br></code></pre></div></td></tr></table></figure><p><img src="https://s2.loli.net/2022/06/01/8HkW4F2OsGq7tQN.gif" alt="GIF 2022-6-1 10-17-49"></p>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯ä¼˜åŒ–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰ç«¯ä¼˜åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>memo å’Œ useCallback æ­é…ä½¿ç”¨</title>
    <link href="/2022/04/20/memo%20%E5%92%8C%20useCallback%20%E6%90%AD%E9%85%8D%E4%BD%BF%E7%94%A8/"/>
    <url>/2022/04/20/memo%20%E5%92%8C%20useCallback%20%E6%90%AD%E9%85%8D%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="memo-å’Œ-useCallback-æ­é…ä½¿ç”¨"><a href="#memo-å’Œ-useCallback-æ­é…ä½¿ç”¨" class="headerlink" title="memo å’Œ useCallback æ­é…ä½¿ç”¨"></a>memo å’Œ useCallback æ­é…ä½¿ç”¨</h2><blockquote><p>å‰è¨€ï¼Œå¼€å‘æ—¶ï¼Œå½“çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ï¼Œå®ƒçš„å­ç»„ä»¶ä¹Ÿä¼šè·Ÿç€é‡æ–°æ¸²æŸ“ã€‚ä½†æ˜¯æœ‰ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯æˆ‘å­ç»„ä»¶çš„æ•°æ®æ˜¯æ²¡æœ‰å‘ç”Ÿæ”¹å˜çš„ï¼Œæ˜¯ä¸éœ€è¦è¿›è¡Œé‡æ–°æ¸²æŸ“ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå°±å¯ä»¥é‡‡ç”¨ memo å’Œ useCallback æ­é…å¯¹ç»„ä»¶è¿›è¡Œä¸€ä¸ªä¼˜åŒ–ã€‚</p></blockquote><h3 id="01-éœ€æ±‚"><a href="#01-éœ€æ±‚" class="headerlink" title="01 éœ€æ±‚"></a>01 éœ€æ±‚</h3><blockquote><p>çˆ¶ç»„ä»¶ App é‡Œé¢æœ‰äº† A ç»„ä»¶ã€B ç»„ä»¶ï¼Œçˆ¶ç»„ä»¶ App ç®¡ç† count æ•°æ®ï¼ŒA ç»„ä»¶è´Ÿè´£å±•ç¤º count æ•°æ®ï¼ŒB ç»„ä»¶å±•ç¤ºæŒ‰é’®ï¼Œè´Ÿè´£ count ç›¸å…³æ“ä½œã€‚</p></blockquote><p><img src="https://s2.loli.net/2022/04/06/LUJvOKhnIyk3PNp.png" alt="image-20220406153329424"></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œä½†æ˜¯ï¼Œæˆ‘åªæƒ³è¯´å½“ count æ”¹å˜æ—¶ï¼Œ<strong>åªæ›´æ–° A ç»„ä»¶</strong>é‡æ–°æ¸²æŸ“ã€‚B ç»„ä»¶æ˜¯æ²¡æœ‰å¿…è¦é‡æ–°æ¸²æŸ“çš„ï¼Œå‡å°‘æ€§èƒ½å¼€é”€</p><h3 id="02-æºç è§£æ"><a href="#02-æºç è§£æ" class="headerlink" title="02 æºç è§£æ"></a>02 æºç è§£æ</h3><p><code>react</code> çš„ <code>Hooks</code> ç»„ä»¶å¯¹ <code>props</code> çš„æµ…æ¯”è¾ƒæ˜¯åœ¨ memo é‡Œé¢æ¯”è¾ƒçš„ï¼ˆç±»ç»„ä»¶æ˜¯åœ¨ <code>shouldComponentUpdate</code> é‡Œé¢ï¼‰ï¼Œå¦‚æœæ²¡æœ‰ <code>memo</code>ï¼Œé‚£ä¹ˆä½ ä½¿ç”¨ <code>useCallback</code> å°±æ²¡å•¥æ„ä¹‰ï¼Œåè€Œæµªè´¹æ€§èƒ½ï¼ˆå› ä¸º <code>useCallback </code>æ¥åŒ…è£¹å‡½æ•°ä¹Ÿæ˜¯éœ€è¦å¼€é”€çš„ï¼‰ã€‚å› ä¸ºå­ç»„ä»¶è¿˜æ˜¯ä¼šé‡æ–°æ¸²æŸ“ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// App çˆ¶ç»„ä»¶</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, &#123; useCallback, useState &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><span class="hljs-keyword">import</span> A <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./components/A&#x27;</span><br><span class="hljs-keyword">import</span> B <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./components/B&#x27;</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>)<br>  <span class="hljs-comment">// è¿”å›æ˜¯ä¸€ä¸ª memoized å›è°ƒå‡½æ•°ï¼Œ æ­é…Bç»„ä»¶çš„ memo ä½¿ç”¨</span><br>  <span class="hljs-keyword">const</span> add = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setCount</span>(<span class="hljs-function">(<span class="hljs-params">c</span>) =&gt;</span> c + <span class="hljs-number">1</span>), [])<br><br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;App&quot;</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">A</span> <span class="hljs-attr">count</span>=<span class="hljs-string">&#123;count&#125;</span> /&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">B</span> <span class="hljs-attr">addCount</span>=<span class="hljs-string">&#123;add&#125;</span> /&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  )<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span><br></code></pre></div></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// Aç»„ä»¶ å­ç»„ä»¶</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">A</span>(<span class="hljs-params">&#123; count = <span class="hljs-number">0</span> &#125;</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Aç»„ä»¶&#x27;</span>)<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Aç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>å½“å‰è®¡æ•°ä¸ºï¼š&#123;count&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  )<br>&#125;<br></code></pre></div></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// Bç»„ä»¶ å­ç»„ä»¶</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">B</span>(<span class="hljs-params">&#123;</span><br><span class="hljs-params">  addCount = () =&gt; &#123;&#125;, // å¯¹ props è¿›è¡Œä¸€æ¬¡æµ…æ¯”è¾ƒ</span><br><span class="hljs-params">&#125;</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Bç»„ä»¶&#x27;</span>)<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Bç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;addCount&#125;</span>&gt;</span>+ 1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  )<br>&#125;<br><span class="hljs-comment">// æ³¨æ„è¿™è¾¹ï¼Œæ·»åŠ  memo å¯¹Bç»„ä»¶è¿›è¡ŒåŒ…è£¹</span><br><span class="hljs-comment">// å½“ä¼ è¿›çš„ addCount æ²¡æœ‰å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒBç»„ä»¶ä¸ä¼šè¿›è¡Œæ¸²æŸ“</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">React</span>.<span class="hljs-title function_">memo</span>(B)<br></code></pre></div></td></tr></table></figure><h3 id="03-æ•ˆæœ"><a href="#03-æ•ˆæœ" class="headerlink" title="03 æ•ˆæœ"></a>03 æ•ˆæœ</h3><p>æ²¡æœ‰è¿›è¡Œä¼˜åŒ–ï¼Œæ­£å¸¸ç»å¸¸ï¼ŒA å’Œ B ç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“</p><p><img src="https://s2.loli.net/2022/04/06/qwm2HcsLFi81BP3.gif" alt="GIF 2022-4-6 15-47-28"></p><p>ä½¿ç”¨ <code>memo</code> å’Œ <code>useCallback</code> ä¼˜åŒ–è¿‡å</p><p><img src="https://s2.loli.net/2022/04/06/ErUZYi3hF28JbKP.gif" alt="GIF 2022-4-6 15-48-19"></p><h3 id="04-memo-æ‰©å±•"><a href="#04-memo-æ‰©å±•" class="headerlink" title="04 memo æ‰©å±•"></a>04 memo æ‰©å±•</h3><p>é»˜è®¤æƒ…å†µä¸‹å…¶åªä¼šå¯¹å¤æ‚å¯¹è±¡åš<strong>æµ…å±‚å¯¹æ¯”</strong>ï¼Œå¦‚æœä½ æƒ³è¦æ§åˆ¶å¯¹æ¯”è¿‡ç¨‹ï¼Œé‚£ä¹ˆè¯·å°†è‡ªå®šä¹‰çš„æ¯”è¾ƒå‡½æ•°é€šè¿‡ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥æ¥å®ç°ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hook</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>React ä¸‹å•æµ‹å…¥é—¨ï¼ˆ2ï¼‰</title>
    <link href="/2022/04/20/React%20%E4%B8%8B%E5%8D%95%E6%B5%8B%E5%85%A5%E9%97%A8%EF%BC%882%EF%BC%89/"/>
    <url>/2022/04/20/React%20%E4%B8%8B%E5%8D%95%E6%B5%8B%E5%85%A5%E9%97%A8%EF%BC%882%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="React-ä¸‹å•æµ‹å…¥é—¨ï¼ˆ2ï¼‰"><a href="#React-ä¸‹å•æµ‹å…¥é—¨ï¼ˆ2ï¼‰" class="headerlink" title="React ä¸‹å•æµ‹å…¥é—¨ï¼ˆ2ï¼‰"></a>React ä¸‹å•æµ‹å…¥é—¨ï¼ˆ2ï¼‰</h2><p><strong>å¼•è‡ªæ–‡ç« </strong><a href="https://juejin.cn/post/7010326062554955790#heading-12">å‰ç«¯å•æµ‹å­¦ä¹ ï¼ˆ2ï¼‰â€”â€” react ç»„ä»¶å•æµ‹åˆæ­¥ - æ˜é‡‘ (juejin.cn)</a></p><h3 id="01-é’ˆå¯¹ç»„ä»¶è¿›è¡Œå•æµ‹"><a href="#01-é’ˆå¯¹ç»„ä»¶è¿›è¡Œå•æµ‹" class="headerlink" title="01 é’ˆå¯¹ç»„ä»¶è¿›è¡Œå•æµ‹"></a>01 é’ˆå¯¹ç»„ä»¶è¿›è¡Œå•æµ‹</h3><p>é¦–å…ˆåœ¨ <strong>components æ–‡ä»¶å¤¹</strong> åˆ›å»ºä¸€ä¸ªç»„ä»¶ï¼Œè¿™è¾¹ä»¥ ToDoHeader ç»„ä»¶ä¸ºä¾‹ï¼ŒåŒæ—¶åœ¨ <strong>components æ–‡ä»¶å¤¹</strong> ä¸‹åˆ›å»º**<em>test</em>** æ–‡ä»¶ä¸‹ï¼Œç”¨äºæµ‹è¯• <strong>components</strong> ä¸‹ç»„ä»¶</p><p><img src="https://s2.loli.net/2022/04/08/BnmOc5ZoFRGxrVJ.png" alt="image-20220408144511325"></p><p><strong>ToDo-header/index.jsx</strong></p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;./index.css&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ToDoHeader</span>(<span class="hljs-params">&#123; title &#125;</span>) &#123;<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;report-header&quot;</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;title&quot;</span>&gt;</span>&#123;title&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  )<br>&#125;<br></code></pre></div></td></tr></table></figure><p><strong>ToDo-header/index.css</strong></p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css">todo-<span class="hljs-selector-tag">header</span> &#123;<br>  <span class="hljs-attribute">display</span>: flex;<br>&#125;<br><span class="hljs-selector-class">.title</span> &#123;<br>  <span class="hljs-attribute">font-style</span>: normal;<br>  <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">500</span>;<br>  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;<br>  <span class="hljs-attribute">line-height</span>: <span class="hljs-number">24px</span>;<br>  <span class="hljs-attribute">color</span>: <span class="hljs-number">#1664ff</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p><strong>ToDo-header.test.js</strong></p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">import</span> &#123; render, screen &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@testing-library/react&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">ToDoHeader</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../ToDo-header&#x27;</span><br><br><span class="hljs-title function_">describe</span>(<span class="hljs-string">&#x27;æµ‹è¯•ToDoHeaderç»„ä»¶&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;æµ‹è¯•ToDoHeaderç»„ä»¶&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> title = <span class="hljs-string">&#x27;æµ‹è¯•æ ‡é¢˜&#x27;</span><br>    <span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ToDoHeader</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&#123;title&#125;</span> /&gt;</span></span>)<br>    <span class="hljs-keyword">const</span> linkElement = screen.<span class="hljs-title function_">getByText</span>(title)<br>    <span class="hljs-title function_">expect</span>(linkElement).<span class="hljs-title function_">toBeInTheDocument</span>()<br>  &#125;)<br>&#125;)<br></code></pre></div></td></tr></table></figure><p>è¿è¡Œ <code>npm test</code> ,è¿›è¡Œå•ä¾§ç»„ä»¶</p><p><strong>ç»“æœå¦‚ä¸‹ï¼š</strong></p><p><img src="https://s2.loli.net/2022/04/08/VXgeqPcuhFYmObr.png" alt="image-20220408144950214"></p><h3 id="02-VSCode-æ’ä»¶"><a href="#02-VSCode-æ’ä»¶" class="headerlink" title="02 VSCode æ’ä»¶"></a>02 VSCode æ’ä»¶</h3><p><img src="https://s2.loli.net/2022/04/08/fghjdrA2CkFcWBm.png" alt="image-20220408145102092"></p><p>å®‰è£…å®Œï¼Œæ¯æ¬¡<code>CTRL + S</code> , éƒ½ä¼šè¿›è¡Œæµ‹è¯•ï¼Œæ•ˆæœå¦‚ä¸‹</p><p><img src="https://s2.loli.net/2022/04/08/vahGoLP5y3A21ep.png" alt="image-20220408145250827"></p><h3 id="03-å¤šä¸ªæµ‹è¯•ç”¨ä¾‹"><a href="#03-å¤šä¸ªæµ‹è¯•ç”¨ä¾‹" class="headerlink" title="03 å¤šä¸ªæµ‹è¯•ç”¨ä¾‹"></a>03 å¤šä¸ªæµ‹è¯•ç”¨ä¾‹</h3><h4 id="é€šè¿‡-queryByText"><a href="#é€šè¿‡-queryByText" class="headerlink" title="é€šè¿‡ queryByText"></a>é€šè¿‡ queryByText</h4><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;æ­£ç¡®æ¸²æŸ“titleç»„ä»¶é€šè¿‡queryByTest&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> title = <span class="hljs-string">&#x27;æµ‹è¯•æ ‡é¢˜&#x27;</span><br>  <span class="hljs-keyword">const</span> &#123; queryByText &#125; = <span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ToDoHeader</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&#123;title&#125;</span> /&gt;</span></span>)<br>  <span class="hljs-keyword">const</span> linkElement = <span class="hljs-title function_">queryByText</span>(title)<br>  <span class="hljs-title function_">expect</span>(linkElement).<span class="hljs-property">not</span>.<span class="hljs-title function_">toBeNull</span>()<br>  <span class="hljs-title function_">expect</span>(linkElement).<span class="hljs-title function_">toBeInTheDocument</span>()<br>&#125;)<br></code></pre></div></td></tr></table></figure><h4 id="é€šè¿‡-getByText"><a href="#é€šè¿‡-getByText" class="headerlink" title="é€šè¿‡ getByText"></a>é€šè¿‡ getByText</h4><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;æ­£ç¡®æ¸²æŸ“titleç»„ä»¶é€šè¿‡getByText&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> title = <span class="hljs-string">&#x27;æµ‹è¯•çš„æ ‡é¢˜&#x27;</span><br>  <span class="hljs-keyword">const</span> &#123; getByText &#125; = <span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoHeader</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&#123;title&#125;</span> /&gt;</span></span>)<br>  <span class="hljs-keyword">const</span> titleElement = <span class="hljs-title function_">getByText</span>(title)<br>  <span class="hljs-title function_">expect</span>(titleElement).<span class="hljs-title function_">toBeInTheDocument</span>()<br>&#125;)<br></code></pre></div></td></tr></table></figure><h4 id="é€šè¿‡-container-çš„-query"><a href="#é€šè¿‡-container-çš„-query" class="headerlink" title="é€šè¿‡ container çš„ query"></a>é€šè¿‡ container çš„ query</h4><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;æ­£ç¡®æ¸²æŸ“titleç»„ä»¶é€šè¿‡containerçš„query&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> title = <span class="hljs-string">&#x27;æµ‹è¯•æ ‡é¢˜&#x27;</span><br>  <span class="hljs-keyword">const</span> &#123; container &#125; = <span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ToDoHeader</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&#123;title&#125;</span> /&gt;</span></span>)<br>  <span class="hljs-keyword">const</span> linkElement = container.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;span&#x27;</span>)<br>  <span class="hljs-title function_">expect</span>(linkElement).<span class="hljs-title function_">toHaveTextContent</span>(title)<br>&#125;)<br></code></pre></div></td></tr></table></figure><h4 id="é€šè¿‡-testid-æŸ¥è¯¢"><a href="#é€šè¿‡-testid-æŸ¥è¯¢" class="headerlink" title="é€šè¿‡ testid æŸ¥è¯¢"></a>é€šè¿‡ testid æŸ¥è¯¢</h4><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;æ­£ç¡®æ¸²æŸ“titleç»„ä»¶é€šè¿‡getByTestId&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> title = <span class="hljs-string">&#x27;æµ‹è¯•æ ‡é¢˜&#x27;</span><br>  <span class="hljs-keyword">const</span> &#123; getByTestId &#125; = <span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ToDoHeader</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&#123;title&#125;</span> /&gt;</span></span>)<br>  <span class="hljs-comment">// &lt;span className=&quot;title&quot; data-testid=&quot;todo-header-title&quot;&gt;</span><br>  <span class="hljs-keyword">const</span> linkElement = <span class="hljs-title function_">getByTestId</span>(<span class="hljs-string">&#x27;todo-header-title&#x27;</span>)<br>  <span class="hljs-title function_">expect</span>(linkElement).<span class="hljs-title function_">toHaveTextContent</span>(title)<br>&#125;)<br></code></pre></div></td></tr></table></figure><h4 id="å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹"><a href="#å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹" class="headerlink" title="å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹"></a>å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹</h4><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// ToDo-header.test.js</span><br><span class="hljs-keyword">import</span> &#123; render, screen &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@testing-library/react&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">ToDoHeader</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;../ToDo-header&#x27;</span><br><br><span class="hljs-title function_">describe</span>(<span class="hljs-string">&#x27;æµ‹è¯•ToDoHeaderç»„ä»¶&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;æµ‹è¯•ToDoHeaderç»„ä»¶&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> title = <span class="hljs-string">&#x27;æµ‹è¯•æ ‡é¢˜&#x27;</span><br>    <span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ToDoHeader</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&#123;title&#125;</span> /&gt;</span></span>)<br>    <span class="hljs-keyword">const</span> linkElement = screen.<span class="hljs-title function_">getByText</span>(title)<br>    <span class="hljs-title function_">expect</span>(linkElement).<span class="hljs-title function_">toBeInTheDocument</span>()<br>  &#125;)<br>  <span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;æ­£ç¡®æ¸²æŸ“titleç»„ä»¶é€šè¿‡queryByTest&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> title = <span class="hljs-string">&#x27;æµ‹è¯•æ ‡é¢˜&#x27;</span><br>    <span class="hljs-keyword">const</span> &#123; queryByText &#125; = <span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ToDoHeader</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&#123;title&#125;</span> /&gt;</span></span>)<br>    <span class="hljs-keyword">const</span> linkElement = <span class="hljs-title function_">queryByText</span>(title)<br>    <span class="hljs-title function_">expect</span>(linkElement).<span class="hljs-property">not</span>.<span class="hljs-title function_">toBeNull</span>()<br>    <span class="hljs-title function_">expect</span>(linkElement).<span class="hljs-title function_">toBeInTheDocument</span>()<br>  &#125;)<br>  <span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;æ­£ç¡®æ¸²æŸ“titleç»„ä»¶é€šè¿‡containerçš„query&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> title = <span class="hljs-string">&#x27;æµ‹è¯•æ ‡é¢˜&#x27;</span><br>    <span class="hljs-keyword">const</span> &#123; container &#125; = <span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ToDoHeader</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&#123;title&#125;</span> /&gt;</span></span>)<br>    <span class="hljs-keyword">const</span> linkElement = container.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;span&#x27;</span>)<br>    <span class="hljs-title function_">expect</span>(linkElement).<span class="hljs-title function_">toHaveTextContent</span>(title)<br>  &#125;)<br>  <span class="hljs-title function_">it</span>(<span class="hljs-string">&#x27;æ­£ç¡®æ¸²æŸ“titleç»„ä»¶é€šè¿‡getByTestId&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> title = <span class="hljs-string">&#x27;æµ‹è¯•æ ‡é¢˜&#x27;</span><br>    <span class="hljs-keyword">const</span> &#123; getByTestId &#125; = <span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ToDoHeader</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&#123;title&#125;</span> /&gt;</span></span>)<br>    <span class="hljs-comment">// &lt;span className=&quot;title&quot; data-testid=&quot;todo-header-title&quot;&gt;</span><br>    <span class="hljs-keyword">const</span> linkElement = <span class="hljs-title function_">getByTestId</span>(<span class="hljs-string">&#x27;todo-header-title&#x27;</span>)<br>    <span class="hljs-title function_">expect</span>(linkElement).<span class="hljs-title function_">toHaveTextContent</span>(title)<br>  &#125;)<br>&#125;)<br></code></pre></div></td></tr></table></figure><p><strong>æµ‹è¯•ç»“æœï¼š</strong></p><p><img src="https://s2.loli.net/2022/04/08/mV4wbfhtnsHOzSq.png" alt="image-20220408145745565"></p>]]></content>
    
    
    <categories>
      
      <category>Jest</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Jest react</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>React ä¸‹å•æµ‹å…¥é—¨ï¼ˆ1ï¼‰</title>
    <link href="/2022/04/20/React%20%E4%B8%8B%E5%8D%95%E6%B5%8B%E5%85%A5%E9%97%A8%EF%BC%881%EF%BC%89/"/>
    <url>/2022/04/20/React%20%E4%B8%8B%E5%8D%95%E6%B5%8B%E5%85%A5%E9%97%A8%EF%BC%881%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h2 id="React-ä¸‹å•æµ‹å…¥é—¨ï¼ˆ1ï¼‰"><a href="#React-ä¸‹å•æµ‹å…¥é—¨ï¼ˆ1ï¼‰" class="headerlink" title="React ä¸‹å•æµ‹å…¥é—¨ï¼ˆ1ï¼‰"></a>React ä¸‹å•æµ‹å…¥é—¨ï¼ˆ1ï¼‰</h2><p><strong>å¼•è‡ªæ–‡ç« </strong><a href="https://juejin.cn/post/6985840134046351367">å‰ç«¯å•æµ‹å­¦ä¹ ï¼ˆ1ï¼‰â€”â€” å•æµ‹å…¥é—¨ä¹‹ react å•æµ‹é¡¹ç›®åˆæ­¥ - æ˜é‡‘ (juejin.cn)</a></p><p><img src="https://s2.loli.net/2022/04/08/R1BK2cANbZVmiQh.png" alt="image-20220408142134507"></p><h3 id="01-ä»€ä¹ˆå•æµ‹ï¼Œä¸ºå•¥è¦ç”¨å•æµ‹ï¼Ÿ"><a href="#01-ä»€ä¹ˆå•æµ‹ï¼Œä¸ºå•¥è¦ç”¨å•æµ‹ï¼Ÿ" class="headerlink" title="01 ä»€ä¹ˆå•æµ‹ï¼Œä¸ºå•¥è¦ç”¨å•æµ‹ï¼Ÿ"></a>01 ä»€ä¹ˆå•æµ‹ï¼Œä¸ºå•¥è¦ç”¨å•æµ‹ï¼Ÿ</h3><blockquote><p>å•å…ƒæµ‹è¯•æ—¶ç”¨æ¥å¯¹ä¸€ä¸ªæ¨¡å—ã€å‡½æ•°æˆ–è€…åˆ—è¿›è¡Œæ­£ç¡®æ€§æ£€éªŒçš„æµ‹è¯•å·¥ä½œï¼Œæ‰€è°“çš„æ­£ç¡®æ€§ï¼Œå°±æ˜¯ä¿è¯åŒä¸€å•å…ƒï¼Œåœ¨ç»™å®šè¾“å…¥ä¸‹ï¼Œæ€»èƒ½å¾—åˆ°é¢„æœŸçš„è¾“å‡º</p></blockquote><p><strong>å•æµ‹çš„å¥½å¤„ï¼š</strong></p><ul><li>ä¿è¯ä»£ç æ­£å¸¸ï¼šè®¾è®¡åˆé€‚çš„æµ‹è¯•ç”¨ä¾‹æ¥æµ‹è¯•ä»£ç ï¼Œå¯ä»¥ä¿è¯ä»£ç çš„æ­£ç¡®æ€§ï¼Œæé«˜å¯¹ä»£ç çš„ä¿¡å¿ƒ</li><li>æå‡ä»£ç è´¨é‡ï¼šè€¦åˆåº¦é«˜ã€åŠŸèƒ½ä¸æ¸…æ™°çš„ä»£ç åœ¨åšå•æµ‹çš„æ—¶å€™æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œè€Œå•æµ‹çš„å­˜åœ¨å¯ä»¥æ¨åŠ¨å¯¹ä»£ç çš„åˆç†é‡æ„ï¼Œå¯¹æå‡ä»£ç è´¨é‡æœ‰å¸®åŠ©</li><li>è¿›è¡Œå›å½’æµ‹è¯•ï¼šå½“éœ€è¦å¯¹ç³»ç»Ÿè¿›è¡Œé‡æ„çš„æ—¶å€™ï¼Œå•æµ‹å¯ä»¥ä¸ºé‡æ„çš„è¿‡ç¨‹ä¿é©¾æŠ¤èˆªï¼ŒéªŒè¯é‡æ„åç³»ç»ŸåŠŸèƒ½çš„æ­£ç¡®æ€§ä»¥åŠä¿è¯ç³»ç»Ÿçš„ç¨³å®šæ€§</li><li>å…¨é¢æµ‹è¯•åœºæ™¯ï¼šå¯ä»¥é€šè¿‡æ„å»ºæ•°æ®æ¥è§¦å‘ä¸åŒçš„æµ‹è¯•åœºæ™¯ï¼Œå¯¹äºä¸€äº›äººå·¥æµ‹è¯•æ—¶ä¸ä¾¿è§¦å‘çš„åœºæ™¯ï¼Œå•æµ‹å¯ä»¥æ„é€ å‚æ•°è¿›è¡Œè§¦å‘ï¼Œæ”¯æŒçš„åœºæ™¯æ›´åŠ å…¨é¢</li><li>å¸®åŠ©ç†è§£éœ€æ±‚ã€ç†Ÿæ‚‰ä»£ç ï¼šå†™å•æµ‹çš„è¿‡ç¨‹ä¸­éœ€è¦æ¢³ç†éœ€æ±‚ï¼Œä»è€Œè¿›ä¸€æ­¥ç†è§£éœ€æ±‚ï¼ŒåŒæ—¶å¥½çš„å•æµ‹ä¹Ÿæ˜¯ä¸é”™çš„ä»£ç æ–‡æ¡£ï¼Œæœ‰åŠ©äºå›¢é˜Ÿæ–°æˆå‘˜é€šè¿‡å•æµ‹äº†è§£ä»£ç çš„åŠŸèƒ½</li></ul><h3 id="02-ä½¿ç”¨-CRA-åˆ›å»ºé¡¹ç›®"><a href="#02-ä½¿ç”¨-CRA-åˆ›å»ºé¡¹ç›®" class="headerlink" title="02 ä½¿ç”¨ CRA åˆ›å»ºé¡¹ç›®"></a>02 ä½¿ç”¨ CRA åˆ›å»ºé¡¹ç›®</h3><blockquote><p>CRA åˆ›å»ºé¡¹ç›®åï¼Œæ˜¯é»˜è®¤å®‰è£…å•æµ‹ç›¸å…³çš„ä¾èµ–</p></blockquote><p><img src="https://s2.loli.net/2022/04/08/o2cXEQnjLvtCTmb.png" alt="image-20220408142653232"></p><p><strong>@testing-library/jest-dom</strong> å†™å•æµ‹çš„æ—¶å€™æˆ‘ä»¬ä¼šæœ‰éœ€è¦ç”¨åˆ°æ£€æŸ¥å…ƒç´ çš„å±æ€§ã€æ–‡æœ¬å†…å®¹ï¼Œæ ·å¼ç±»åç­‰ï¼Œè¿™ä¸ªåº“å°±æ˜¯æ‹“å±•äº† jest çš„èƒ½åŠ›ï¼Œæä¾› jest machers æ¥å¢å¼ºèƒ½åŠ›ï¼Œå°†ä½¿æµ‹è¯•æ›´å…·å£°æ˜æ€§ã€é˜…è¯»å’Œç»´æŠ¤æ›´æ¸…æ™°ã€‚</p><p><strong>@testing-library/react</strong> testing-libray é‡Œé¢å…³äº react çš„éƒ¨åˆ†ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯é’ˆå¯¹ react æ¥åšå•æµ‹ï¼Œæ‰€ä»¥è¦ç”¨è¿™ä¸ªåº“</p><p><strong>@testing-library/user-event</strong> æä¾›ä¸€äº›æ¨¡æ‹Ÿç”¨æˆ·ä¸æµè§ˆå™¨äº¤äº’çš„äº‹ä»¶ï¼Œæ–¹ä¾¿æˆ‘ä»¬æ–­è¨€æµ‹è¯•æ“ä½œåé¢„æœŸçš„ä¸€äº›æ•ˆæœ</p><p><strong>@types/jest</strong> jest çš„ä¸€äº›ç±»å‹å®šä¹‰ï¼Œå› ä¸ºè¿™é‡Œç”¨åˆ°äº† tsï¼Œæ‰€ä»¥åŠ ä¸Šè¿™ä¸ªåŒ…å¢åŠ ä»£ç æç¤º</p><h3 id="03-ç®€å•ä¸€ä¸ªå•æµ‹"><a href="#03-ç®€å•ä¸€ä¸ªå•æµ‹" class="headerlink" title="03 ç®€å•ä¸€ä¸ªå•æµ‹"></a>03 ç®€å•ä¸€ä¸ªå•æµ‹</h3><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// App.test.js</span><br><span class="hljs-keyword">import</span> &#123; render, screen &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@testing-library/react&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App&#x27;</span><br><br><span class="hljs-title function_">test</span>(<span class="hljs-string">&#x27;renders learn react link&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>)<br>  <span class="hljs-keyword">const</span> linkElement = screen.<span class="hljs-title function_">getByText</span>(<span class="hljs-regexp">/æˆ‘æ˜¯ä¸€ä¸ªæ ‡é¢˜/i</span>)<br>  <span class="hljs-title function_">expect</span>(linkElement).<span class="hljs-title function_">toBeInTheDocument</span>()<br>&#125;)<br></code></pre></div></td></tr></table></figure><p>è¿è¡ŒæŒ‡ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">npm <span class="hljs-built_in">test</span><br></code></pre></div></td></tr></table></figure><p><img src="https://s2.loli.net/2022/04/08/NRmHbP1QMxSr9XD.png" alt="image-20220408143445389"></p><p>æµ‹è¯•ç»“æœå¦‚å›¾æ‰€ä¸Šï¼Œå…±ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼ŒæˆåŠŸï¼š0 | å¤±è´¥ï¼š0</p>]]></content>
    
    
    <categories>
      
      <category>Jest</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Jest react</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Git rebase -i</title>
    <link href="/2022/04/20/Git%20rebase%20%20-i/"/>
    <url>/2022/04/20/Git%20rebase%20%20-i/</url>
    
    <content type="html"><![CDATA[<h2 id="Git-rebase-i"><a href="#Git-rebase-i" class="headerlink" title="Git rebase -i"></a>Git rebase -i</h2><p>rebase çš„ä½œç”¨ç®€è¦æ¦‚æ‹¬ä¸ºï¼šå¯ä»¥å¯¹æŸä¸€æ®µçº¿æ€§æäº¤å†å²è¿›è¡Œç¼–è¾‘ã€åˆ é™¤ã€å¤åˆ¶ã€ç²˜è´´ï¼›å› æ­¤ï¼Œåˆç†ä½¿ç”¨ rebase å‘½ä»¤å¯ä»¥ä½¿æˆ‘ä»¬çš„æäº¤å†å²å¹²å‡€ã€ç®€æ´ï¼</p><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><p>å½“ä½ æƒ³æŠŠå¤šä¸ª <code>commit</code> åˆå¹¶æˆä¸€ä¸ª <code>commit</code> æ—¶</p><p><img src="https://s2.loli.net/2022/04/07/crzKwbLTm3ECOk7.png" alt="image-20220407182433554"></p><p><strong>ä½¿ç”¨å‰ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">commit 77e3eca369c30b78daae093b34fcfcd041811f45 (HEAD, master)<br>Author: DuoRouSai &lt;1158461087@qq.com&gt;<br>Date:   Thu Apr 7 15:57:02 2022 +0800<br><br>    ç¬¬å››æ¬¡æäº¤<br><br>commit 1d911bed06c6a1ef26c824375d0ce8c95ee98f00<br>Author: DuoRouSai &lt;1158461087@qq.com&gt;<br>Date:   Thu Apr 7 14:49:47 2022 +0800<br><br>    ç¬¬ä¸‰æ¬¡æäº¤<br><br>commit e7ace4479370720c7efeafa0a3d0dda55f61e1a5<br>Author: DuoRouSai &lt;1158461087@qq.com&gt;<br>Date:   Thu Apr 7 14:49:37 2022 +0800<br><br>    ç¬¬äºŒæ¬¡æäº¤<br><br>commit 6e8cc7a5d0f938e1bd8fcb284728f2902188e543<br>Author: DuoRouSai &lt;1158461087@qq.com&gt;<br>Date:   Thu Apr 7 14:48:46 2022 +0800<br><br>    ç¬¬ä¸€æ¬¡æäº¤<br></code></pre></div></td></tr></table></figure><p><strong>ä½¿ç”¨åï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">commit dcdf6abba41366a042acf2620ab010d947ac53cc (HEAD -&gt; master)<br>Author: DuoRouSai &lt;1158461087@qq.com&gt;<br>Date:   Thu Apr 7 14:49:37 2022 +0800<br><br>     ç¬¬ 2ã€3ã€4æ¬¡æäº¤<br><br>commit 6e8cc7a5d0f938e1bd8fcb284728f2902188e543<br>Author: DuoRouSai &lt;1158461087@qq.com&gt;<br>Date:   Thu Apr 7 14:48:46 2022 +0800<br><br>    ç¬¬ä¸€æ¬¡æäº¤<br><br></code></pre></div></td></tr></table></figure><h3 id="01-git-rebase-i"><a href="#01-git-rebase-i" class="headerlink" title="01 git rebase -i"></a>01 git rebase -i</h3><blockquote><p>å…¶ä¸­ -i =&gt; â€“interactive</p><p>(startpoint, endpoint] å‰å¼€åé—­ï¼Œå¯ä»¥çœç•¥ endpoint ï¼Œé»˜è®¤æŒ‡å‘å½“å‰çš„ HEAD</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">git rebase -i  [startpoint]  [endpoint]<br></code></pre></div></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">git rebase -i commit_id<br>git rebase -i HEAD~3<br></code></pre></div></td></tr></table></figure><p>è¾“å…¥å®Œå‘½ä»¤åï¼Œä¼šè¿›å…¥äº¤äº’æ¨¡å¼ï¼ˆä¸‹è¾¹ç¼–è¾‘å™¨ï¼‰</p><h3 id="02-è¿›å…¥ç¼–è¾‘å™¨"><a href="#02-è¿›å…¥ç¼–è¾‘å™¨" class="headerlink" title="02 è¿›å…¥ç¼–è¾‘å™¨"></a>02 è¿›å…¥ç¼–è¾‘å™¨</h3><p><img src="https://s2.loli.net/2022/04/07/Mq7SCZ2GYHxzfpU.png" alt="image-20220407182959377"></p><p><strong>é»„è‰²åŒºåŸŸ</strong>ï¼Œæ˜¯æˆ‘ä»¬æœ¬æ¬¡éœ€è¦ commit çš„æ‰€æœ‰æäº¤</p><blockquote><p>pick e7ace44 ç¬¬äºŒæ¬¡æäº¤<br>s 1d911be ç¬¬ä¸‰æ¬¡æäº¤<br>s 77e3eca ç¬¬å››æ¬¡æäº¤</p></blockquote><p><strong>è“è‰²åŒºåŸŸ</strong>ï¼Œæ˜¯æ¯æ¡ commit å‰çš„å‘½ä»¤çš„ä»£ç è¯´æ˜</p><blockquote><p>pickï¼šä¿ç•™è¯¥ commitï¼ˆç¼©å†™:pï¼‰</p><p>rewordï¼šä¿ç•™è¯¥ commitï¼Œä½†æˆ‘éœ€è¦ä¿®æ”¹è¯¥ commit çš„æ³¨é‡Šï¼ˆç¼©å†™:rï¼‰</p><p>editï¼šä¿ç•™è¯¥ commit, ä½†æˆ‘è¦åœä¸‹æ¥ä¿®æ”¹è¯¥æäº¤(ä¸ä»…ä»…ä¿®æ”¹æ³¨é‡Š)ï¼ˆç¼©å†™:eï¼‰</p><p>squashï¼šå°†è¯¥ commit å’Œå‰ä¸€ä¸ª commit åˆå¹¶ï¼ˆç¼©å†™:sï¼‰</p><p>fixupï¼šå°†è¯¥ commit å’Œå‰ä¸€ä¸ª commit åˆå¹¶ï¼Œä½†æˆ‘ä¸è¦ä¿ç•™è¯¥æäº¤çš„æ³¨é‡Šä¿¡æ¯ï¼ˆç¼©å†™:fï¼‰</p><p>execï¼šæ‰§è¡Œ shell å‘½ä»¤ï¼ˆç¼©å†™:xï¼‰</p><p>dropï¼šæˆ‘è¦ä¸¢å¼ƒè¯¥ commitï¼ˆç¼©å†™:dï¼‰</p></blockquote><p>æŒ‰<code>:wq</code> ä¿å­˜é€€å‡ºåï¼Œè¿›å…¥å¤‡æ³¨ç¼–è¾‘</p><h3 id="03-å¤‡æ³¨ç¼–è¾‘"><a href="#03-å¤‡æ³¨ç¼–è¾‘" class="headerlink" title="03 å¤‡æ³¨ç¼–è¾‘"></a>03 å¤‡æ³¨ç¼–è¾‘</h3><p><img src="https://s2.loli.net/2022/04/07/QxqmyleCWUOSZ2D.png" alt="image-20220407183350736"></p><p><strong>ä¿®æ”¹å¤‡æ³¨</strong>ï¼Œå¯ä»¥ä¿®æ”¹ä½ æƒ³è¦å¤‡æ³¨å</p><p><img src="https://s2.loli.net/2022/04/07/DCtOoUlTjg98WRN.png" alt="image-20220407183533240"></p><p>æŒ‰<code>:wq</code>æäº¤</p><h3 id="04-Git-log"><a href="#04-Git-log" class="headerlink" title="04 Git log"></a>04 Git log</h3><p><img src="https://s2.loli.net/2022/04/07/NfyVOUXWs3dtL9m.png" alt="image-20220407183646592"></p><p><strong>å¯ä»¥å¾ˆæ¸…æ™°çœ‹åˆ°ï¼Œ2ã€3ã€4 æäº¤åˆå¹¶æˆä¸€æ¡æäº¤äº†</strong></p><h3 id="05-æ‰©å±•"><a href="#05-æ‰©å±•" class="headerlink" title="05 æ‰©å±•"></a>05 æ‰©å±•</h3><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">git pull -rebase [repo]<br></code></pre></div></td></tr></table></figure><p>å½“ä½ å’Œ fork è¿‡æ¥çš„åŸä»“åº“äº§ç”Ÿå†²çªæ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‘½ä»¤ï¼Œ<code>pull</code> æ‹‰å–è¿‡æ¥çš„æ—¶å€™ï¼Œè‡ªåŠ¨å¸®ä½  <code>rebase</code>,</p><p>å¦‚æœæ²¡æœ‰å†²çªåˆ™åˆå¹¶æˆåŠŸï¼Œå¦‚æœäº§ç”Ÿå†²çªåï¼Œåˆ™åœ¨<code>IDE</code>æ¶ˆé™¤å†²çªã€‚</p><p>å¦å¤–ï¼Œ <code>rebase</code> çš„åº•å±‚ï¼Œå…ˆ <code>git reset</code> åœ¨è¿›è¡Œ <code>git merge</code></p>]]></content>
    
    
    <categories>
      
      <category>Git</category>
      
    </categories>
    
    
    <tags>
      
      <tag>rebase</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WebSocket æµ…å®ç°ä¸€ä¸ªç®€æ˜“èŠå¤©å®¤</title>
    <link href="/2022/04/20/WebSocket%20%20%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E8%81%8A%E5%A4%A9%E5%AE%A4/"/>
    <url>/2022/04/20/WebSocket%20%20%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E8%81%8A%E5%A4%A9%E5%AE%A4/</url>
    
    <content type="html"><![CDATA[<h2 id="WebSocket-æµ…å®ç°ä¸€ä¸ªç®€æ˜“èŠå¤©å®¤"><a href="#WebSocket-æµ…å®ç°ä¸€ä¸ªç®€æ˜“èŠå¤©å®¤" class="headerlink" title="WebSocket æµ…å®ç°ä¸€ä¸ªç®€æ˜“èŠå¤©å®¤"></a>WebSocket æµ…å®ç°ä¸€ä¸ªç®€æ˜“èŠå¤©å®¤</h2><h3 id="01-WebSocket-ç‰¹ç‚¹"><a href="#01-WebSocket-ç‰¹ç‚¹" class="headerlink" title="01 WebSocket ç‰¹ç‚¹"></a>01 WebSocket ç‰¹ç‚¹</h3><p><strong>WebSocket åè®®</strong>ï¼Œæ˜¯å…¨åŒå·¥åè®®ã€‚å®ƒçš„ç‰¹ç‚¹ï¼š</p><ul><li><p>æ§åˆ¶å¼€é”€</p></li><li><p>å®æ—¶é€šè®¯</p></li><li><p>ws(wss)://</p></li><li><p>æ”¯æŒæ–‡æœ¬ï¼ŒäºŒè¿›åˆ¶ä¼ è¾“</p></li><li><p>åŸºäº TCP ä¹‹ä¸‹ï¼ŒæœåŠ¡ç«¯å®ç°æ¯”è¾ƒç®€å•</p></li></ul><h3 id="02-å®ç°æƒ³æ³•"><a href="#02-å®ç°æƒ³æ³•" class="headerlink" title="02 å®ç°æƒ³æ³•"></a>02 å®ç°æƒ³æ³•</h3><p><img src="https://s2.loli.net/2022/04/02/uaReB9NHbjXvQMU.png" alt="image-20220402175739368"></p><h3 id="03-å®¢æˆ·ç«¯çš„å…³é”®å®ç°ç»†èŠ‚"><a href="#03-å®¢æˆ·ç«¯çš„å…³é”®å®ç°ç»†èŠ‚" class="headerlink" title="03 å®¢æˆ·ç«¯çš„å…³é”®å®ç°ç»†èŠ‚"></a>03 å®¢æˆ·ç«¯çš„å…³é”®å®ç°ç»†èŠ‚</h3><blockquote><p>å‰ç«¯æµè§ˆå™¨ï¼Œæœ¬èº«è‡ªå¸¦æœ‰ <code>WebSocket</code> å¯¹è±¡ ï¼Œæ‰€ä»¥é€šè¿‡ <code>new</code> çš„å½¢å¼ï¼Œå°±å¯ä»¥å¾—åˆ° <code>ws</code> å®ä¾‹</p></blockquote><ul><li>æ¯”å¦‚ï¼Œç”¨æˆ·ç¬¬ä¸€æ¬¡è¿›å…¥èŠå¤©å®¤</li></ul><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-variable language_">this</span>.<span class="hljs-property">ws</span>.<span class="hljs-property">onopen</span> = <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;onopen&#x27;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">ws</span>.<span class="hljs-property">readyState</span>)<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">roomOpen</span> = <span class="hljs-literal">true</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ws</span>.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123;<br>        <span class="hljs-attr">userId</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">userName</span>,<br>        <span class="hljs-attr">userName</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">nickname</span>,<br>        <span class="hljs-attr">roomId</span>: item.<span class="hljs-property">roomId</span>,<br>        <span class="hljs-attr">roomName</span>: item.<span class="hljs-property">name</span>,<br>        <span class="hljs-attr">event</span>: <span class="hljs-string">&#x27;login&#x27;</span>,<br>    &#125;))<br></code></pre></div></td></tr></table></figure><ul><li>æ¯”å¦‚ï¼Œç”¨æˆ·ç•Œé¢æ¥æ”¶å…¶ä»–ç”¨æˆ·çš„å‘é€çš„æ¶ˆæ¯</li></ul><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-variable language_">this</span>.<span class="hljs-property">ws</span>.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(message.<span class="hljs-property">data</span>)<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">onlineNum</span> = data.<span class="hljs-property">num</span><br>  <span class="hljs-keyword">if</span> (data.<span class="hljs-property">event</span> === <span class="hljs-string">&#x27;login&#x27;</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">msgList</span>.<span class="hljs-title function_">push</span>(&#123;<br>      <span class="hljs-attr">content</span>: <span class="hljs-string">`æ¬¢è¿<span class="hljs-subst">$&#123;data.userName&#125;</span>è¿›å…¥<span class="hljs-subst">$&#123;data.roomName&#125;</span>æˆ¿é—´ï½`</span>,<br>    &#125;)<br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data.<span class="hljs-property">event</span> === <span class="hljs-string">&#x27;logout&#x27;</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;logout&#x27;</span>, data)<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">msgList</span>.<span class="hljs-title function_">push</span>(&#123;<br>      <span class="hljs-attr">content</span>: <span class="hljs-string">`<span class="hljs-subst">$&#123;data.userName&#125;</span>ç¦»å¼€æˆ¿é—´`</span>,<br>    &#125;)<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">const</span> self = <span class="hljs-variable language_">this</span>.<span class="hljs-property">userId</span> === data.<span class="hljs-property">userId</span><br>    <span class="hljs-keyword">if</span> (self) <span class="hljs-keyword">return</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">msgList</span>.<span class="hljs-title function_">push</span>(&#123;<br>      <span class="hljs-attr">name</span>: data.<span class="hljs-property">userName</span>,<br>      <span class="hljs-attr">self</span>: <span class="hljs-literal">false</span>,<br>      <span class="hljs-attr">content</span>: data.<span class="hljs-property">content</span>,<br>    &#125;)<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><ul><li>å½“å‰ç”¨æˆ·é€€å‡ºç•Œé¢</li></ul><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-variable language_">this</span>.<span class="hljs-property">ws</span>.<span class="hljs-property">onclose</span> = <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeAllTimeJob</span>()<br>  <span class="hljs-title class_">Toast</span>(<span class="hljs-string">&#x27;æ‚¨å·²ç¦»å¼€æˆ¿é—´&#x27;</span>)<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">roomOpen</span> = <span class="hljs-literal">false</span><br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">msgList</span> = []<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">onlineNum</span> = <span class="hljs-number">0</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="04-æœåŠ¡ç«¯çš„å®ç°"><a href="#04-æœåŠ¡ç«¯çš„å®ç°" class="headerlink" title="04 æœåŠ¡ç«¯çš„å®ç°"></a>04 æœåŠ¡ç«¯çš„å®ç°</h3><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Websocket</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;ws&#x27;</span>)<br><br><span class="hljs-keyword">const</span> wss = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Websocket</span>.<span class="hljs-title class_">Server</span>(&#123; <span class="hljs-attr">port</span>: <span class="hljs-number">9001</span> &#125;)<br><br><span class="hljs-comment">// å­˜æ”¾æ‰€æœ‰çš„æˆ¿é—´ä¿¡æ¯</span><br><span class="hljs-keyword">const</span> group = &#123;&#125;<br><br><span class="hljs-comment">// å¿ƒè·³æ£€æµ‹æœ‰æ•ˆæ—¶é—´</span><br><span class="hljs-keyword">const</span> heartBeatTime = <span class="hljs-number">50000</span><br><br>wss.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;connection&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">ws</span>) &#123;<br>  ws.<span class="hljs-property">isAlive</span> = <span class="hljs-literal">true</span><br>  ws.<span class="hljs-property">heartBeatTimeIntervalObj</span> = -<span class="hljs-number">1</span><br>  ws.<span class="hljs-property">heartBeatTimeoutObj</span> = -<span class="hljs-number">1</span><br><br>  <span class="hljs-comment">// ç›‘å¬å¿ƒè·³å®šæ—¶å™¨ï¼Œå¦‚æœé•¿æ—¶é—´æ²¡æœ‰å¿ƒè·³ï¼Œè‡ªåŠ¨æ–­å¼€è¿æ¥</span><br>  <span class="hljs-keyword">const</span> <span class="hljs-title function_">setHeartBeatTimeout</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">if</span> (ws.<span class="hljs-property">heartBeatTimeoutObj</span> !== -<span class="hljs-number">1</span>) &#123;<br>      <span class="hljs-built_in">clearTimeout</span>(ws.<span class="hljs-property">heartBeatTimeoutObj</span>)<br>      ws.<span class="hljs-property">heartBeatTimeoutObj</span> = -<span class="hljs-number">1</span><br>    &#125;<br>    ws.<span class="hljs-property">heartBeatTimeoutObj</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>      ws.<span class="hljs-title function_">close</span>()<br>      ws.<span class="hljs-property">isAlive</span> = <span class="hljs-literal">false</span><br>    &#125;, heartBeatTime)<br>  &#125;<br>  <span class="hljs-comment">// é‡ç½®å¿ƒè·³å®šæ—¶å™¨</span><br>  <span class="hljs-title function_">setHeartBeatTimeout</span>()<br><br>  ws.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;message&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">message</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;server receive message: &#x27;</span>, message.<span class="hljs-title function_">toString</span>())<br>    <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(message.<span class="hljs-title function_">toString</span>())<br>    <span class="hljs-comment">// é‡ç½®å¿ƒè·³å®šæ—¶å™¨</span><br>    <span class="hljs-title function_">setHeartBeatTimeout</span>()<br>    <span class="hljs-comment">// ç”¨æˆ·åˆæ¬¡è¿›å…¥èŠå¤©å®¤</span><br>    <span class="hljs-keyword">if</span> (data.<span class="hljs-property">event</span> === <span class="hljs-string">&#x27;login&#x27;</span>) &#123;<br>      ws.<span class="hljs-property">enterInfo</span> = data<br>    &#125;<br><br>    <span class="hljs-comment">// æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘æ¥çš„å¿ƒè·³æ¶ˆæ¯ï¼Œåˆ™é‡ç½®å¿ƒè·³å®šæ—¶å™¨</span><br>    <span class="hljs-keyword">if</span> (data.<span class="hljs-property">event</span> === <span class="hljs-string">&#x27;heartBeat&#x27;</span> &amp;&amp; data.<span class="hljs-property">content</span> === <span class="hljs-string">&#x27;ping&#x27;</span>) &#123;<br>      ws.<span class="hljs-property">isAlive</span> = <span class="hljs-literal">true</span><br><br>      <span class="hljs-keyword">if</span> (ws.<span class="hljs-property">heartBeatTimeoutObj</span> === -<span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-built_in">clearTimeout</span>(ws.<span class="hljs-property">heartBeatTimeoutObj</span>)<br>        ws.<span class="hljs-property">heartBeatTimeoutObj</span> = -<span class="hljs-number">1</span><br>      &#125;<br>      <span class="hljs-comment">// é‡ç½®å¿ƒè·³å®šæ—¶å™¨</span><br>      <span class="hljs-title function_">setHeartBeatTimeout</span>()<br><br>      ws.<span class="hljs-title function_">send</span>(<br>        <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123;<br>          <span class="hljs-attr">event</span>: <span class="hljs-string">&#x27;heartBeat&#x27;</span>,<br>          <span class="hljs-attr">content</span>: <span class="hljs-string">&#x27;pong&#x27;</span>,<br>        &#125;)<br>      )<br>      <span class="hljs-keyword">return</span><br>    &#125;<br><br>    <span class="hljs-comment">// è®¡ç®—èŠå¤©å®¤äººæ•°</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> ws.<span class="hljs-property">roomId</span> === <span class="hljs-string">&#x27;undefined&#x27;</span> &amp;&amp; data.<span class="hljs-property">roomId</span>) &#123;<br>      ws.<span class="hljs-property">roomId</span> = data.<span class="hljs-property">roomId</span><br>      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> group[ws.<span class="hljs-property">roomId</span>] === <span class="hljs-string">&#x27;undefined&#x27;</span>) &#123;<br>        group[ws.<span class="hljs-property">roomId</span>] = <span class="hljs-number">1</span><br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        group[ws.<span class="hljs-property">roomId</span>]++<br>      &#125;<br>    &#125;<br><br>    data.<span class="hljs-property">num</span> = group[ws.<span class="hljs-property">roomId</span>]<br><br>    <span class="hljs-comment">// åˆ¤æ–­å½“å‰æ”¶åˆ°æ¶ˆæ¯ï¼Œæ˜¯å¦ä¸ºç”¨æˆ·æ‰€åœ¨çš„èŠå¤©å®¤</span><br>    wss.<span class="hljs-property">clients</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">client</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span> (client.<span class="hljs-property">readyState</span> === <span class="hljs-title class_">Websocket</span>.<span class="hljs-property">OPEN</span> &amp;&amp; client.<span class="hljs-property">roomId</span> === ws.<span class="hljs-property">roomId</span>) &#123;<br>        client.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data))<br>      &#125;<br>    &#125;)<br>  &#125;)<br><br>  <span class="hljs-comment">// ç”¨æˆ·ç¦»å¼€æˆ¿é—´</span><br>  ws.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;close&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">message</span>) &#123;<br>    group[ws.<span class="hljs-property">roomId</span>]--<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;server close: &#x27;</span>, message)<br><br>    <span class="hljs-comment">// åˆ¤æ–­ç”¨æˆ·ç¦»å¼€çš„å“ªä¸ªèŠå¤©å®¤ï¼Œå‘é€é€€å‡ºæˆ¿é—´çš„æ¶ˆæ¯</span><br>    wss.<span class="hljs-property">clients</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span> <span class="hljs-title function_">each</span>(<span class="hljs-params">client</span>) &#123;<br>      <span class="hljs-keyword">if</span> (<br>        client !== ws &amp;&amp;<br>        client.<span class="hljs-property">readyState</span> === <span class="hljs-title class_">Websocket</span>.<span class="hljs-property">OPEN</span> &amp;&amp;<br>        client.<span class="hljs-property">roomId</span> === ws.<span class="hljs-property">roomId</span><br>      ) &#123;<br>        client.<span class="hljs-title function_">send</span>(<br>          <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123;<br>            ...ws.<span class="hljs-property">enterInfo</span>,<br>            <span class="hljs-attr">event</span>: <span class="hljs-string">&#x27;logout&#x27;</span>,<br>            <span class="hljs-attr">num</span>: group[ws.<span class="hljs-property">roomId</span>],<br>          &#125;)<br>        )<br>      &#125;<br>    &#125;)<br>  &#125;)<br>&#125;)<br></code></pre></div></td></tr></table></figure><h3 id="04-å¿ƒè·³æœºåˆ¶"><a href="#04-å¿ƒè·³æœºåˆ¶" class="headerlink" title="04 å¿ƒè·³æœºåˆ¶"></a>04 å¿ƒè·³æœºåˆ¶</h3><blockquote><p>å¼•å…¥å¿ƒè·³æœºåˆ¶ï¼Œæ˜¯å› ä¸ºäºåœ¨é•¿è¿æ¥çš„åœºæ™¯ä¸‹ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å¹¶ä¸æ˜¯ä¸€ç›´å¤„äºé€šä¿¡çŠ¶æ€ï¼Œå¦‚æœåŒæ–¹é•¿æœŸæ²¡æœ‰æ²Ÿé€šåˆ™åŒæ–¹éƒ½ä¸æ¸…æ¥šå¯¹æ–¹ç›®å‰çš„çŠ¶æ€ï¼Œæ‰€ä»¥éœ€è¦å‘é€ä¸€æ®µå¾ˆå°çš„æŠ¥æ–‡å‘Šè¯‰å¯¹æ–¹â€œæˆ‘è¿˜æ´»ç€â€ã€‚</p></blockquote><p><img src="https://s2.loli.net/2022/04/02/yvG8AElrSpwxjD3.png" alt="image-20220402181042899"></p><p><strong>å…¶ä»–ç›®çš„</strong></p><p>æœåŠ¡ç«¯æ£€æµ‹åˆ°æŸä¸ªå®¢æˆ·ç«¯è¿Ÿè¿Ÿæ²¡æœ‰å¿ƒè·³è¿‡æ¥å¯ä»¥ä¸»åŠ¨å…³é—­é€šé“ï¼Œè®©å®ƒä¸‹çº¿ï¼›<br>å®¢æˆ·ç«¯æ£€æµ‹åˆ°æŸä¸ªæœåŠ¡ç«¯è¿Ÿè¿Ÿæ²¡æœ‰å“åº”å¿ƒè·³ä¹Ÿèƒ½é‡è¿è·å–ä¸€ä¸ªæ–°çš„è¿æ¥ã€‚</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// ç›‘å¬å¿ƒè·³å®šæ—¶å™¨ï¼Œå¦‚æœé•¿æ—¶é—´æ²¡æœ‰å¿ƒè·³ï¼Œè‡ªåŠ¨æ–­å¼€è¿æ¥</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">setHeartBeatTimeout</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>  <span class="hljs-keyword">if</span> (ws.<span class="hljs-property">heartBeatTimeoutObj</span> !== -<span class="hljs-number">1</span>) &#123;<br>    <span class="hljs-built_in">clearTimeout</span>(ws.<span class="hljs-property">heartBeatTimeoutObj</span>)<br>    ws.<span class="hljs-property">heartBeatTimeoutObj</span> = -<span class="hljs-number">1</span><br>  &#125;<br>  ws.<span class="hljs-property">heartBeatTimeoutObj</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    ws.<span class="hljs-title function_">close</span>()<br>    ws.<span class="hljs-property">isAlive</span> = <span class="hljs-literal">false</span><br>  &#125;, heartBeatTime)<br>&#125;<br><span class="hljs-comment">// é‡ç½®å¿ƒè·³å®šæ—¶å™¨</span><br><span class="hljs-title function_">setHeartBeatTimeout</span>()<br></code></pre></div></td></tr></table></figure><blockquote><p>ä»“åº“åœ°å€â€œ<a href="https://git.kkgroup.cn/huanghuafeng/websocket-chatroom">é»„åå³° / WebSocket-chatroom Â· GitLab (kkgroup.cn)</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>WebSocket</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WebSocket</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>antd æŒ‰éœ€å¼•å…¥</title>
    <link href="/2022/04/20/antd%20%E6%8C%89%E9%9C%80%E5%BC%95%E5%85%A5/"/>
    <url>/2022/04/20/antd%20%E6%8C%89%E9%9C%80%E5%BC%95%E5%85%A5/</url>
    
    <content type="html"><![CDATA[<h2 id="antd-æŒ‰éœ€å¼•å…¥"><a href="#antd-æŒ‰éœ€å¼•å…¥" class="headerlink" title="antd æŒ‰éœ€å¼•å…¥"></a>antd æŒ‰éœ€å¼•å…¥</h2><h3 id="01-CRA-åˆ›å»ºé¡¹ç›®å"><a href="#01-CRA-åˆ›å»ºé¡¹ç›®å" class="headerlink" title="01 CRA åˆ›å»ºé¡¹ç›®å"></a>01 CRA åˆ›å»ºé¡¹ç›®å</h3><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// æš´éœ² config æ–‡ä»¶å¤¹</span><br>npm run eject<br></code></pre></div></td></tr></table></figure><h3 id="02-å®‰è£…-antd-å’Œ-babel-plugin-import"><a href="#02-å®‰è£…-antd-å’Œ-babel-plugin-import" class="headerlink" title="02 å®‰è£… antd å’Œ babel-plugin-import"></a>02 å®‰è£… antd å’Œ babel-plugin-import</h3><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// å®‰è£… adtd ä»¥åŠ babel-plugin-import</span><br>npm i babel-plugin-<span class="hljs-keyword">import</span> -D<br>npm i antd<br></code></pre></div></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h3 id="03-é…ç½®-antd-æŒ‰éœ€åŠ è½½"><a href="#03-é…ç½®-antd-æŒ‰éœ€åŠ è½½" class="headerlink" title="03 é…ç½® antd æŒ‰éœ€åŠ è½½"></a>03 é…ç½® antd æŒ‰éœ€åŠ è½½</h3><p>æ‰¾åˆ°ä¸‹åˆ—æ–‡ä»¶å¢åŠ é…ç½®</p><ul><li>webpack.config.js</li></ul><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// 1.æ‰¾åˆ°è¿™ä¸ªä½ç½®</span><br><span class="hljs-keyword">const</span> sassRegex = <span class="hljs-regexp">/\.(scss|sass)$/</span>;<br><span class="hljs-keyword">const</span> sassModuleRegex = <span class="hljs-regexp">/\.module\.(scss|sass)$/</span>;<br><span class="hljs-comment">// 1.åŠ å…¥ä¸‹åˆ—é…ç½®</span><br><span class="hljs-keyword">const</span> lessRegex =<span class="hljs-regexp">/\.less$/</span>;<br><span class="hljs-keyword">const</span> lessModuleRegex=<span class="hljs-regexp">/\.module\.less$/</span>;<br><br><br><span class="hljs-comment">// 2.æ‰¾åˆ°è¿™ä¸ªä½ç½®</span><br>&#123;<br>    <span class="hljs-attr">test</span>: cssModuleRegex,<br>    <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(&#123;<br>    <span class="hljs-attr">importLoaders</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">sourceMap</span>: isEnvProduction &amp;&amp; shouldUseSourceMap,<br>    <span class="hljs-attr">modules</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">getLocalIdent</span>: getCSSModuleLocalIdent,<br>    &#125;),<br> &#125;,<br> <span class="hljs-comment">// 2.åŠ å…¥ä¸‹åˆ—é…ç½®</span><br> &#123;<br>     <span class="hljs-attr">test</span>: lessRegex,<br>         <span class="hljs-attr">exclude</span>: lessModuleRegex,<br>             <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(&#123;<br>                 <span class="hljs-attr">importLoaders</span>: <span class="hljs-number">2</span>,<br>                 <span class="hljs-attr">sourceMap</span>: isEnvProduction &amp;&amp; shouldUseSourceMap,<br>             &#125;),<br>                 <span class="hljs-attr">sideEffects</span>: <span class="hljs-literal">true</span>,<br> &#125;,<br> &#123;<br>     <span class="hljs-attr">test</span>: lessModuleRegex,<br>         <span class="hljs-attr">use</span>: <span class="hljs-title function_">getStyleLoaders</span>(&#123;<br>             <span class="hljs-attr">importLoaders</span>: <span class="hljs-number">2</span>,<br>             <span class="hljs-attr">modules</span>: <span class="hljs-literal">true</span>,<br>             <span class="hljs-attr">getLocalIdent</span>: getCSSModuleLocalIdent,<br>             <span class="hljs-attr">sourceMap</span>: isEnvProduction &amp;&amp; shouldUseSourceMap,<br>         &#125;),<br> &#125;,<br><br></code></pre></div></td></tr></table></figure><ul><li>package.json</li></ul><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-string">&quot;babel&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;presets&quot;</span>: [<br>      <span class="hljs-string">&quot;react-app&quot;</span><br>    ],<br><span class="hljs-comment">//åŠ å…¥ä»¥ä¸‹ä¿¡æ¯</span><br>    <span class="hljs-string">&quot;plugins&quot;</span>: [<br>      [<br>        <span class="hljs-string">&quot;@babel/plugin-proposal-decorators&quot;</span>,<br>        &#123;<br>          <span class="hljs-string">&quot;legacy&quot;</span>: <span class="hljs-literal">true</span><br>        &#125;<br>      ],<br>      [<br>        <span class="hljs-string">&quot;import&quot;</span>,<br>        &#123;<br>          <span class="hljs-string">&quot;libraryName&quot;</span>: <span class="hljs-string">&quot;antd&quot;</span>,<br>          <span class="hljs-string">&quot;libraryDirectory&quot;</span>: <span class="hljs-string">&quot;es&quot;</span>,<br>          <span class="hljs-string">&quot;style&quot;</span>: <span class="hljs-string">&quot;css&quot;</span><br>        &#125;<br>      ]<br>    ]<br>  &#125;<br></code></pre></div></td></tr></table></figure><h3 id="04-æµ‹è¯•"><a href="#04-æµ‹è¯•" class="headerlink" title="04 æµ‹è¯•"></a>04 æµ‹è¯•</h3><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Button</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;antd&#x27;</span><br>;<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;primary&quot;</span>&gt;</span>æµ‹è¯•<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>antd</category>
      
    </categories>
    
    
    <tags>
      
      <tag>antd</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¦‚ä½•æ­£ç¡®å§¿åŠ¿ä½¿ç”¨ Hooks ä¼˜åŒ–æ€§èƒ½? ğŸ¤”</title>
    <link href="/2022/04/20/%E5%85%B3%E4%BA%8E%20React%20Hook%20%E6%80%9D%E8%80%83%E7%9A%84%E6%80%BB%E7%BB%93/"/>
    <url>/2022/04/20/%E5%85%B3%E4%BA%8E%20React%20Hook%20%E6%80%9D%E8%80%83%E7%9A%84%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h2 id="å¦‚ä½•æ­£ç¡®å§¿åŠ¿ä½¿ç”¨-Hooks-ä¼˜åŒ–æ€§èƒ½-ğŸ¤”"><a href="#å¦‚ä½•æ­£ç¡®å§¿åŠ¿ä½¿ç”¨-Hooks-ä¼˜åŒ–æ€§èƒ½-ğŸ¤”" class="headerlink" title="å¦‚ä½•æ­£ç¡®å§¿åŠ¿ä½¿ç”¨ Hooks ä¼˜åŒ–æ€§èƒ½? ğŸ¤”"></a>å¦‚ä½•æ­£ç¡®å§¿åŠ¿ä½¿ç”¨ Hooks ä¼˜åŒ–æ€§èƒ½? ğŸ¤”</h2><blockquote><p>å‰è¨€ï¼Œä½ çœŸçš„äº†è§£ Hooks ä¹ˆ? ä»Šå¤©çœ‹äº†ä¸€ç¯‡å…³äº Hooks ä½¿ç”¨è¯¯åŒºçš„ä¸€ç¯‡æ–‡ç« ï¼Œahooks çš„ä½œè€…ä»ç‰¹åˆ«çš„è§’åº¦ï¼Œå¸¦æˆ‘ä»¬é‡æ–°è®¤è¯† Hooks</p></blockquote><p>æ–‡ç«  Url: <a href="https://mp.weixin.qq.com/s/UqdFCDwf5KN4oZ-XwcTBnA">React Hooks ä½¿ç”¨è¯¯åŒºï¼Œé©³å®˜æ–¹æ–‡æ¡£ (qq.com)</a></p><h3 id="01-é‡æ–°è®¤è¯†-Hooks"><a href="#01-é‡æ–°è®¤è¯†-Hooks" class="headerlink" title="01 é‡æ–°è®¤è¯† Hooks"></a>01 é‡æ–°è®¤è¯† Hooks</h3><p>åˆšæ¥è§¦ <code>Hooks</code> é‚£ä¼šï¼Œå¤§æ¦‚çœ‹äº†ä¸‹å®˜æ–¹æ–‡æ¡£ï¼Œå®˜æ–¹ä¸€äº› Hooks å¯ä»¥ç”¨æ¥ä¼˜åŒ–æ€§èƒ½ï¼Œå°±å±é¢ å±é¢ åˆ°å¤„ä½¿ç”¨ <code>useState</code>ã€<code>useMemo</code>ã€<code>useCallback</code> ï¼Œä½†æ˜¯å…¶å®ä¸ç„¶ï¼Œ<strong>ä¼˜åŒ–æ€§èƒ½è¿™ä¸œè¥¿éœ€è¦çœ‹åœºæ™¯çš„</strong>ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰åœºæ™¯éƒ½é€‚åˆå¾—ã€‚ä¾‹å¦‚ï¼Œåœ¨å¾ˆç®€å•çš„åŸºç¡€ç±»å‹è®¡ç®—æ—¶ï¼Œå¯èƒ½ <code>useMemo</code> å¹¶ä¸åˆ’ç®—ï¼Œè¯·é—®ç®— <code>a+b</code> çš„æ¶ˆè€—å¤§ï¼Ÿè¿˜æ˜¯è®°å½• <code>a/b</code> ï¼Œå¹¶æ¯”è¾ƒ<code>a/b</code> æ˜¯å¦å˜åŒ–çš„æ¶ˆè€—å¤§ï¼Ÿåè€Œè¿˜<strong>å¢åŠ è´Ÿæ‹…</strong>ã€‚</p><h3 id="02-æ€»ç»“"><a href="#02-æ€»ç»“" class="headerlink" title="02 æ€»ç»“"></a>02 æ€»ç»“</h3><blockquote><p>ä¸Šé¢çš„æ–‡ç« ï¼Œä½œè€…è®²å¾ˆè¯¦ç»†äº†ã€‚è¿™è¾¹ä¸»è¦å¯¹ä¸Šé¢çš„æ–‡ç« è¿›è¡Œä¸€ä¸ªæ€»ç»“ï¼Œä»¥ä¾¿åé¢æŸ¥çœ‹ï¼š</p></blockquote><ul><li>Hooks ä¾èµ–ï¼Œåªæœ‰å˜åŒ–æ—¶ï¼Œéœ€è¦é‡æ–°æ‰§è¡Œ useEffect çš„å˜é‡ï¼Œæ‰è¦æ”¾åˆ° deps ä¸­ã€‚è€Œä¸æ˜¯ useEffect ç”¨åˆ°çš„å˜é‡éƒ½æ”¾åˆ° deps ä¸­ã€‚</li><li>deps å‚æ•°å¹¶ä¸å¯ä»¥è§£å†³é—­åŒ…é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ <code>useRef</code><ul><li>æ­£å¸¸æƒ…å†µä¸ä¼šæœ‰é—­åŒ…é—®é¢˜</li><li>å»¶è¿Ÿè°ƒç”¨ä¼šå­˜åœ¨é—­åŒ…é—®é¢˜<ol><li>ä½¿ç”¨ <code>setTimeout</code>ã€<code>setInterval</code>ã€<code>Promise.then</code> ç­‰</li><li><code>useEffect</code> çš„å¸è½½å‡½æ•°</li></ol></li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// é€šè¿‡ ref æ¥è®°å¿†æœ€æ–°çš„ count</span><br><span class="hljs-keyword">const</span> countRef = <span class="hljs-title function_">useRef</span>(count)<br>countRef.<span class="hljs-property">current</span> = count<br><br><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(countRef.<span class="hljs-property">current</span>)<br>  &#125;, <span class="hljs-number">3000</span>)<br>  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-built_in">clearTimeout</span>(timer)<br>  &#125;<br>&#125;, [])<br></code></pre></div></td></tr></table></figure><ul><li><p>ä¸å»ºè®®ä½¿ç”¨ <strong><code>useCallback</code></strong> ï¼Œæ˜¯è¦å’Œ <code>shouldComponentUpdate/React.memo</code> é…å¥—ä½¿ç”¨çš„ï¼Œé™¤éæœ‰ä¸ªåˆ«éå¸¸å¤æ‚çš„ç»„ä»¶ï¼Œå•ç‹¬ä½¿ç”¨å³å¯ã€‚</p></li><li><p><strong><code>useMemo</code></strong> å»ºè®®å¤§é‡ä½¿ç”¨ï¼Œä½†å¹¶ä¸æ˜¯æ— èŠ‚åˆ¶çš„ä½¿ç”¨(ç®€å•åŸºç¡€è¿ç®—)</p></li><li><p><strong><code>useState</code></strong> çš„æ­£ç¡®ä½¿ç”¨å§¿åŠ¿</p><ul><li><p>èƒ½é€šè¿‡<code>state</code>æˆ–<code>prop</code> è®¡ç®—ï¼Œå°±ä¸éœ€è¦ä½¿ç”¨ <code>useState</code></p></li><li><p>ä¿è¯æ•°æ®æºå”¯ä¸€</p><ul><li>ä¸è¦æ—¢å­˜åœ¨ <code>redux</code> ä¸­ï¼Œåˆåœ¨ç»„ä»¶ä¸­å®šä¹‰äº†ä¸€ä¸ª <code>state</code> å­˜å‚¨ã€‚</li><li>ä¸è¦æ—¢å­˜åœ¨çˆ¶çº§ç»„ä»¶ä¸­ï¼Œåˆåœ¨å½“å‰ç»„ä»¶ä¸­å®šä¹‰äº†ä¸€ä¸ª <code>state</code> å­˜å‚¨ã€‚</li><li>ä¸è¦æ—¢å­˜åœ¨ <code>url query</code> ä¸­ï¼Œåˆåœ¨ç»„ä»¶ä¸­å®šä¹‰äº†ä¸€ä¸ª <code>state</code> å­˜å‚¨ã€‚</li></ul></li><li><p>â€‹ <code>useState</code> é€‚å½“åˆå¹¶ï¼Œä¸éœ€è¦æ‹†åˆ†è¿‡ç»†ï¼Œå¢åŠ å¯è¯»æ€§</p></li></ul></li></ul><h3 id="03-å…³äºæ€§èƒ½ä¼˜åŒ–æ–‡ç« "><a href="#03-å…³äºæ€§èƒ½ä¼˜åŒ–æ–‡ç« " class="headerlink" title="03 å…³äºæ€§èƒ½ä¼˜åŒ–æ–‡ç« "></a>03 å…³äºæ€§èƒ½ä¼˜åŒ–æ–‡ç« </h3><p><a href="https://mp.weixin.qq.com/s/nrX-tHSfWaSZJrUmYbPugQ">é€ç»™ React å¼€å‘è€…åä¹æ¡æ€§èƒ½ä¼˜åŒ–å»ºè®® (qq.com)</a></p>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
      <category>Hook</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hook</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nest.js ç¯å¢ƒå˜é‡é…ç½®</title>
    <link href="/2022/04/20/Nesj.js%20%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE/"/>
    <url>/2022/04/20/Nesj.js%20%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h2 id="Nest-js-ç¯å¢ƒå˜é‡é…ç½®"><a href="#Nest-js-ç¯å¢ƒå˜é‡é…ç½®" class="headerlink" title="Nest.js ç¯å¢ƒå˜é‡é…ç½®"></a>Nest.js ç¯å¢ƒå˜é‡é…ç½®</h2><blockquote><p>å‰è¨€ï¼Œç¨‹åºéœ€è¦è·‘åœ¨ä¸åŒç¯å¢ƒä¸‹ï¼Œæ‰€ä»¥å°±ä¼šéœ€è¦ä¸åŒçš„ç¯å¢ƒå˜é‡,ä¾‹å¦‚ç”Ÿäº§ç¯å¢ƒ,æµ‹è¯•ç¯å¢ƒï¼Œä¸åŒç¯å¢ƒçš„ï¼Œé‡Œé¢å˜é‡ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œæ¯”å¦‚è¯´æ•°æ®åº“çš„ä¿¡æ¯ï¼Œç«¯å£å·ç­‰ç­‰ã€‚é…ç½®ä¸åŒçš„ç¯å¢ƒå˜é‡ä¹Ÿæ˜¯ä¸ºäº†å®ç°è½¯ç¼–ç ï¼Œé˜²æ­¢ä¸€äº›é‡è¦çš„å‚æ•°æ³„æ¼</p></blockquote><p>åœ¨ <code>Nest</code> ä¸­æœ€ä½³æ–¹æ¡ˆåˆ›å»ºä¸€ä¸ª <code>ConfigModule</code>ï¼Œè¯¥ <code>ConfigModule</code> å…¬å¼€ä¸€ä¸ª <code>ConfigService</code> ï¼Œåœ¨ <code>ConfigService</code> åŠ è½½ç‰¹æœ‰ç¯å¢ƒçš„ <code>.env</code> æ–‡ä»¶ã€‚ <code>Nest</code> æä¾›äº† <code>@nestjs/config</code> å¼€ç®±å³ç”¨çš„ä¾èµ–åŒ…ã€‚</p><p>å¼•è‡ª<a href="https://iiong.com/nest-js-environment-variable-configuration-and-serialization/">Nest.js ç¯å¢ƒå˜é‡é…ç½®å’Œåºåˆ—åŒ– â€“ æ·®åŸä¸€åªçŒ« (iiong.com)</a></p><h3 id="01-å®‰è£…"><a href="#01-å®‰è£…" class="headerlink" title="01 å®‰è£…"></a>01 å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">npm i @nestjs/config<br></code></pre></div></td></tr></table></figure><h3 id="02-é…ç½®"><a href="#02-é…ç½®" class="headerlink" title="02 é…ç½®"></a>02 é…ç½®</h3><p>åœ¨ <code>app.module.ts</code> ä¸­çš„ <code>forRoot</code> é™æ€æ–¹æ³•é…ç½®ç¯å¢ƒå˜é‡ <code>.env</code> è§£æï¼š</p><figure class="highlight tsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tsx"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Module</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@nestjs/common&#x27;</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">ConfigModule</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@nestjs/config&#x27;</span><br><br><span class="hljs-meta">@Module</span>(&#123;<br>  <span class="hljs-attr">imports</span>: [<span class="hljs-title class_">ConfigModule</span>.<span class="hljs-title function_">forRoot</span>()],<br>&#125;)<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppModule</span> &#123;&#125;<br></code></pre></div></td></tr></table></figure><p>åœ¨ <code>åŒçº§src</code> æ–°å»º <code>.env</code> æ–‡ä»¶:</p><figure class="highlight ini"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ini"><span class="hljs-attr">DB_HOST</span>=localhost<br><span class="hljs-attr">DB_PORT</span>=<span class="hljs-number">3306</span><br><span class="hljs-attr">DB_USER</span>=xxx<br><span class="hljs-attr">DB_PASSWORD</span>=xxx<br><span class="hljs-attr">DB_DATABASE</span>=xxxx<br></code></pre></div></td></tr></table></figure><ul><li><strong>æŒ‰éœ€å¼•å…¥ .module.ts æ–‡ä»¶å¼•å…¥</strong></li></ul><figure class="highlight tsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tsx"><span class="hljs-comment">// åœ¨éœ€è¦ *.module.ts æ–‡ä»¶å¼•å…¥</span><br><span class="hljs-meta">@Module</span>(&#123;<br>  <span class="hljs-attr">imports</span>: [<span class="hljs-title class_">ConfigModule</span>],<br>  <span class="hljs-comment">// ...</span><br>&#125;)<br></code></pre></div></td></tr></table></figure><ul><li><strong>å…¨å±€å¼•å…¥</strong></li></ul><p><code>app.module.ts</code> å…¨å±€å¼•å…¥</p><figure class="highlight tsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tsx"><span class="hljs-keyword">import</span> configuration <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./config/configuration&#x27;</span><br><br><span class="hljs-meta">@Module</span>(&#123;<br>  <span class="hljs-attr">imports</span>: [<br>    <span class="hljs-title class_">ConfigModule</span>.<span class="hljs-title function_">forRoot</span>(&#123;<br>      <span class="hljs-attr">isGlobal</span>: <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">load</span>: [configuration],<br>    &#125;),<br>  ],<br>&#125;)<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppModule</span> &#123;&#125;<br></code></pre></div></td></tr></table></figure><h3 id="03-è¯»å–é…ç½®"><a href="#03-è¯»å–é…ç½®" class="headerlink" title="03 è¯»å–é…ç½®"></a>03 è¯»å–é…ç½®</h3><p>åœ¨éœ€è¦ç”¨åˆ°é…ç½®åœ°æ–¹ï¼Œåœ¨æ„é€ å‡½æ•°æ³¨å…¥ä½¿ç”¨ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">ConfigService</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@nestjs/config&#x27;</span><br><br><span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> configService: ConfigService</span>) &#123;&#125;<br></code></pre></div></td></tr></table></figure><p>ä½¿ç”¨é…ç½®ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs typescript"><span class="hljs-keyword">const</span> dbUser = <span class="hljs-variable language_">this</span>.<span class="hljs-property">configService</span>.<span class="hljs-property">get</span>&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">&#x27;DB_USER&#x27;</span>)<br><span class="hljs-keyword">const</span> dbHost = <span class="hljs-variable language_">this</span>.<span class="hljs-property">configService</span>.<span class="hljs-property">get</span>&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">&#x27;DB_HOST&#x27;</span>)<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Node</category>
      
      <category>Nest</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Nest</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vlist è™šæ‹Ÿç½‘æ ¼ç»„ä»¶ -- è§£è¯»ğŸ¤“</title>
    <link href="/2022/03/30/Vlist%20%E8%99%9A%E6%8B%9F%E7%BD%91%E6%A0%BC%E7%BB%84%E4%BB%B6%20--%20%E8%A7%A3%E8%AF%BB/"/>
    <url>/2022/03/30/Vlist%20%E8%99%9A%E6%8B%9F%E7%BD%91%E6%A0%BC%E7%BB%84%E4%BB%B6%20--%20%E8%A7%A3%E8%AF%BB/</url>
    
    <content type="html"><![CDATA[<h2 id="Vlist-è™šæ‹Ÿç½‘æ ¼ç»„ä»¶-â€“-è§£è¯»-ğŸ¤“"><a href="#Vlist-è™šæ‹Ÿç½‘æ ¼ç»„ä»¶-â€“-è§£è¯»-ğŸ¤“" class="headerlink" title="Vlist è™šæ‹Ÿç½‘æ ¼ç»„ä»¶ â€“ è§£è¯» ğŸ¤“"></a>Vlist è™šæ‹Ÿç½‘æ ¼ç»„ä»¶ â€“ è§£è¯» ğŸ¤“</h2><blockquote><p>å‰è¨€ï¼Œ å‰å‡ å¤©åˆšå®Œæˆä¸€ä¸ªéœ€æ±‚ï¼Œé•¿ï¼ˆç½‘æ ¼ï¼‰åˆ—è¡¨ä¼˜åŒ–ï¼Œä¸»è¦å‚è€ƒäº†è™šæ‹Ÿåˆ—è¡¨åŸç†ã€‚ä¸åŒçš„æ˜¯ï¼Œè™šæ‹Ÿåˆ—è¡¨æ˜¯ä¸€ç»´çº¿æ€§ä¸‹æ¥çš„ï¼Œè€Œè™šæ‹Ÿç½‘æ ¼æ˜¯äºŒç»´ï¼Œè¦è€ƒè™‘ä¸ä»…æ˜¯å±å¹•é«˜åº¦ï¼Œè¿˜è¦å±å¹•çš„å®½åº¦ã€‚ä¸åºŸè¯è¾½ï¼Œä¸Šå¹²è´§ã€‚</p></blockquote><h3 id="01-å…ˆæµ…ç”¨ä¸‹ï¼Œæ„Ÿå—ä¸‹å®ƒçš„ç¥å¥‡"><a href="#01-å…ˆæµ…ç”¨ä¸‹ï¼Œæ„Ÿå—ä¸‹å®ƒçš„ç¥å¥‡" class="headerlink" title="01 å…ˆæµ…ç”¨ä¸‹ï¼Œæ„Ÿå—ä¸‹å®ƒçš„ç¥å¥‡"></a>01 å…ˆæµ…ç”¨ä¸‹ï¼Œæ„Ÿå—ä¸‹å®ƒçš„ç¥å¥‡</h3><img src="https://s2.loli.net/2022/03/30/BteKUqVIXaC8JTk.gif" alt="è™šæ‹Ÿç½‘æ ¼gif" style="zoom: 50%;" /><blockquote><p>å¯ä»¥å¾ˆæ¸…æ™°çœ‹åˆ°ï¼Œéšç€é¡µé¢çš„æ»šåŠ¨ï¼ŒDOM ä¹Ÿæ˜¯è·Ÿç€æ¸²æŸ“çš„ï¼Œæå¤§å‡å°‘äº†æµè§ˆå™¨çš„å¼€é”€ï¼ˆå¡é¡¿æ˜¯å› ä¸ºå½•åˆ¶ gif,åªæœ‰ 10fpsğŸ˜… ï¼‰</p></blockquote><h3 id="02-è™šæ‹Ÿç½‘æ ¼å®è·µ"><a href="#02-è™šæ‹Ÿç½‘æ ¼å®è·µ" class="headerlink" title="02 è™šæ‹Ÿç½‘æ ¼å®è·µ"></a>02 è™šæ‹Ÿç½‘æ ¼å®è·µ</h3><blockquote><p>è™šæ‹Ÿç½‘æ ¼çš„åŸç†ï¼š å…¶å®å°±æ˜¯æ ¹æ®å¤–å±‚å®¹å™¨å°ºå¯¸ï¼Œè¿›è¡Œæ•°æ®åˆ†ç»„ï¼Œä»¥ç»„ä¸ºå•ä½æ¸²æŸ“æ•°æ®åˆ—ï¼ˆcolumn - nï¼‰ï¼Œç„¶åå‰©ä¸‹å°±æ˜¯å’Œè™šæ‹Ÿåˆ—è¡¨çš„åŸç†å¤§è‡´ä¸€æ ·å˜š</p></blockquote><p><img src="https://s2.loli.net/2022/03/30/WQPjyoCwNh9JE3n.png" alt="image-20220330181540874"></p><ol><li><p>é¦–å…ˆï¼Œæ˜ç¡®å‡ ä¸ª<strong>å˜é‡</strong></p><ul><li><p><strong>column</strong> ï¼šå†…å±‚å®¹å™¨çºµå‘æœ€å¤§å¯æ”¾ç½®çš„æ•°é‡</p></li><li><p><strong>row</strong>ï¼šå†…å±‚å®¹å™¨æ¨ªå‘æœ€å¤§å¯æ”¾ç½®çš„æ•°é‡</p></li><li><p><strong>itemWidth</strong>ï¼šå­ç»„ä»¶çš„ width</p></li><li><p><strong>itemHeight</strong>: å­ç»„ä»¶çš„ height</p></li><li><p><strong>startGroupIndex:</strong> æ¸²æŸ“ï¼Œå¼€å§‹æ¸²æŸ“çš„ä½ç½®ï¼ˆç»„ï¼‰</p></li><li><p><strong>endtGroupIndex:</strong> æ¸²æŸ“ï¼Œç»“æŸæ¸²æŸ“çš„ä½ç½®ï¼ˆç»„ï¼‰</p></li></ul></li><li><p>æˆ‘ä»¬åªå¯¹å¯è§†å±‚åšæ¸²æŸ“ï¼Œä½†æ˜¯ä¸ºäº†ä¿æŒæ•´ä¸ªå®¹å™¨åƒæ¸²æŸ“æ­£å¸¸é•¿åˆ—è¡¨ä¸€æ ·ï¼Œé‡Œé¢çš„å®¹å™¨è¿˜éœ€è¦ä¿æŒåŸæœ‰çš„é«˜åº¦ã€‚è¿™è¾¹æŠŠ <code>Html</code> è®¾è®¡è¿™æ ·</p><figure class="highlight xml"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- å¤–å±‚å®¹å™¨ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;vListContainer&quot;</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- å†…å±‚å®¹å™¨ --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;phantomContent&quot;</span>&gt;</span><br>    ...<br>    <span class="hljs-comment">&lt;!-- column-1 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- column-2 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- column-3 --&gt;</span><br>    ....<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></div></td></tr></table></figure></li><li><p>é€šè¿‡è®¡ç®—<code>_.chunk(itemsArray, column )</code>ï¼Œæ‹¿åˆ°åˆ†ç»„çš„æ•°ç»„ <code>groupItems</code></p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// groupItems äºŒç»´æ•°ç»„</span><br>;[[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>][(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>)][(<span class="hljs-number">7</span>, <span class="hljs-number">8</span>)]]<br></code></pre></div></td></tr></table></figure></li><li><p>å†é€šè¿‡ç›‘å¬ <code>å¤–å±‚å®¹å™¨ onscroll</code> è®¡ç®—å‡º <code>startGroupIndex</code> å’Œ <code>endtGroupIndex</code></p></li><li><p>é€šè¿‡ <code>renderDisplayContent</code> æ¸²æŸ“åˆ°é¡µé¢ä¸Š</p></li><li><p>å¦å¤–å½“é¡µé¢å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé€šè¿‡ç›‘å¬<code>resize</code> äº‹ä»¶ï¼ˆcomputeGridSizeï¼‰æ›´æ–° <code>column</code>ï¼Œ<code>row</code>ï¼Œ<code>groupItems</code>ï¼Œä»¥é‡æ–°æ¸²æŸ“</p></li></ol><h3 id="03-è™šæ‹Ÿç½‘æ ¼ç»„ä»¶æºç ç»†èŠ‚"><a href="#03-è™šæ‹Ÿç½‘æ ¼ç»„ä»¶æºç ç»†èŠ‚" class="headerlink" title="03 è™šæ‹Ÿç½‘æ ¼ç»„ä»¶æºç ç»†èŠ‚"></a>03 è™šæ‹Ÿç½‘æ ¼ç»„ä»¶æºç ç»†èŠ‚</h3><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, &#123; useState, useCallback, useMemo, useEffect &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><span class="hljs-keyword">import</span> useThrottle <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;hooks/useThrottle&#x27;</span><br><span class="hljs-keyword">import</span> _ <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;lodash&#x27;</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">VListStyle</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./style&#x27;</span><br><span class="hljs-keyword">import</span> &#123; useRef &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@description</span>: è™šæ‹Ÿåˆ—è¡¨</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">*</span>&#125; containerRef å¤–å®¹å™¨ref</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">*</span>&#125; itemsArray åˆ—è¡¨æ•°æ®</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">*</span>&#125; childrenå­ç»„ä»¶</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">*</span>&#125; containerInitHeight å¤–å®¹å™¨åˆå§‹é«˜åº¦</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">*</span>&#125; containeInitWidth å¤–å®¹å™¨åˆå§‹å®½åº¦</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">*</span>&#125; itemHeight å­ç»„ä»¶é«˜åº¦</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">*</span>&#125; itemWidthå­ç»„ä»¶å®½åº¦</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">*</span>&#125; BufferSize åˆ—è¡¨ç¼“å†²åŒºå¤§å°</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> &#123;<span class="hljs-type">*</span>&#125;</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">VList</span>(<span class="hljs-params">&#123;</span><br><span class="hljs-params">  containerRef,</span><br><span class="hljs-params">  itemsArray = [],</span><br><span class="hljs-params">  children,</span><br><span class="hljs-params">  containerInitHeight,</span><br><span class="hljs-params">  containeInitWidth,</span><br><span class="hljs-params">  itemHeight,</span><br><span class="hljs-params">  itemWidth,</span><br><span class="hljs-params">  BufferSize = <span class="hljs-number">4</span>,</span><br><span class="hljs-params">&#125;</span>) &#123;<br>  <span class="hljs-comment">// å†…å±‚å®¹å™¨çš„ ref</span><br>  <span class="hljs-keyword">const</span> phantomContentRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>)<br><br>  <span class="hljs-comment">// å†…å±‚å®¹å™¨çºµå‘æœ€å¤§å¯æ”¾ç½®çš„æ•°é‡</span><br>  <span class="hljs-keyword">const</span> [column, setColumn] = <span class="hljs-title function_">useState</span>(<span class="hljs-function">() =&gt;</span><br>    <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(containeInitWidth / itemWidth)<br>  )<br><br>  <span class="hljs-comment">// å†…å±‚å®¹å™¨æ¨ªå‘æœ€å¤§å¯æ”¾ç½®çš„æ•°é‡</span><br>  <span class="hljs-keyword">const</span> [row, setRow] = <span class="hljs-title function_">useState</span>(<span class="hljs-function">() =&gt;</span><br>    <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(containerInitHeight / itemHeight)<br>  )<br><br>  <span class="hljs-comment">// åˆ—è¡¨æ•°æ®åˆ†ç»„ï¼ŒæŒ‰ç…§columnåˆ†ç»„</span><br>  <span class="hljs-keyword">const</span> [groupItems, setGroupItems] = <span class="hljs-title function_">useState</span>(<span class="hljs-function">() =&gt;</span><br>    _.<span class="hljs-title function_">chunk</span>(itemsArray, column)<br>  )<br><br>  <span class="hljs-comment">// æ¸²æŸ“ï¼Œå¼€å§‹æ¸²æŸ“çš„ä½ç½®ï¼ˆç»„ï¼‰</span><br>  <span class="hljs-keyword">const</span> [startGroupIndex, setStartGroupIndex] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>)<br><br>  <span class="hljs-comment">// æ¸²æŸ“ï¼Œç»“æŸæ¸²æŸ“çš„ä½ç½®ï¼ˆç»„ï¼‰</span><br>  <span class="hljs-keyword">const</span> [endtGroupIndex, setEndGroupIndex] = <span class="hljs-title function_">useState</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(row * column, groupItems.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>)<br>  &#125;)<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@description</span>: æ»šåŠ¨æ¡ onscrolläº‹ä»¶ï¼Œè®¡ç®— startGroupIndexï¼Œ endtGroupIndex</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param</span></span><br><span class="hljs-comment">   * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-keyword">const</span> onScrollListening = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-comment">// å†…å±‚å®¹å™¨æ»šåŠ¨åç§»é‡</span><br>    <span class="hljs-keyword">const</span> &#123; scrollTop &#125; = containerRef.<span class="hljs-property">current</span><br><br>    <span class="hljs-comment">// è®¡ç®—æ»šåŠ¨åˆ°çš„ç»„ç´¢å¼•å·</span><br>    <span class="hljs-keyword">const</span> currentstartGroupIndex = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(scrollTop / itemHeight)<br><br>    <span class="hljs-comment">// å½“å‰æ»šåŠ¨åˆ°çš„ç»„ç´¢å¼•å· ä¸ startGroupIndex ä¸åŒæ—¶ï¼Œæ‰æ›´æ–° startGroupIndexï¼Œ endtGroupIndex</span><br>    <span class="hljs-keyword">if</span> (currentstartGroupIndex !== startGroupIndex) &#123;<br>      <span class="hljs-title function_">setStartGroupIndex</span>(currentstartGroupIndex)<br>      <span class="hljs-title function_">setEndGroupIndex</span>(<br>        <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(startGroupIndex + row + <span class="hljs-title class_">BufferSize</span>, groupItems.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>)<br>      )<br>    &#125;<br>  &#125;, [itemHeight, startGroupIndex, containerRef, <span class="hljs-title class_">BufferSize</span>, groupItems, row])<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@description</span>: ç”¨äºé€šè¿‡ startGroupIndexï¼Œ endtGroupIndex éå† groupItems æ¸²æŸ“åˆ°é¡µé¢ä¸Š</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param</span></span><br><span class="hljs-comment">   * <span class="hljs-doctag">@return</span></span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-keyword">const</span> renderDisplayContent = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-comment">// itemsArray æ•°æ®ä¸ºç©ºï¼Œä¸æ¸²æŸ“</span><br>    <span class="hljs-keyword">if</span> (!_.<span class="hljs-title function_">isEmpty</span>(itemsArray)) &#123;<br>      <span class="hljs-comment">// å­˜æ”¾éœ€è¦éœ€è¦æ¸²æŸ“DOM æ•°ç»„</span><br>      <span class="hljs-keyword">const</span> content = []<br><br>      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = startGroupIndex; i &lt;= endtGroupIndex; i++) &#123;<br>        content.<span class="hljs-title function_">push</span>(<br>          <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;i&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;phantomItem&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span></span></span><br><span class="hljs-tag"><span class="language-xml">              <span class="hljs-attr">gridTemplateColumns:</span> `<span class="hljs-attr">repeat</span>(<span class="hljs-attr">auto-fill</span>, $&#123;<span class="hljs-attr">itemWidth</span>&#125;<span class="hljs-attr">px</span>)`,</span></span><br><span class="hljs-tag"><span class="language-xml">            &#125;&#125;</span></span><br><span class="hljs-tag"><span class="language-xml">          &gt;</span></span><br><span class="language-xml">            &#123;</span><br><span class="language-xml">              // éå† groupItems</span><br><span class="language-xml">              groupItems[i].map((item, j) =&gt; children(item, `$&#123;i&#125;-$&#123;j&#125; `))</span><br><span class="language-xml">            &#125;</span><br><span class="language-xml">          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>        )<br>      &#125;<br>      <span class="hljs-keyword">return</span> content<br>    &#125;<br>  &#125;, [<br>    startGroupIndex,<br>    endtGroupIndex,<br>    groupItems,<br>    children,<br>    itemsArray,<br>    itemWidth,<br>  ])<br><br>  <span class="hljs-comment">// ç»™ containerBobyRef åŠ ä¸Š onscroll äº‹ä»¶</span><br>  containerRef.<span class="hljs-property">current</span>.<span class="hljs-property">onscroll</span> = <span class="hljs-title function_">useThrottle</span>(onScrollListening, <span class="hljs-number">100</span>, [])<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@description</span>: ç”¨äºç›‘å¬å¤–å±‚å®¹å™¨çš„å¯è§†åŒºåŸŸå¤§å°å˜åŒ–</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> &#123;<span class="hljs-type">*</span>&#125;</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@return</span> &#123;<span class="hljs-type">*</span>&#125;</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-keyword">const</span> computeGridSize = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-comment">// å¤–å±‚å®¹å™¨å½“å‰å¯è§†é«˜åº¦</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-title class_">Height</span> = containerRef.<span class="hljs-property">current</span>.<span class="hljs-property">clientHeight</span><br><br>    <span class="hljs-comment">// å¤–å±‚å®¹å™¨å½“å‰å¯è§†å®½åº¦</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-title class_">Width</span> = containerRef.<span class="hljs-property">current</span>.<span class="hljs-property">clientWidth</span><br><br>    <span class="hljs-comment">// å†…å±‚å®¹å™¨çºµå‘å½“å‰æœ€å¤§å¯æ”¾ç½®çš„æ•°é‡</span><br>    <span class="hljs-keyword">const</span> currentColumn = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Width</span> / itemWidth)<br><br>    <span class="hljs-comment">// å†…å±‚å®¹å™¨æ¨ªå‘å½“å‰æœ€å¤§å¯æ”¾ç½®çš„æ•°é‡</span><br>    <span class="hljs-keyword">const</span> currentRow = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(<span class="hljs-title class_">Height</span> / itemHeight)<br><br>    <span class="hljs-comment">// ä¸ç›¸åŒæ—¶ï¼Œè¯´æ˜é¡µé¢å‘ç”Ÿå˜åŒ–ï¼Œæ›´æ–° columnï¼Œ row</span><br>    <span class="hljs-keyword">if</span> (currentColumn !== column || currentRow !== row) &#123;<br>      <span class="hljs-title function_">setColumn</span>(currentColumn)<br>      <span class="hljs-title function_">setRow</span>(currentRow)<br>      <span class="hljs-title function_">setGroupItems</span>(_.<span class="hljs-title function_">chunk</span>(itemsArray, currentColumn))<br>    &#125;<br>  &#125;, [containerRef, itemHeight, itemWidth, column, row, itemsArray])<br><br>  <span class="hljs-comment">// ç›‘å¬å¤–å±‚å®¹å™¨çš„å¯è§†åŒºåŸŸå¤§å°å˜åŒ–</span><br>  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;resize&#x27;</span>, computeGridSize)<br>    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&#x27;resize&#x27;</span>, computeGridSize)<br>  &#125;, [computeGridSize])<br><br>  <span class="hljs-comment">// height: `$&#123;groupItems.length * itemHeight&#125;px`</span><br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">VListStyle</span></span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;phantomContent&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;phantomContentRef&#125;</span></span></span><br><span class="hljs-tag"><span class="language-xml">        <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span></span></span><br><span class="hljs-tag"><span class="language-xml">          <span class="hljs-attr">marginTop:</span> `$&#123;<span class="hljs-attr">startGroupIndex</span> * <span class="hljs-attr">itemHeight</span>&#125;<span class="hljs-attr">px</span>`,</span></span><br><span class="hljs-tag"><span class="language-xml">          <span class="hljs-attr">marginBottom:</span> `$&#123;</span></span><br><span class="hljs-tag"><span class="language-xml">            (<span class="hljs-attr">groupItems.length</span> <span class="hljs-attr">-</span> <span class="hljs-attr">endtGroupIndex</span> <span class="hljs-attr">-</span> <span class="hljs-attr">1</span>) * <span class="hljs-attr">itemHeight</span></span></span><br><span class="hljs-tag"><span class="language-xml">          &#125;<span class="hljs-attr">px</span>`,</span></span><br><span class="hljs-tag"><span class="language-xml">        &#125;&#125;</span></span><br><span class="hljs-tag"><span class="language-xml">      &gt;</span></span><br><span class="language-xml">        &#123;renderDisplayContent&#125;</span><br><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">VListStyle</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/&gt;</span></span><br>  )<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">VList</span><br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è™šæ‹Ÿåˆ—è¡¨</tag>
      
      <tag>è™šæ‹Ÿç½‘æ ¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å°è£…ç»„ä»¶ -- FileTable</title>
    <link href="/2022/03/28/%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%20--%20FileTable/"/>
    <url>/2022/03/28/%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6%20--%20FileTable/</url>
    
    <content type="html"><![CDATA[<h2 id="å°è£…ç»„ä»¶-â€“-FileTable"><a href="#å°è£…ç»„ä»¶-â€“-FileTable" class="headerlink" title="å°è£…ç»„ä»¶ â€“ FileTable"></a>å°è£…ç»„ä»¶ â€“ FileTable</h2><h3 id="01-å‰è¨€"><a href="#01-å‰è¨€" class="headerlink" title="01 å‰è¨€"></a>01 å‰è¨€</h3><p><strong>é‡åˆ°é—®é¢˜ï¼š</strong></p><p>åœ¨å†™ä¸ªè¿™ä¸ªç»„ä»¶ä¹‹å‰ï¼Œé¦–å½“å…¶å†²æƒ³åˆ°æ˜¯æ”¹é€  <code>Antd â€˜s Table</code> ç»„ä»¶ï¼Œå›¾ä¸ªæ–¹ä¾¿ï¼ˆä¸éœ€è¦ä¸€ä¸ªä¸€ä¸ªå†™æ ·å¼ï¼‰ã€‚ä½†æ˜¯åé¢å‘ç°ï¼Œ<code>antd</code> è‡ªå¸¦çš„ <code>Table</code> å¯¹äº<code>é«˜åº¦è‡ªé€‚åº”</code>éå¸¸ä¸å‹å¥½ï¼ˆç‰¹åˆ«æ˜¯æ•°æ®é‡å°‘çš„æ—¶å€™ï¼Œtable ç›´æ¥ç»™ä½ ç¼©æˆçŸ­çŸ­ä¸€è¡Œï¼‰</p><p><strong>å°è¯•çš„è§£å†³æ–¹æ¡ˆï¼š</strong></p><ul><li>åœ¨é€šè¿‡<code>å®˜æ–¹æ–‡æ¡£</code>ã€<code>Google</code> å’Œ <code>issues</code> å„ç§æ–¹å¼éƒ½æ²¡æ‰¾åˆ°æ¯”è¾ƒå¥½è§£å†³æ–¹æ¡ˆ</li><li>å°è¯•äº†æ“ä½œ <code>DOM</code> å»èµ‹å€¼å¯ä»¥å®ç°éœ€æ±‚ï¼ˆä½†æ˜¯è¿™ä¸ªä¸å¤ªå¥½ï¼‰</li><li>æƒ³è¿‡ä¿®æ”¹ <code>Table</code> ç»„ä»¶åŸæ¥çš„æ ·å¼ï¼Œåˆ†æè¿‡åï¼Œå®ƒçš„<code>DOM</code> ç»“æ„è¿‡äºå¤æ‚ï¼Œè€Œä¸”åæœŸè¿˜æœ‰éšè—çš„ <code>Bug</code> ï¼Œç»“åˆä¿®æ”¹æ—¶é—´ï¼Œæ€§æ¯”ä»·ä¸å¤ªé«˜</li></ul><p><strong>æœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆï¼š</strong></p><p>å‚ç…§ <code>Teamshare</code> å†³å®šè¿˜æ˜¯é‡æ–°è‡ªå·±å†™ä¸€ä¸ªç»„ä»¶â€”<code>FileTable</code> , è¡€çš„æ•™è®­ï¼ˆå‰é¢çš„å·¥ä½œé‡ç™½åšäº†ï¼‰</p><h3 id="02-FileTable-ç»„ä»¶ç»“æ„"><a href="#02-FileTable-ç»„ä»¶ç»“æ„" class="headerlink" title="02 FileTable ç»„ä»¶ç»“æ„"></a>02 FileTable ç»„ä»¶ç»“æ„</h3><p><img src="https://s2.loli.net/2022/03/18/9rNiBozQEqGlf8P.png" alt="image-20220318104450107"></p><blockquote><p><strong>æ–‡ä»¶ç»“æ„ï¼š</strong></p><ol><li>TableBody â€“ è¡¨æ ¼ Body<ul><li>FileNameCell â€“ ç”¨äºæ˜¾ç¤º æ–‡ä»¶ç±»å‹ icon å’Œ æ–‡ä»¶å</li><li>OperationCell â€“ ç”¨äºæ˜¾ç¤º â€œâ€¦â€</li><li>index.jsx â€“ è¡¨æ ¼ä½“ Body å…¥å£æ–‡ä»¶</li><li>style.js â€“ è¡¨æ ¼ Body æ ·å¼</li></ul></li><li>TableHeader â€“ è¡¨å¤´<ul><li>columns.js â€“ é¢„å®šä¹‰å†™è¡¨æ ¼åˆ—</li><li>constants.js â€“ å¸¸ç”¨å˜é‡</li><li>index.jsx â€“ ç”¨äºç»„è£… TableBody å’Œ TableHeader</li><li>style.js â€“ æ–‡ä»¶è¡¨æ ¼æ ·å¼</li><li>utils.js â€“ å·¥å…·ç±»æ–¹æ³•</li></ul></li></ol></blockquote><h3 id="03-FileTable-è½»ä½¿ç”¨"><a href="#03-FileTable-è½»ä½¿ç”¨" class="headerlink" title="03 FileTable è½»ä½¿ç”¨"></a>03 FileTable è½»ä½¿ç”¨</h3><p><strong>å‚æ•° Paramsï¼š</strong></p><ul><li><em>className</em> â€“ ç±»å</li><li><em>rowKeys</em> â€“ row â€˜s Key</li><li><em>getData</em> â€“ è·å–æ•°æ® API</li><li><em>columns</em> â€“ è¡¨æ ¼åˆ—</li><li><em>storageKey</em> â€“ å­˜åœ¨ SessionStorageKey â€˜s Key</li><li><em>emptyImage</em> â€“ æ•°æ®ä¸ºç©ºæ—¶å€™ï¼Œæ˜¾ç¤ºçš„ icon</li><li>emptyTip â€“ æ•°æ®ä¸ºç©ºæ—¶å€™ï¼Œæ˜¾ç¤ºçš„ tip</li></ul><p><strong>ä½ å°†ä¼šå¾—åˆ°ï¼š</strong></p><p><img src="https://s2.loli.net/2022/03/18/JT5hnxBwsyfUN9b.png" alt="image-20220318104520407"></p>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
    </categories>
    
    
    <tags>
      
      <tag>React</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Typora å°å¦™æ‹› -- å›¾ç‰‡æœåŠ¡å™¨ğŸ˜Š</title>
    <link href="/2022/03/28/Typora%20%E5%B0%8F%E5%A6%99%E6%8B%9B%20--%20%E5%9B%BE%E7%89%87%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    <url>/2022/03/28/Typora%20%E5%B0%8F%E5%A6%99%E6%8B%9B%20--%20%E5%9B%BE%E7%89%87%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="Typora-å°å¦™æ‹›-â€“-å›¾ç‰‡æœåŠ¡å™¨-ğŸ˜Š"><a href="#Typora-å°å¦™æ‹›-â€“-å›¾ç‰‡æœåŠ¡å™¨-ğŸ˜Š" class="headerlink" title="Typora å°å¦™æ‹› â€“ å›¾ç‰‡æœåŠ¡å™¨ ğŸ˜Š"></a>Typora å°å¦™æ‹› â€“ å›¾ç‰‡æœåŠ¡å™¨ ğŸ˜Š</h2><h3 id="01-å‰è¨€"><a href="#01-å‰è¨€" class="headerlink" title="01 å‰è¨€"></a>01 å‰è¨€</h3><p><code>Typora</code> æ˜¯å½“ä»Šç¨‹åºçŒ¿ç¬”è®°åˆ©å™¨ï¼Œå½“æˆ‘ä»¬éœ€è¦æ’å›¾ç‰‡åœ¨ç¬”è®°ä¸­ï¼Œä¿å­˜å…¶å®æ˜¯æœ¬åœ°å›¾ç‰‡ã€‚ä¸€æ—¦ä½ ä¸Šä¼ åˆ°è‡ªå·±æ’­å®¢ä¸Šé¢ï¼Œå°±ä¼šå‘ç°å›¾ç‰‡æ˜¾ç¤ºä¸å‡ºæ¥ï¼Œéå¸¸éº»çƒ¦ã€‚è¿™è¾¹æ•™å¤§å®¶é…ç½®ä¸€ä¸ªå›¾ç‰‡æœåŠ¡å™¨ï¼Œä½¿ç”¨ <code>sm.ms</code> ä½œä¸ºå›¾åºŠ</p><blockquote><p>Typora V0.11.17</p></blockquote><h3 id="02-æ•™ç¨‹"><a href="#02-æ•™ç¨‹" class="headerlink" title="02 æ•™ç¨‹"></a>02 æ•™ç¨‹</h3><p>é€‰æ‹© sm.ms ä½œä¸ºå›¾åºŠ,å®˜ç½‘åœ°å€ï¼š<a href="https://sm.ms/">https://sm.ms</a></p><p>ç‰¹ç‚¹ï¼šæ°¸ä¹…å­˜å‚¨å…æ³¨å†Œï¼Œå›¾ç‰‡é“¾æ¥æ”¯æŒ httpsï¼Œå¯ä»¥åˆ é™¤ä¸Šä¼ çš„å›¾ç‰‡ï¼Œæä¾›å¤šç§å›¾ç‰‡é“¾æ¥æ ¼å¼ï¼Œç›®å‰å…è´¹ç”¨æˆ·æ— æ³•ä½¿ç”¨é¦™æ¸¯èŠ‚ç‚¹å› æ­¤é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œæœ‰æ—¶å€™å¯èƒ½ä¸Šä¼ å¤±è´¥ã€‚</p><p>å›¾ç‰‡ä¸Šä¼ é™åˆ¶ï¼šæ¯ä¸ªå›¾ç‰‡æœ€å¤§ 5Mï¼Œæ¯æ¬¡æœ€å¤šä¸Šä¼  10 å¼ </p><ol><li><p>æ³¨å†Œæˆ–ç™»é™† sm.ms</p><p>â€‹ <a href="https://sm.ms/login">https://sm.ms/login</a></p></li><li><p>ç”Ÿæˆ token</p><p><img src="https://s2.loli.net/2022/03/17/Ym7XfbrlZVjdEhv.png" alt="image-20220317225046857"></p></li><li><p>é…ç½® token</p><p>è¿›å…¥<a href="https://sm.ms/home/apitoken">API Access - SM.MS | Dashboard</a></p><p><img src="https://s2.loli.net/2022/03/17/m4aX9PZvYwbc5lS.png" alt="image-20220317225253731"></p><p>å›åˆ° Typora é…ç½®</p><p><img src="C:\Users\DuoRouSai\AppData\Roaming\Typora\typora-user-images\image-20220317225444609.png" alt="image-20220317225444609"></p><p>æŒ‰ç…§å›¾ç‰‡é¡ºåºï¼Œé…ç½® config</p><p><img src="https://s2.loli.net/2022/03/17/TdfZnEJyoaIXHVm.png" alt="image-20220317225658734"></p><figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;picBed&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;uploader&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;smms&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">//ä¼ å›¾åºŠä¸º SM.MS,</span><br>    <span class="hljs-attr">&quot;smms&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;token&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;xxxxxxxxxxxxxxxxxxxxx&quot;</span> <span class="hljs-comment">//è¿™é‡Œé¢çš„tokenæ¢æˆåˆšåˆšç”Ÿæˆçš„ sm.ms çš„token</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;picgoPlugins&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></div></td></tr></table></figure><p>æ³¨æ„ä¿®æ”¹åé‡å¯è½¯ä»¶ !!!</p></li></ol><p><strong>æ•ˆæœé¢„è§ˆ</strong>:</p><p>å°†å›¾ç‰‡å¤åˆ¶åˆ° Typora ,å°±è‡ªåŠ¨ä¸Šä¼ </p><p><img src="https://s2.loli.net/2022/03/17/xMtPjqCZ7mfJiAU.png" alt="image-20220317230130170"></p><p><strong>å¤§åŠŸå‘Šæˆï¼ï¼ï¼</strong> ğŸ’•</p><p><img src="../AppData/Roaming/Typora/typora-user-images/image-20220318141602372.png" alt="image-20220318141602372"></p>]]></content>
    
    
    <categories>
      
      <category>Typora</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>stopPropagation å’Œ stopImmediatePropagationåŒºåˆ«âœŒï¸</title>
    <link href="/2022/03/28/stopPropagation%20%E5%92%8C%20stopImmediatePropagation%E5%8C%BA%E5%88%AB/"/>
    <url>/2022/03/28/stopPropagation%20%E5%92%8C%20stopImmediatePropagation%E5%8C%BA%E5%88%AB/</url>
    
    <content type="html"><![CDATA[<h1 id="stopPropagation-å’Œ-stopImmediatePropagation-åŒºåˆ«-âœŒï¸"><a href="#stopPropagation-å’Œ-stopImmediatePropagation-åŒºåˆ«-âœŒï¸" class="headerlink" title="stopPropagation å’Œ stopImmediatePropagation åŒºåˆ« âœŒï¸"></a>stopPropagation å’Œ stopImmediatePropagation åŒºåˆ« âœŒï¸</h1><h3 id="01-åè¯è§£é‡Š"><a href="#01-åè¯è§£é‡Š" class="headerlink" title="01 åè¯è§£é‡Š"></a>01 åè¯è§£é‡Š</h3><p>âœ”ï¸<strong>event.stopPropagation ï¼š</strong>æ¯”è¾ƒå¸¸è§ï¼Œç”¨äºåœæ­¢å†’æ³¡ï¼Œé˜»æ­¢äº‹ä»¶åœ¨ DOM ä¸­ç»§ç»­å†’æ³¡ã€‚</p><p>âœ”ï¸<strong>event.stopImmediatePropagation:</strong> é˜»æ­¢ click äº‹ä»¶å†’æ³¡,å¹¶ä¸”é˜»æ­¢ p å…ƒç´ ä¸Šç»‘å®šçš„å…¶ä»– click äº‹ä»¶çš„äº‹ä»¶ç›‘å¬å‡½æ•°çš„æ‰§è¡Œ.</p><h3 id="02-å®è·µå°ä¾‹å­"><a href="#02-å®è·µå°ä¾‹å­" class="headerlink" title="02 å®è·µå°ä¾‹å­"></a>02 å®è·µå°ä¾‹å­</h3><p>ğŸ’» åŠ¨åŠ¨å°æ‰‹å®è·µä¸‹,æœ‰åŠ©äºç†è§£å“¦â€¦</p><p>// æ‘˜è‡ª MDN</p><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span><br><span class="language-css">      <span class="hljs-selector-tag">p</span> &#123;</span><br><span class="language-css">        <span class="hljs-attribute">height</span>: <span class="hljs-number">30px</span>;</span><br><span class="language-css">        <span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;</span><br><span class="language-css">        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ccf</span>;</span><br><span class="language-css">      &#125;</span><br><span class="language-css">      <span class="hljs-selector-tag">div</span> &#123;</span><br><span class="language-css">        <span class="hljs-attribute">height</span>: <span class="hljs-number">30px</span>;</span><br><span class="language-css">        <span class="hljs-attribute">width</span>: <span class="hljs-number">150px</span>;</span><br><span class="language-css">        <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#cfc</span>;</span><br><span class="language-css">      &#125;</span><br><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>paragraph<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">      <span class="hljs-keyword">const</span> p = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;p&#x27;</span>)</span><br><span class="language-javascript">      p.<span class="hljs-title function_">addEventListener</span>(</span><br><span class="language-javascript">        <span class="hljs-string">&#x27;click&#x27;</span>,</span><br><span class="language-javascript">        <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;</span><br><span class="language-javascript">          <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;æˆ‘æ˜¯på…ƒç´ ä¸Šè¢«ç»‘å®šçš„ç¬¬ä¸€ä¸ªç›‘å¬å‡½æ•°&#x27;</span>)</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-literal">false</span></span><br><span class="language-javascript">      )</span><br><span class="language-javascript"></span><br><span class="language-javascript">      p.<span class="hljs-title function_">addEventListener</span>(</span><br><span class="language-javascript">        <span class="hljs-string">&#x27;click&#x27;</span>,</span><br><span class="language-javascript">        <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;</span><br><span class="language-javascript">          <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;æˆ‘æ˜¯på…ƒç´ ä¸Šè¢«ç»‘å®šçš„ç¬¬äºŒä¸ªç›‘å¬å‡½æ•°&#x27;</span>)</span><br><span class="language-javascript">          event.<span class="hljs-title function_">stopImmediatePropagation</span>()</span><br><span class="language-javascript">          <span class="hljs-comment">// æ‰§è¡ŒstopImmediatePropagationæ–¹æ³•,é˜»æ­¢clickäº‹ä»¶å†’æ³¡,å¹¶ä¸”é˜»æ­¢på…ƒç´ ä¸Šç»‘å®šçš„å…¶ä»–clickäº‹ä»¶çš„äº‹ä»¶ç›‘å¬å‡½æ•°çš„æ‰§è¡Œ.</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-literal">false</span></span><br><span class="language-javascript">      )</span><br><span class="language-javascript"></span><br><span class="language-javascript">      p.<span class="hljs-title function_">addEventListener</span>(</span><br><span class="language-javascript">        <span class="hljs-string">&#x27;click&#x27;</span>,</span><br><span class="language-javascript">        <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;</span><br><span class="language-javascript">          <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;æˆ‘æ˜¯på…ƒç´ ä¸Šè¢«ç»‘å®šçš„ç¬¬ä¸‰ä¸ªç›‘å¬å‡½æ•°&#x27;</span>)</span><br><span class="language-javascript">          <span class="hljs-comment">// è¯¥ç›‘å¬å‡½æ•°æ’åœ¨ä¸Šä¸ªå‡½æ•°åé¢ï¼Œè¯¥å‡½æ•°ä¸ä¼šè¢«æ‰§è¡Œ</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-literal">false</span></span><br><span class="language-javascript">      )</span><br><span class="language-javascript"></span><br><span class="language-javascript">      <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;div&#x27;</span>).<span class="hljs-title function_">addEventListener</span>(</span><br><span class="language-javascript">        <span class="hljs-string">&#x27;click&#x27;</span>,</span><br><span class="language-javascript">        <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> &#123;</span><br><span class="language-javascript">          <span class="hljs-title function_">alert</span>(<span class="hljs-string">&#x27;æˆ‘æ˜¯divå…ƒç´ ,æˆ‘æ˜¯på…ƒç´ çš„ä¸Šå±‚å…ƒç´ &#x27;</span>)</span><br><span class="language-javascript">          <span class="hljs-comment">// på…ƒç´ çš„clickäº‹ä»¶æ²¡æœ‰å‘ä¸Šå†’æ³¡ï¼Œè¯¥å‡½æ•°ä¸ä¼šè¢«æ‰§è¡Œ</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-literal">false</span></span><br><span class="language-javascript">      )</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></div></td></tr></table></figure><h3 id="03-é¡¹ç›®åº”ç”¨åœºæ™¯"><a href="#03-é¡¹ç›®åº”ç”¨åœºæ™¯" class="headerlink" title="03 é¡¹ç›®åº”ç”¨åœºæ™¯"></a>03 é¡¹ç›®åº”ç”¨åœºæ™¯</h3><p><strong>åœºæ™¯ï¼š</strong></p><img src="https://s2.loli.net/2022/03/18/Dw9e2YEbGOsHrTB.png" alt="image-20220318184706337" style="zoom: 50%;" /><p>éœ€æ±‚å°±æ˜¯ç‚¹å‡» <code>â€œESCâ€</code> å…³é—­æ–°å»ºçš„é‚£ä¸ªæ¡†æ¡†ï¼Œ<code>event.stopImmediatePropagation()</code> å¯ä»¥é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œä»¥åŠé˜»æ­¢å…¶ä»–çš„ç»‘å®šäº‹ä»¶çš„æ‰§è¡Œã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>React é•¿åˆ—è¡¨æ€§èƒ½ä¼˜åŒ– -- react-window</title>
    <link href="/2022/03/28/React%20%E9%95%BF%E5%88%97%E8%A1%A8%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%20--%20react-window/"/>
    <url>/2022/03/28/React%20%E9%95%BF%E5%88%97%E8%A1%A8%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%20--%20react-window/</url>
    
    <content type="html"><![CDATA[<h2 id="React-é•¿åˆ—è¡¨æ€§èƒ½ä¼˜åŒ–-â€“-react-window"><a href="#React-é•¿åˆ—è¡¨æ€§èƒ½ä¼˜åŒ–-â€“-react-window" class="headerlink" title="React é•¿åˆ—è¡¨æ€§èƒ½ä¼˜åŒ– â€“ react-window"></a>React é•¿åˆ—è¡¨æ€§èƒ½ä¼˜åŒ– â€“ react-window</h2><blockquote><p>å‡å¦‚æœ‰ä¸€å¤©ï¼Œä½ é‡åˆ°ä¸€ä¸ªéå¸¸å˜æ€çš„éœ€æ±‚æˆ–è€…ä¸€ä¸ªä¸ä¼šåˆ†é¡µçš„åç«¯ â€“ å‰ç«¯æ‹¿åˆ° 1W+æ¡æ•°æ®æ—¶ï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿæµè§ˆå™¨æ€§èƒ½æ˜¯æœ‰é™çš„çš„ï¼ŒæŠŠ 1w+æ¡æ•°æ®æ¸²æŸ“åˆ°é¡µé¢ï¼Œéå¸¸å®¹æ˜“é€ æˆé¡µé¢å¡é¡¿ï¼Œå¯¼è‡´ç”¨æˆ·ä½“éªŒä¸ä½³ã€‚ğŸ¤·â€â™€ï¸</p></blockquote><h3 id="01-å¸¸è§çš„è§£å†³æ–¹æ¡ˆ"><a href="#01-å¸¸è§çš„è§£å†³æ–¹æ¡ˆ" class="headerlink" title="01 å¸¸è§çš„è§£å†³æ–¹æ¡ˆ"></a>01 å¸¸è§çš„è§£å†³æ–¹æ¡ˆ</h3><p>1.æ‡’åŠ è½½</p><p>æ–¹å¼ï¼šé€šè¿‡ç›‘å¬åˆ—è¡¨çš„æ»šåŠ¨ï¼Œæ¯å½“ç”¨æˆ·æ»šåŠ¨åˆ°åˆ—è¡¨åº•éƒ¨çš„æ—¶å€™ï¼Œè¿›è¡ŒåŠ è½½åé¢çš„æ•°æ®è¿½åŠ æ¸²æŸ“åˆ° DOM ä¸Šã€‚</p><p>ç¼ºç‚¹ï¼šå½“ç”¨æˆ·ä¸€ç›´å‘ä¸‹åˆ’ï¼Œé¡µé¢ä¾ç„¶ä¼šäº§ç”Ÿå¤§é‡ DOM å…ƒç´ ï¼Œå ç”¨å†…å­˜è¿‡å¤šï¼Œå¯¼è‡´é¡µé¢å¡é¡¿ã€‚</p><p>2.è™šæ‹Ÿåˆ—è¡¨</p><p>æ–¹å¼ï¼šå…¶æ ¸å¿ƒæ€è·¯ï¼Œæ¸²æŸ“é•¿åˆ—è¡¨æ—¶ï¼Œæ¯æ¬¡åªæ¸²æŸ“å¯è§†åŒºåŸŸçš„åˆ—è¡¨æ•°ã€‚</p><h3 id="02-è™šæ‹Ÿåˆ—è¡¨æŠ€æœ¯"><a href="#02-è™šæ‹Ÿåˆ—è¡¨æŠ€æœ¯" class="headerlink" title="02 è™šæ‹Ÿåˆ—è¡¨æŠ€æœ¯"></a>02 è™šæ‹Ÿåˆ—è¡¨æŠ€æœ¯</h3><blockquote><p>å¸¸è§è™šæ‹Ÿåˆ—è¡¨æŠ€æœ¯ react-window å’Œ react-virtualized ï¼Œæœ‰ä»€ä¹ˆä¸åŒå‘¢?</p></blockquote><p>è¿™ä¸¤ä¸ªåº“éƒ½å‡ºè‡ªä¸€ä¸ªä½œè€…ï¼Œ<code>react-window</code> æ˜¯å¯¹ <code>react-virtualized</code> çš„é‡å†™ï¼Œè‡³äºä¸ºå•¥é‡å†™å‘¢ï¼Ÿä½œè€…ç»™å‡ºçš„è§£é‡Šæ˜¯ï¼Œ<code>react-virtualized</code> è€ƒè™‘æƒ…å†µå¤ªå¤šï¼Œå¢åŠ äº†å¤ªå¤šçš„éåŸºæœ¬åŠŸèƒ½å’Œç»„ä»¶ã€‚åˆ é™¤è¿™äº›åŠŸèƒ½ä¼šå¯¼è‡´ä¹‹å‰ä½¿ç”¨çš„å¼€å‘è€…ç—›è‹¦é¢å…· ğŸ¤¯ï¼Œæ‰€ä»¥å°±é‡å†™äº†ã€‚</p><p><a href="https://github.com/bvaughn/react-window">react-window</a> æ›´åŠ å…³æ³¨ <strong>smaller</strong>1 and <strong>faster</strong>ã€‚</p><h3 id="03-react-window-å°è¯•"><a href="#03-react-window-å°è¯•" class="headerlink" title="03 react-window å°è¯•"></a>03 react-window å°è¯•</h3><p>Hereâ€™s a <a href="https://codesandbox.io/s/bvaughn-react-window-fixed-size-list-vertical-forked-7xp7qn?file=/index.js:211-216">CodeSandbox</a></p><p>ä¸Šé¢è¿™å—æ˜¯æ¯”è¾ƒåŸºæœ¬çš„ä½¿ç”¨ï¼Œæˆ‘æ‰“ç®—å‚è€ƒ <code>react-window</code> çš„åŸç†ï¼Œå»å®ç°è¿™ä¸ªéœ€æ±‚ã€‚</p><p><img src="https://s2.loli.net/2022/03/21/t48I7q9rUbwOYEK.png" alt="image-20220321182310892"></p><p>ä»Šå¤©æš‚æ—¶è¿˜æ²¡ç ”ç©¶é€ï¼Œæ˜å¤©å®è·µä¸‹å†è¿›è¡Œè¡¥å……ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
    </categories>
    
    
    <tags>
      
      <tag>React</tag>
      
      <tag>æ€§èƒ½ä¼˜åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>useCallback å’Œ useMemo çš„åŒºåˆ«</title>
    <link href="/2022/03/28/useCallback%20%E5%92%8C%20useMemo%20%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F/"/>
    <url>/2022/03/28/useCallback%20%E5%92%8C%20useMemo%20%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F/</url>
    
    <content type="html"><![CDATA[<h2 id="useCallback-å’Œ-useMemo-çš„åŒºåˆ«"><a href="#useCallback-å’Œ-useMemo-çš„åŒºåˆ«" class="headerlink" title="useCallback å’Œ useMemo çš„åŒºåˆ«"></a>useCallback å’Œ useMemo çš„åŒºåˆ«</h2><blockquote><p>å‰è¨€ï¼Œåˆšçœ‹å®˜æ–¹æ–‡æ¡£çš„æ—¶å€™ã€‚ä¹Ÿè®¸ä¼šè§‰å¾—ä»–ä»¬å¾ˆåƒï¼Œæˆ–è€…è®¤ä¸º<code>useCallback</code> æ˜¯ <code>useMemo</code>çš„è¯­æ³•ç³– ğŸ¬</p><p>å…¶å®ä¸ç„¶ï¼Œä»–ä»¬è™½ç„¶è¯´éƒ½æ˜¯ â€œæ€§èƒ½ä¼˜åŒ–â€ çš„æ‰‹æ®µï¼Œä»–ä»¬çš„ç”¨æ³•å’Œå…³æ³¨å±‚é¢è¿˜æ˜¯æœ‰ç‚¹ä¸ä¸€æ ·</p></blockquote><h3 id="01-useCallback"><a href="#01-useCallback" class="headerlink" title="01 useCallback"></a>01 useCallback</h3><p><strong>ç”¨æ³•ï¼š</strong></p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> memoizedCallback = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-title function_">doSomething</span>(a, b)<br>&#125;, [a, b])<br></code></pre></div></td></tr></table></figure><p><code>useCallback(fn, deps)</code> ç›¸å½“äº <code>useMemo(() =&gt; fn, deps)</code></p><p><strong>å…³æ³¨ï¼š</strong></p><p><code>useCallback</code> ä¸€èˆ¬ç”¨äºå‡½æ•°æ›´æ–°ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„æ–¹æ³•</p><h3 id="02-useMemo"><a href="#02-useMemo" class="headerlink" title="02 useMemo"></a>02 useMemo</h3><p><strong>ç”¨æ³•ï¼š</strong></p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> memoizedValue = <span class="hljs-title function_">useMemo</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">computeExpensiveValue</span>(a, b), [a, b])<br></code></pre></div></td></tr></table></figure><p><strong>å…³æ³¨ï¼š</strong></p><p><code>useMemo</code> ä¸€èˆ¬ç”¨äºç»„ä»¶ä¸­å˜é‡ï¼Œè¿”å›å˜é‡å€¼</p>]]></content>
    
    
    <categories>
      
      <category>hook</category>
      
    </categories>
    
    
    <tags>
      
      <tag>React</tag>
      
      <tag>hook</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è‡ªå®šä¹‰ Hook å’Œ å°è£…ç»„ä»¶</title>
    <link href="/2022/03/28/%E8%87%AA%E5%AE%9A%E4%B9%89%20hooks%20%E5%92%8C%20%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6/"/>
    <url>/2022/03/28/%E8%87%AA%E5%AE%9A%E4%B9%89%20hooks%20%E5%92%8C%20%E5%B0%81%E8%A3%85%E7%BB%84%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<h2 id="è‡ªå®šä¹‰-Hook-å’Œ-å°è£…ç»„ä»¶"><a href="#è‡ªå®šä¹‰-Hook-å’Œ-å°è£…ç»„ä»¶" class="headerlink" title="è‡ªå®šä¹‰ Hook å’Œ å°è£…ç»„ä»¶"></a>è‡ªå®šä¹‰ Hook å’Œ å°è£…ç»„ä»¶</h2><blockquote><p>å‰è¨€ï¼š</p><p><em>Hook</em> æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ã€‚å®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§ã€‚</p></blockquote><h3 id="01-è‡ªå®šä¹‰-Hook"><a href="#01-è‡ªå®šä¹‰-Hook" class="headerlink" title="01 è‡ªå®šä¹‰ Hook"></a>01 è‡ªå®šä¹‰ Hook</h3><blockquote><p>é€šè¿‡è‡ªå®šä¹‰ Hookï¼Œå¯ä»¥å°†ç»„ä»¶é€»è¾‘æå–åˆ°å¯é‡ç”¨çš„å‡½æ•°ä¸­ã€‚ä½¿å¾—ä¸€äº›å…¬å…±é€»è¾‘å¯ä»¥ä»é¡¹ç›®ä¸­è§£è€¦å‡ºæ¥ï¼Œä¸ä»…é¡¹ç›®å…¶ä»–åœ°æ–¹ä¸­ä½¿ç”¨ï¼Œè¿˜ä»¥æä¾›ç»™ç¤¾åŒº ğŸ’»ã€‚</p></blockquote><p>ä¸€èˆ¬ä»¥ â€œ<code>use</code>â€ å‘½åå¼€å¤´ï¼Œè¿™ä¸ªæ˜¯çº¦æŸã€‚ä¹Ÿæ˜¯ä¸ºäº†è®© React å¸®æˆ‘ä»¬æ›´å¥½åœ°æ£€æŸ¥æ˜¯å¦ç¬¦åˆ <code>Hook</code> è§„åˆ™ã€‚</p><p>ä¸€èˆ¬æ”¾åœ¨é¡¹ç›®çš„ <code>hooks</code> æ–‡ä»¶ä¸‹</p><p>âœï¸<strong>å…³äºè‡ªå®šä¹‰ <code>Hook</code> çš„å°è£…ï¼š</strong></p><p>a.ä¸é¡¹ç›®é€»è¾‘è§£è€¦ï¼ŒæŠ½ç¦»å‡ºå…¬å…±é€»è¾‘</p><p>b.å°½é‡ä¸è¶Šç•Œã€ä¸æ¶‰åŠåˆ° UIï¼Œåªå…³æ³¨é€»è¾‘</p><p>c.å¤–éƒ¨ä½¿ç”¨ï¼Œåšåˆ°åªè€ƒè™‘ <code>è¾“å…¥</code> å’Œ <code>è¾“å‡º </code>, æ— å…³ä¹å†…éƒ¨å®ç°</p><p>æ¨èä¸€ä¸ªå¼ºå¤§çš„ <strong>hooks åº“ â€”</strong><a href="https://ahooks.js.org/"><strong>ahook</strong></a></p><h3 id="02-å°è£…ç»„ä»¶"><a href="#02-å°è£…ç»„ä»¶" class="headerlink" title="02 å°è£…ç»„ä»¶"></a>02 å°è£…ç»„ä»¶</h3><blockquote><p>å°è£…ç»„ä»¶ï¼Œå®ƒå’Œè‡ªå®šä¹‰ Hookï¼Œéƒ½ç”¨åˆ°å‡½æ•°ç»„ä»¶ï¼Œä½†æ˜¯å®ƒæ›´åŠ å…³æ³¨ UI å±‚æ¸²æŸ“ã€‚</p></blockquote><p>ä¸€èˆ¬æ”¾åœ¨é¡¹ç›®çš„ <code>components</code> æ–‡ä»¶ä¸‹</p><p>âœï¸<strong>å…³äº<code>å°è£…ç»„ä»¶</code>ï¼š</strong></p><p>a. æ›´åŠ å…³æ³¨ UI å±‚çš„æ¸²æŸ“ï¼Œæ³¨é‡è€ƒè™‘å¤ç”¨æ€§</p><p>b.åœ¨è®¾è®¡ç»„ä»¶æ—¶ï¼Œå¤šæ–¹é¢å’Œå¤šç»´åº¦è€ƒè™‘ï¼Œç»„ä»¶å¯æ‰©å±•æ€§</p><p>c.æ ·å¼çš„ä¸°å¯Œæ€§ï¼Œé«˜åº¦å¯å†å®šåˆ¶æ€§</p>]]></content>
    
    
    <categories>
      
      <category>hook</category>
      
    </categories>
    
    
    <tags>
      
      <tag>React</tag>
      
      <tag>hook</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å“åº”å¼å¸ƒå±€å°å®è·µ --Rem å’Œåª’ä½“æŸ¥è¯¢</title>
    <link href="/2022/03/28/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%B8%83%E5%B1%80%E5%B0%8F%E5%AE%9E%E8%B7%B5%20--Rem%20%E5%92%8C%E5%AA%92%E4%BD%93%E6%9F%A5%E8%AF%A2/"/>
    <url>/2022/03/28/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%B8%83%E5%B1%80%E5%B0%8F%E5%AE%9E%E8%B7%B5%20--Rem%20%E5%92%8C%E5%AA%92%E4%BD%93%E6%9F%A5%E8%AF%A2/</url>
    
    <content type="html"><![CDATA[<h2 id="å“åº”å¼å¸ƒå±€å°å®è·µ-â€“Rem-å’Œåª’ä½“æŸ¥è¯¢"><a href="#å“åº”å¼å¸ƒå±€å°å®è·µ-â€“Rem-å’Œåª’ä½“æŸ¥è¯¢" class="headerlink" title="å“åº”å¼å¸ƒå±€å°å®è·µ â€“Rem å’Œåª’ä½“æŸ¥è¯¢"></a>å“åº”å¼å¸ƒå±€å°å®è·µ â€“Rem å’Œåª’ä½“æŸ¥è¯¢</h2><blockquote><p>å‰è¨€ï¼šä¸‹åˆæ£é¼“äº†ä¸‹ï¼Œçœ‹äº†å¾ˆå¤šè§£å†³ç§»åŠ¨ç«¯è‡ªé€‚åº”çš„æ–¹æ¡ˆï¼Œå¤§å¤šä»¥ Rem å’Œåª’ä½“æŸ¥è¯¢ä½œä¸ºä¸»æµè§£å†³æ–¹æ¡ˆã€‚å¦å¤– CSS3 çš„ flex å’Œ Grid ä¹Ÿæ˜¯ä¸æˆ³çš„å¸ƒå±€è§£å†³æ–¹æ¡ˆã€‚</p></blockquote><h3 id="01-âœ”ï¸Rem-åª’ä½“æŸ¥è¯¢"><a href="#01-âœ”ï¸Rem-åª’ä½“æŸ¥è¯¢" class="headerlink" title="01 âœ”ï¸Rem / åª’ä½“æŸ¥è¯¢"></a>01 âœ”ï¸Rem / åª’ä½“æŸ¥è¯¢</h3><p>é€šä¿—ä¸€ç‚¹è¯´ï¼Œ<strong>Rem</strong> æ˜¯æ ¹æ® <code>&lt;Html&gt;</code> æ ·å¼çš„ <code>font-size</code> æ¥è®¡ç®—ç›¸å¯¹å¤§å°çš„ï¼Œæ¯”å¦‚è¯´ï¼Œ<code>&lt;Html&gt;</code> çš„ <code>font-size=16px</code>(é»˜è®¤)ï¼Œé‚£ä¹ˆå°±æ˜¯ç›¸å½“äº <code>1rem=16px </code> ã€‚å½“ç„¶<code>&lt;Html&gt;</code>çš„<code>font-size</code>æ˜¯å¯ä»¥è‡ªè¡Œè®¾ç½®çš„ã€‚</p><p>**<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/Media_Queries/Using_media_queries">åª’ä½“æŸ¥è¯¢</a>**ï¼Œå…·ä½“å¯ä»¥çœ‹ä¸‹å®˜æ–¹æ–‡æ¡£ï¼Œè¿™è¾¹ä¸»è¦è®²ä¸‹å®ƒçš„å¸¸è§„ä½¿ç”¨ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// å¸¸è§è®¾å¤‡çš„åª’ä½“æŸ¥è¯¢</span><br>@media screen and (max-<span class="hljs-attr">width</span>: 1160px)<br>@media screen and (max-<span class="hljs-attr">width</span>: 820px)ipad <span class="hljs-title class_">Air</span><br>@media screen and (max-<span class="hljs-attr">width</span>: 768px)ipad mini<br>@media screen and (max-<span class="hljs-attr">width</span>: 390px)iphone 12pro<br></code></pre></div></td></tr></table></figure><h3 id="02-âœ”ï¸-å®è·µ"><a href="#02-âœ”ï¸-å®è·µ" class="headerlink" title="02 âœ”ï¸ å®è·µ"></a>02 âœ”ï¸ å®è·µ</h3><p><strong>æ€è·¯ï¼š</strong></p><ol><li><p>åœ¨å“åº”å¼å¸ƒå±€ä¸­ï¼Œå¿…é¡»é€šè¿‡<code>js</code>æ¥åŠ¨æ€æ§åˆ¶æ ¹å…ƒç´ <code>font-size</code>çš„å¤§å°ã€‚<code>( ç”¨æˆ·è®¾å¤‡å®½åº¦ / è®¾è®¡ç¨¿æ ‡å‡†å®½åº¦ ) * 100</code></p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// è¿™è¾¹å°è£…æˆä¸€ä¸ª hook</span><br><span class="hljs-keyword">import</span> &#123; useCallback, useEffect &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">useMobileRem</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> inMobile = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">&#x27;html&#x27;</span>)[<span class="hljs-number">0</span>].<span class="hljs-property">style</span>.<span class="hljs-property">fontSize</span> =<br>      (<span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>.<span class="hljs-property">clientWidth</span> / <span class="hljs-number">1920</span>) * <span class="hljs-number">100</span> + <span class="hljs-string">&#x27;px&#x27;</span><br>  &#125;, [])<br><br>  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;DOMContentLoaded&#x27;</span>, inMobile)<br>    <span class="hljs-variable language_">window</span>.<span class="hljs-property">onresize</span> = inMobile<br>    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">&#x27;DOMContentLoaded&#x27;</span>, inMobile)<br>    &#125;<br>  &#125;, [inMobile])<br>&#125;<br></code></pre></div></td></tr></table></figure></li><li><p>é€šè¿‡<strong>åª’ä½“æŸ¥è¯¢</strong>çš„æ–¹å¼ï¼Œè‹¥å½“å‰è®¾å¤‡å®½åº¦å°äºæŸä¸ªå€¼æ—¶ï¼Œé‡‡ç”¨<code>rem</code>å•ä½çš„å¸ƒå±€ã€‚</p></li></ol><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// æ ¹æ®äº§å“éœ€æ±‚ï¼Œå»ç¼–å†™ä¸åŒå±å¹•çš„æ ·å¼</span><br>@media (min-<span class="hljs-attr">width</span>: 30em) and (max-<span class="hljs-attr">width</span>: 50em) &#123; ... &#125;<br></code></pre></div></td></tr></table></figure><h3 id="03-FAQ"><a href="#03-FAQ" class="headerlink" title="03 FAQ"></a>03 FAQ</h3><p>â“ï¼špxã€rem å’Œ em çš„åŒºåˆ«ï¼Ÿ</p><p>ğŸ’»ï¼š<strong>px</strong>æ˜¯å›ºå®šçš„åƒç´ ï¼Œæ˜¯ç›¸å¯¹äºæ˜¾ç¤ºå™¨å±å¹•åˆ†è¾¨ç‡è€Œè¨€çš„ã€‚<strong>em</strong>ã€<strong>rem</strong> å¯¹äº <strong>px <strong>æ›´å…·æœ‰çµæ´»æ€§ï¼Œä»–ä»¬æ˜¯ç›¸å¯¹é•¿åº¦å•ä½ï¼Œ</strong>em</strong> æ˜¯ç›¸å¯¹äºçˆ¶å…ƒç´ çš„å•ä½ï¼Œ<strong>rem</strong> (<strong>root em</strong> )æ˜¯ç›¸å¯¹æ ¹å…ƒç´ çš„é•¿åº¦ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç§»åŠ¨ç«¯å…¼å®¹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Rem</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Gird ç½‘æ ¼å¸ƒå±€</title>
    <link href="/2022/03/28/Gird%20%E7%BD%91%E6%A0%BC%E5%B8%83%E5%B1%80/"/>
    <url>/2022/03/28/Gird%20%E7%BD%91%E6%A0%BC%E5%B8%83%E5%B1%80/</url>
    
    <content type="html"><![CDATA[<h2 id="Gird-ç½‘æ ¼å¸ƒå±€"><a href="#Gird-ç½‘æ ¼å¸ƒå±€" class="headerlink" title="Gird ç½‘æ ¼å¸ƒå±€"></a>Gird ç½‘æ ¼å¸ƒå±€</h2><blockquote><p>å‰è¨€ï¼šæ˜¨å¤©ä¸ºäº†è§£å†³æ …æ ¼å¸ƒå±€ï¼Œèµ°äº†å¾ˆå¤šå¼¯è·¯ã€‚ä»Šå¤©çªç„¶çœ‹åˆ°é˜®ä¸€å³°è€å¸ˆ<a href="https://www.ruanyifeng.com/blog/2019/03/grid-layout-tutorial.html">å…³äº Grid çš„æ–‡ç« </a>è®©æˆ‘å‘ç°äº†æ–°å¤§é™†ï¼ŒU1S1 é˜®è€å¸ˆå†™çš„æ–‡ç« çœŸçš„é€šä¿—æ˜“æ‡‚ã€‚åŠªåŠ›å‘é˜®è€å¸ˆçœ‹é½ï¼Œå¸Œæœ›è‡ªå·±æ–‡ç« ä»¥åä¹Ÿå¯ä»¥è¢«ç§°èµï¼ï¼è¯ä¸å¤šè¯´ï¼Œæ¥å¹²è´§ï¼</p></blockquote><h3 id="01-ç½‘æ ¼å¸ƒå±€"><a href="#01-ç½‘æ ¼å¸ƒå±€" class="headerlink" title="01 ç½‘æ ¼å¸ƒå±€"></a>01 ç½‘æ ¼å¸ƒå±€</h3><p>ä¹‹å‰çš„æˆ‘ä¸€ç›´éƒ½æ˜¯ç”¨ <code>Flex</code> å¼¹æ€§å¸ƒå±€ï¼Œè§‰å¾—æ‹¥æœ‰ <code>Flex</code>, è¿™å¤©ä¸‹å°±æ²¡æœ‰æˆ‘å¸ƒä¸äº†çš„å±€ã€‚ç›´åˆ°æˆ‘å‘ç°äº† <code>Grid</code>,æ˜¯çœŸçš„æ–¹ä¾¿ï¼Œéš¾æ€ªå„å„ UI æ¡†æ¶ï¼Œéƒ½ä¼šçœ‹åˆ°ä¸€ä¸ªå«åš <code>Grid</code> å¸ƒå±€ã€‚</p><p><strong>ç½‘æ ¼å¸ƒå±€</strong>ï¼Œ é¡¾åæ€ä¹‰æ˜¯ç±»ä¼¼ç½‘æ ¼ä¸€æ ·çš„å¸ƒå±€ï¼ˆæˆ‘å¥½åƒè¯´äº†ä¸€å¥åºŸè¯ï¼‰ã€‚ä¸ºäº†ä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿ<code>Gird</code> æ˜¯äºŒç»´å¸ƒå±€ï¼Œå®ƒå°†å®¹å™¨ç”¨ â€œ<strong>è¡Œ</strong>â€ å’Œ â€œ<strong>åˆ—</strong>â€åˆ’åˆ†ï¼Œè€Œä¸€ä¸ªä¸€ä¸ªæ ¼å­ç§°ä½œä¸ºå•å…ƒæ ¼ã€‚å‰é¢è¯´åˆ° <code>Flex</code> æ›´åƒæ˜¯ä¸€ç»´å¸ƒå±€ã€‚</p><h3 id="02-é€‚ç”¨åœºæ™¯"><a href="#02-é€‚ç”¨åœºæ™¯" class="headerlink" title="02 é€‚ç”¨åœºæ™¯"></a>02 é€‚ç”¨åœºæ™¯</h3><p><strong>è¯­æ³•æ–¹é¢</strong>ï¼Œäººå®¶é˜®è€å¸ˆå·²ç»è®²å¾ˆè¯¦ç»†äº†ï¼Œè¿™è¾¹å·ä¸ªæ‡’ã€‚è®²ä¸¤ä¸ªå¸¸è§çš„ä½¿ç”¨åœºæ™¯ï¼š</p><p>a. å‡å¦‚åšä¸ªå•†åŸåˆ—è¡¨ï¼Œéœ€è¦é‚£ç§æ’æ’åˆ—åˆ—å¾ˆæ•´é½é‚£ç§ï¼Œè¿˜éœ€è¦è‡ªé€‚åº”ä¸¤è¾¹çš„ç•™ç™½ã€‚</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.container</span> &#123;<br>  <span class="hljs-attribute">display</span>: grid;<br>  <span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-built_in">repeat</span>(auto-fill, <span class="hljs-number">180px</span>);<br>  <span class="hljs-attribute">justify-content</span>: space-evenly;<br>  <span class="hljs-attribute">grid-gap</span>: <span class="hljs-number">10px</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><img src="https://s2.loli.net/2022/03/25/ZB6RuVos9bn51wm.png" alt="image-20220325001113432" style="zoom:25%;" /><p>b. ä¸€èˆ¬ç½‘é¡µé¡µå¤´ï¼Œåˆ†æˆä¸‰éƒ¨åˆ†ï¼Œåˆ†åˆ«ä¸º logoã€ä¸­é—´åŒºåŸŸï¼ˆå„ä¸ªå…¥å£ï¼‰ã€å³ä¾§åŒºåŸŸï¼ˆç™»å½•ã€è¾“å…¥æ¡†ï¼‰ï¼Œä¸€èˆ¬è¿™ç§éƒ½æ˜¯ä¸¤è¾¹å›ºå®šï¼Œä¸­é—´åŒºåŸŸè‡ªé€‚åº”ã€‚</p><figure class="highlight css"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs css"><span class="hljs-selector-class">.container</span> &#123;<br> <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;<br>    <span class="hljs-attribute">display</span>: grid;<br>    <span class="hljs-attribute">grid-template-columns</span>: <span class="hljs-number">200px</span> auto <span class="hljs-number">200px</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p><img src="https://s2.loli.net/2022/03/25/wsiYIxCnFlHtkqu.png" alt="image-20220325001325658"></p>]]></content>
    
    
    <categories>
      
      <category>CSS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CSS</tag>
      
      <tag>layoutå¸ƒå±€</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¬è¯´ä½ è¿˜ä¸ä¼šâ€œè™šæ‹Ÿåˆ—è¡¨â€ï¼Œå¯¹ä¸èµ·æˆ‘æ¥æ™šäº†</title>
    <link href="/2022/03/28/%E5%90%AC%E8%AF%B4%E4%BD%A0%E8%BF%98%E4%B8%8D%E4%BC%9A%E2%80%9C%E8%99%9A%E6%8B%9F%E5%88%97%E8%A1%A8%E2%80%9D%EF%BC%8C%E5%AF%B9%E4%B8%8D%E8%B5%B7%E6%88%91%E6%9D%A5%E6%99%9A%E4%BA%86/"/>
    <url>/2022/03/28/%E5%90%AC%E8%AF%B4%E4%BD%A0%E8%BF%98%E4%B8%8D%E4%BC%9A%E2%80%9C%E8%99%9A%E6%8B%9F%E5%88%97%E8%A1%A8%E2%80%9D%EF%BC%8C%E5%AF%B9%E4%B8%8D%E8%B5%B7%E6%88%91%E6%9D%A5%E6%99%9A%E4%BA%86/</url>
    
    <content type="html"><![CDATA[<h2 id="å¬è¯´ä½ è¿˜ä¸ä¼šâ€œè™šæ‹Ÿåˆ—è¡¨â€ï¼Œå¯¹ä¸èµ·æˆ‘æ¥æ™šäº†"><a href="#å¬è¯´ä½ è¿˜ä¸ä¼šâ€œè™šæ‹Ÿåˆ—è¡¨â€ï¼Œå¯¹ä¸èµ·æˆ‘æ¥æ™šäº†" class="headerlink" title="å¬è¯´ä½ è¿˜ä¸ä¼šâ€œè™šæ‹Ÿåˆ—è¡¨â€ï¼Œå¯¹ä¸èµ·æˆ‘æ¥æ™šäº†"></a>å¬è¯´ä½ è¿˜ä¸ä¼šâ€œè™šæ‹Ÿåˆ—è¡¨â€ï¼Œå¯¹ä¸èµ·æˆ‘æ¥æ™šäº†</h2><blockquote><p>å‰è¨€ï¼šä¸Šæ¬¡è¯´åˆ°è¦å®è·µ React- window , ä»Šå¤©ç»ˆäºå¯ä»¥è¿‡æ¥è¿˜å€ºè¾½ğŸ˜€ï¼ç ”ç©¶äº†è®¸ä¹…ï¼Œæ€»å…±æƒ³åˆ° 3 ç§æ–¹æ³•å®ç°å®ƒã€‚</p></blockquote><h3 id="01-ä»€ä¹ˆæ˜¯è™šæ‹Ÿåˆ—è¡¨â“"><a href="#01-ä»€ä¹ˆæ˜¯è™šæ‹Ÿåˆ—è¡¨â“" class="headerlink" title="01 ä»€ä¹ˆæ˜¯è™šæ‹Ÿåˆ—è¡¨â“"></a>01 ä»€ä¹ˆæ˜¯è™šæ‹Ÿåˆ—è¡¨â“</h3><p>å®ƒæ˜¯å½“ä¸‹è§£å†³é•¿åˆ—è¡¨æ•°æ®ï¼ˆ2wæ•°æ®é‡ï¼‰é«˜æ€§èƒ½è§£å†³æ–¹æ¡ˆï¼Œå®ƒçš„åŸç†ä¹Ÿéå¸¸é€šä¿—æ˜“æ‡‚ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œ2wæ•°æ®æˆ–è€…æ›´å¤šæ•°æ®è¦æ¸²æŸ“åˆ°åˆ—è¡¨æ˜¯éå¸¸è€—æ—¶ï¼Œä¸”æ»šåŠ¨èµ·æ¥éå¸¸å¡çš„ï¼Œæ€»è€Œè¨€ä¹‹ç”¨æˆ·ä½“éªŒéå¸¸å·®çš„ã€‚è€Œ<strong>è™šæ‹Ÿåˆ—è¡¨</strong>ï¼Œåªéœ€è¦æ¸²æŸ“å¯è§†åŒºåŸŸæ•°æ®ï¼Œå®ƒæå¤§å‡å°‘æ¸²æŸ“æ€§èƒ½çš„å¼€é”€ï¼Œæå‡äº†ç”¨æˆ·çš„ä½“éªŒã€‚</p><p><img src="https://s2.loli.net/2022/03/30/a82CqZIzxPlos63.png" alt="image.png"></p><h3 id="02-å®è·µèµ·æ¥ğŸ’»"><a href="#02-å®è·µèµ·æ¥ğŸ’»" class="headerlink" title="02  å®è·µèµ·æ¥ğŸ’»"></a>02  å®è·µèµ·æ¥ğŸ’»</h3><blockquote><p>è¿™è¾¹ä¸ºäº†æ–¹ä¾¿æ²¡æœ‰å­¦è¿‡æ¡†æ¶çš„å°ä¼™ä¼´ï¼Œæˆ‘ç”¨åŸç”Ÿçš„<code>Html</code>æ¥ç¼–å†™ï¼ŒåŒæ—¶ä¸Šä¼ åˆ°äº†åœ¨çº¿ç¼–è¾‘IDEé‡Œé¢ï¼Œå¯ä¾›å¤§å®¶å‚è€ƒ</p></blockquote><p><strong>a.  Position æ³•ï¼š</strong></p><blockquote><ul><li><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰å‡ ä¸ªå˜é‡</p><ul><li><p>startIndex:  ç”¨æˆ·å¯è§†åŒºåŸŸçš„ç¬¬ä¸€ä¸ªæ•°æ®é¡¹ï¼Œå‚è€ƒä¸Šå›¾å°±æ˜¯ <code>item8</code> </p></li><li><p>endIndex: ç”¨æˆ·å¯è§†åŒºåŸŸçš„æœ€åä¸€ä¸ªæ•°æ®é¡¹ï¼Œä¸Šå›¾çš„ <code>item15</code></p></li><li></li></ul></li></ul></blockquote><p>æˆ‘ä»¬åªå¯¹å¯è§†å±‚åšæ¸²æŸ“ï¼Œä½†æ˜¯ä¸ºäº†ä¿æŒæ•´ä¸ªå®¹å™¨åƒæ¸²æŸ“æ­£å¸¸é•¿åˆ—è¡¨ä¸€æ ·ï¼Œé‡Œé¢çš„å®¹å™¨è¿˜éœ€è¦ä¿æŒåŸæœ‰çš„é«˜åº¦ã€‚è¿™è¾¹æŠŠ <code>Html</code> è®¾è®¡è¿™æ ·</p><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- å¤–å±‚å®¹å™¨ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;vListContainer&quot;</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- å†…å±‚å®¹å™¨ --&gt;</span>  <br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;phantomContent&quot;</span>&gt;</span><br>    ...<br>    <span class="hljs-comment">&lt;!-- item-1 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- item-2 --&gt;</span><br>    <span class="hljs-comment">&lt;!-- item-3 --&gt;</span><br>    ....<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></div></td></tr></table></figure><ul><li><p>å…¶ä¸­ï¼Œ<code>vListContainer</code> å®¹å™¨æ ·å¼ä¸º<code>overflow-y: auto;</code>ï¼ˆå‡ºç°æ»šåŠ¨æ¡ï¼‰</p><ul><li><p><code>phantomContent</code> å®¹å™¨æ ·å¼ä¸º<code>position: relative</code> </p></li><li><p>å†…å®¹å™¨é‡Œé¢å­é¡¹ <code>item-n</code> æ ·å¼ä¸º <code>position: absolute</code></p></li><li><p>è®¾è®¡è¿™æ ·ï¼Œå°±æ˜¯ä¸ºäº†æ–¹ä¾¿é€šè¿‡<strong>ç›¸å¯¹å®šä½</strong>çš„æ–¹å¼ï¼ŒæŠŠ <code>item-n</code> æ¸²æŸ“åˆ°å¯è§†åŒºåŸŸå»ï¼ˆçµé­‚ğŸ‘Œï¼‰</p></li></ul></li><li><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ <code>vListContainer</code>  ç»‘å®š <strong>onScroll</strong> å‡½æ•°ï¼Œåˆ©ç”¨å…¶ <strong>scrollTop</strong> è®¡ç®—å‡º <code>startIndex</code> å’Œ <code>endIndex</code></p><p>è®¡ç®—ä¹‹å‰ï¼Œéœ€è¦çŸ¥é“ï¼š</p><ul><li><strong>rowHeight</strong> ï¼šå•é¡¹æ•°æ®çš„é«˜åº¦</li><li><strong>total</strong>ï¼š æ€»å…±æ•°æ®é‡</li><li><strong>height</strong>ï¼šå¯è§†çš„é«˜åº¦ï¼Œé€šè¿‡ <code>vListContainer</code> çš„ <strong>clientHeight</strong> å¯ä»¥æ‹¿åˆ°</li></ul></li><li><p>é€šè¿‡ä¸Šè¿°å˜é‡å°±å¯ä»¥è®¡ç®—å‡º ï¼š</p><ul><li>åˆ—è¡¨æ€»é«˜åº¦: <code>phantomHeight = total * rowHeight</code> è®¾ç½®å†…å±‚å®¹å™¨ <code>phantomContent </code>é«˜åº¦</li><li>å¯è§†èŒƒå›´å†…å±•ç¤ºå…ƒç´ æ•°ï¼š<code>limit = Math.ceil(height/rowHeight)</code></li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">onScroll</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">/* æ±‚å¾— startIndexï¼ŒendtIndex  */</span><br>    <span class="hljs-keyword">const</span> &#123; scrollTop &#125; = vListContainer;<br>    <span class="hljs-keyword">const</span> currentStartIndex = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(scrollTop / rowHeight);<br><br>    <span class="hljs-keyword">if</span> (currentStartIndex !== startIndex) &#123;<br>        startIndex = currentStartIndex;<br>        endtIndex = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(currentStartIndex + limit, total);<br>    &#125;<br>    <span class="hljs-comment">// startIndexï¼ŒendtIndex æ›´æ–°åï¼Œæ¸²æŸ“åˆ°å¯è§†åŒºåŸŸ</span><br>    <span class="hljs-title function_">renderDisplayContent</span>();<br>&#125;<br></code></pre></div></td></tr></table></figure><ul><li>å¾—åˆ°è¿™äº›å‚æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠæ•°æ®é¡¹æ¸²æŸ“åˆ°å¯è§†åŒºåŸŸå»è¾½ğŸ˜Š</li></ul><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">renderDisplayContent</span>(<span class="hljs-params"></span>) &#123;<br>    phantomContent.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = startIndex; i &lt;= endtIndex; i++) &#123;<br>        <span class="hljs-comment">// éå†æ•°æ®é¡¹ï¼Œå¹¶æ¸²æŸ“åˆ° DOM ä¸Š</span><br>        <span class="hljs-keyword">var</span> x = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;DIV&quot;</span>);<br>        x.<span class="hljs-property">style</span>.<span class="hljs-property">border</span> = <span class="hljs-string">&quot;1px solid #eee&quot;</span>;<br>        x.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">&quot;100%&quot;</span>;<br>        x.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">&quot;absolute&quot;</span>;<br>        <span class="hljs-comment">// è¿™å—å…³é”®ä»£ç ï¼Œé€šè¿‡ç»å¯¹å®šä½ï¼Œåƒé’‰å­ä¸€æ ·é’‰åœ¨å¯è§†åŒºåŸŸ</span><br>        x.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = i * rowHeight + <span class="hljs-string">&quot;px&quot;</span>;<br>        x.<span class="hljs-property">innerText</span> = i;<br>        phantomContent.<span class="hljs-title function_">appendChild</span>(x);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç„¶åå°±ä¼šå¾—åˆ°ä¸€ä¸ªç®€å•é«˜æ€§èƒ½çš„åˆ—è¡¨ â€”&gt; æ•ˆæœå›¾ğŸ’• </p><p><img src="https://s2.loli.net/2022/03/30/abYPShq7o3wHLmG.gif" alt="é«˜æ€§èƒ½é•¿åˆ—è¡¨æ•ˆæœå›¾.gif"></p><blockquote><p><strong>ç»“è®ºï¼š</strong>é€šè¿‡æ•ˆæœå›¾ï¼Œå¯ä»¥å¾ˆæ¸…æ™°çœ‹åˆ°ï¼Œ<code>DOM</code>åšåˆ°çœŸæ­£å¯æ¸²æŸ“å¯è§†åŒºçš„æ•°æ®é¡¹ï¼Œä» 2w â€“&gt; 20 ,æ€§èƒ½å¯è°“æ˜¯ç¿»äº†å¾ˆå¤šå€å‘¢ğŸ˜‰ã€‚è¿™è¾¹åªæ˜¯å®ç°ä¸€ä¸ªç®€å•é€ è½®å­ï¼Œå»ºè®®å¤§å®¶ä¸€å®šè¦åŠ¨æ‰‹ï¼Œèƒ½æ›´å¿«ä¸Šæ‰‹ã€‚å¦å¤– <code>React-window</code> å’Œ <code>react-virtualized</code> æ˜¯ç¤¾åŒºå°è£…å¥½çš„ï¼Œå½“ç„¶ï¼Œæœ‰ç°æˆæ˜¯æ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨ï¼Œä½†æ˜¯ä¸€å®šåŠ¨æ‰‹ï¼ŒçŸ¥è¯†æ‰æ˜¯å±äºæˆ‘ä»¬å˜šï¼ğŸ˜</p></blockquote><p><strong>çº¿ä¸ŠDemo:</strong> <a href="https://codesandbox.io/s/new-snowflake-bo42ol?file=/index.html">new-snowflake-bo42ol - CodeSandbox</a></p><blockquote><p><strong>ä¼˜åŒ–ï¼š</strong>ç°åœ¨æ¸²æŸ“çš„æ˜¯åªæ˜¯ç®€å•æ•°æ®é¡¹ï¼ŒçœŸæ­£åº”ç”¨åœºæ™¯ï¼Œå¯èƒ½æœ‰å›¾ç‰‡ï¼Œå„ç§æ–‡å­—ï¼Œæ¸²æŸ“èµ·æ¥å¯èƒ½ä¼šæœ‰å¡é¡¿ã€‚å¼•å…¥ <code>BufferSize</code>æ¦‚å¿µï¼Œç±»ä¼¼ç¼“å†²åŒºä¸€æ ·çš„ã€‚</p></blockquote><p><strong>ä¼˜åŒ–åçš„Demo:</strong><a href="https://codesandbox.io/s/cocky-montalcini-762v0x?file=/index.html">cocky-montalcini-762v0x - CodeSandbox</a></p><blockquote><p>å‰©ä¸‹ä¸¤ä¸ªæ–¹æ¡ˆï¼Œéƒ½å’Œä¸Šé¢å·®ä¸å¤šï¼Œåªæ˜¯å®ç°æ–¹å¼ä¸ä¸€æ ·ã€‚ä¸åšè¿‡å¤šè§£é‡Šï¼Œä¸¾ä¸€åä¸‰ã€‚çº¿ä¸ŠDemo æœ‰æ ‡æ³¨å…³é”®ä»£ç éƒ¨åˆ†</p></blockquote><p><strong>b. transform æ³•</strong></p><p><strong>å…³é”®æ€æƒ³ï¼š</strong> åˆ©ç”¨ <code>transform</code> yå±æ€§ï¼Œå»é€ æˆé‚£ç§åˆ’åŠ¨çš„æ•ˆæœ</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">renderDisplayContent</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">//------ å…³é”®ä»£ç éƒ¨åˆ† </span><br>    phantomContent.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">`translate3d(0px,<span class="hljs-subst">$&#123;startIndex * rowHeight&#125;</span>px,0px)`</span><br>    <span class="hljs-comment">//------</span><br>    phantomContent.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = startIndex; i &lt;= endtIndex; i++ )&#123;<br>        <span class="hljs-keyword">var</span> x = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;DIV&quot;</span>);<br>        x.<span class="hljs-property">style</span>.<span class="hljs-property">border</span> = <span class="hljs-string">&quot;1px solid #eee&quot;</span><br>        x.<span class="hljs-property">innerText</span> = i<br>        phantomContent.<span class="hljs-title function_">appendChild</span>(x)<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p><strong>çº¿ä¸ŠDemoï¼š</strong><a href="https://codesandbox.io/s/distracted-snowflake-v3400l?file=/index.html">distracted-snowflake-v3400l - CodeSandbox</a></p><p><strong>c. marginTop å’Œ marginBottom æ³•</strong></p><p><strong>å…³é”®æ€æƒ³ï¼š</strong> <strong>marginTop</strong> å’Œ <strong>marginBottom</strong> å»åˆ†åˆ«å¡«å……ï¼Œå¯è§†åŒºåŸŸçš„ <strong>ä¸Šé¢</strong> å’Œ <strong>ä¸‹é¢</strong>ã€‚ï¼ˆæœ‰å…´è¶£å¯ä»¥è¯•è¯• <strong>pandingTop</strong> å’Œ <strong>pandingBottom</strong>ï¼‰</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">renderDisplayContent</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-comment">//------å…³é”®ä»£ç éƒ¨åˆ†</span><br>        phantomContent.<span class="hljs-property">style</span>.<span class="hljs-property">marginTop</span> = rowHeight * startIndex + <span class="hljs-string">&quot;px&quot;</span>;<br>    <span class="hljs-comment">//------</span><br>        phantomContent.<span class="hljs-property">style</span>.<span class="hljs-property">marginBottom</span> =<br>          rowHeight * (total - endtIndex) + <span class="hljs-string">&quot;px&quot;</span>;<br>        phantomContent.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = startIndex; i &lt;= endtIndex; i++) &#123;<br>          <span class="hljs-keyword">var</span> x = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;DIV&quot;</span>);<br>          x.<span class="hljs-property">style</span>.<span class="hljs-property">border</span> = <span class="hljs-string">&quot;1px solid #eee&quot;</span>;<br>          x.<span class="hljs-property">innerText</span> = i;<br>          phantomContent.<span class="hljs-title function_">appendChild</span>(x);<br>        &#125;<br> &#125;<br></code></pre></div></td></tr></table></figure><p><strong>çº¿ä¸ŠDemo :</strong> <a href="https://codesandbox.io/s/hardcore-newton-phulu8?file=/index.html">hardcore-newton-phulu8 - CodeSandbox</a></p>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
    </categories>
    
    
    <tags>
      
      <tag>React</tag>
      
      <tag>æ€§èƒ½ä¼˜åŒ–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>useThrottle hookèŠ‚æµ</title>
    <link href="/2022/03/28/useThrottle%20hook%20%E7%9A%84%E5%B0%81%E8%A3%85/"/>
    <url>/2022/03/28/useThrottle%20hook%20%E7%9A%84%E5%B0%81%E8%A3%85/</url>
    
    <content type="html"><![CDATA[<h2 id="useThrottle-hook-èŠ‚æµ"><a href="#useThrottle-hook-èŠ‚æµ" class="headerlink" title="useThrottle hook èŠ‚æµ"></a>useThrottle hook èŠ‚æµ</h2><blockquote><p>å‰è¨€, èŠ‚æµæ˜¯å‰ç«¯å¸¸ç”¨å·¥å…·å‡½æ•°ã€‚æ¯”å¦‚è¯´è¿›è¡Œçª—å£çš„ resize, onscroll ç­‰æ“ä½œæ—¶ï¼Œäº‹ä»¶è°ƒç”¨çš„é¢‘ç‡å¾ˆé«˜ï¼Œä½¿å¾—æµè§ˆå™¨å¼€é”€å¾ˆå¤§ï¼Œä½¿å¾—ç”¨æˆ·çš„ä½“éªŒå¾ˆå·®ã€‚ä½¿ç”¨èŠ‚æµå¯ä»¥æå¤§é™ä½è°ƒç”¨çš„é¢‘ç‡ï¼Œæ‰€ä»¥å°†å…¶å°è£…æˆ hookã€‚</p></blockquote><p><strong>èŠ‚æµçš„åŸç†ï¼š</strong> å®šä¹‰ä¸€ä¸ªè®¡æ—¶å™¨ï¼Œè§„å®šåœ¨ delay åæ‰§è¡Œå‡½æ•°ã€‚å¦‚æœåœ¨ delay æ—¶é—´å†…å†æ¬¡è§¦å‘ï¼Œåˆ™ä¼šåˆ¤æ–­å®šæ—¶å™¨æ˜¯å¦å­˜åœ¨ï¼Œæœ‰åˆ™è¿”å›ï¼ˆä¸æ‰§è¡Œæ“ä½œï¼‰ï¼›æ— åˆ™ï¼Œé‡æ–°è®¾å®šä¸€ä¸ªè®¡æ—¶å™¨ï¼ˆdelay åæ‰§è¡Œå‡½æ•°ï¼‰ã€‚</p><p><strong>èŠ‚æµ hook:</strong></p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">import</span> &#123; useEffect, useCallback, useRef &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">useThrottle</span>(<span class="hljs-params">fn, delay, dep = []</span>) &#123;<br>  <span class="hljs-keyword">const</span> &#123; current &#125; = <span class="hljs-title function_">useRef</span>(&#123; fn, <span class="hljs-attr">timer</span>: <span class="hljs-literal">null</span> &#125;)<br>  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    current.<span class="hljs-property">fn</span> = fn<br>  &#125;, [fn, current])<br><br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">useCallback</span>(<br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">...args</span>) &#123;<br>      <span class="hljs-keyword">if</span> (!current.<span class="hljs-property">timer</span>) &#123;<br>        current.<span class="hljs-property">timer</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>          <span class="hljs-keyword">delete</span> current.<span class="hljs-property">timer</span><br>        &#125;, delay)<br>        current.<span class="hljs-property">fn</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>, ...args)<br>      &#125;<br>    &#125;,<br>    [...dep, delay, current]<br>  )<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> useThrottle<br></code></pre></div></td></tr></table></figure><p><strong>ä½¿ç”¨æ–¹æ³•ï¼š</strong></p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * @fn: å‡½æ•°</span><br><span class="hljs-comment"> * @delay: å»¶è¿Ÿæ—¶é—´ï¼ˆmsï¼‰</span><br><span class="hljs-comment"> * @dep: ä¾èµ–</span><br><span class="hljs-comment"> */</span><br><span class="hljs-title function_">useThrottle</span>(func, <span class="hljs-number">500</span>, [])<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>hook</category>
      
    </categories>
    
    
    <tags>
      
      <tag>React</tag>
      
      <tag>hook</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>React of Study</title>
    <link href="/2022/03/18/React%20of%20Study/"/>
    <url>/2022/03/18/React%20of%20Study/</url>
    
    <content type="html"><![CDATA[<h1 id="React-of-Study"><a href="#React-of-Study" class="headerlink" title="React of Study"></a>React of Study</h1><h2 id="ä¸€-React-å…¥é—¨"><a href="#ä¸€-React-å…¥é—¨" class="headerlink" title="ä¸€.React å…¥é—¨"></a>ä¸€.React å…¥é—¨</h2><h3 id="JSX-ç®€ä»‹"><a href="#JSX-ç®€ä»‹" class="headerlink" title="JSX ç®€ä»‹"></a>JSX ç®€ä»‹</h3><p>JSXï¼Œæ˜¯ä¸€ä¸ª JavaScript çš„è¯­æ³•æ‰©å±•ã€‚</p><h5 id="è¯­æ³•è§„åˆ™ï¼š"><a href="#è¯­æ³•è§„åˆ™ï¼š" class="headerlink" title="è¯­æ³•è§„åˆ™ï¼š"></a>è¯­æ³•è§„åˆ™ï¼š</h5><ul><li><p>åœ¨ JSX ä¸­åµŒå…¥è¡¨è¾¾å¼(åŒºåˆ†è¡¨è¾¾å¼ä¸ä»£ç å—)</p></li><li><p>æœ¬èº« JSX ä¹Ÿæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼</p></li><li><p>è™šæ‹Ÿ DOM ,ä¸€äº›æ ‡ç­¾çš„å±æ€§é‡‡ç”¨ <strong>â€œ å°é©¼å³°æ³•â€</strong></p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">VDOM</span> = <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">fontSize:</span> &#x27;<span class="hljs-attr">26px</span>&#x27; &#125;&#125;&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br></code></pre></div></td></tr></table></figure></li><li><p>JSX é‡Œçš„ <code>class</code> å˜æˆäº† <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/className"><code>className</code></a>ï¼Œè€Œ <code>tabindex</code> åˆ™å˜ä¸º tabIndex;</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">VDOM</span> = <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;title&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br></code></pre></div></td></tr></table></figure></li><li><p><img src="C:\Users\DuoRouSai\AppData\Roaming\Typora\typora-user-images\image-20220110162421373.png" alt="image-20220110162421373">ã€‚</p></li></ul><h3 id="React-Developer-Tools-è°ƒè¯•å·¥å…·"><a href="#React-Developer-Tools-è°ƒè¯•å·¥å…·" class="headerlink" title="React Developer Tools è°ƒè¯•å·¥å…·"></a>React Developer Tools è°ƒè¯•å·¥å…·</h3><ul><li>Components ç»„ä»¶ç»“æ„</li><li>Profiler æ€§èƒ½ç›‘æ§</li></ul><h2 id="äºŒ-React-é¢å‘ç»„ä»¶ç¼–ç¨‹"><a href="#äºŒ-React-é¢å‘ç»„ä»¶ç¼–ç¨‹" class="headerlink" title="äºŒ.React é¢å‘ç»„ä»¶ç¼–ç¨‹"></a>äºŒ.React é¢å‘ç»„ä»¶ç¼–ç¨‹</h2><h3 id="1-åŸºæœ¬ç†è§£å’Œä½¿ç”¨"><a href="#1-åŸºæœ¬ç†è§£å’Œä½¿ç”¨" class="headerlink" title="1.åŸºæœ¬ç†è§£å’Œä½¿ç”¨"></a>1.åŸºæœ¬ç†è§£å’Œä½¿ç”¨</h3><ul><li><p>å‡½æ•°å¼ç»„ä»¶</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// åœ¨ Babel ä¸‹ ï¼Œæ˜¯ä¸¥æ ¼æ¨¡å¼</span><br><span class="hljs-comment">// å‡½æ•°å¼ç¼–ç¨‹</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">MyComponent</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>æˆ‘æ˜¯å‡½æ•°å¼ç¼–ç¨‹â€œç®€å•ç»„ä»¶â€<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br>&#125;<br><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">MyComponent</span> /&gt;</span></span>, <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;test&#x27;</span>))<br><span class="hljs-comment">// &lt;MyComponent/&gt; react å¸®ä½ è°ƒç”¨ MyComponent</span><br></code></pre></div></td></tr></table></figure></li><li><p>ç±»å¼ç»„ä»¶</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// åœ¨ Babel ä¸‹ ï¼Œæ˜¯ä¸¥æ ¼æ¨¡å¼</span><br><span class="hljs-comment">// ç±»å¼ç¼–ç¨‹</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>  <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> (<br>      <span class="hljs-comment">// â€œå¤æ‚ç»„ä»¶â€ æœ‰ State</span><br>      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>æˆ‘æ˜¯ç±»å¼ç¼–ç¨‹â€œå¤æ‚ç»„ä»¶â€<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br>    )<br>  &#125;<br>&#125;<br><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">MyComponent</span> /&gt;</span></span>, <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;test&#x27;</span>))<br><span class="hljs-comment">// &lt;MyComponent/&gt; react å¸®ä½  new MyComponent</span><br></code></pre></div></td></tr></table></figure></li></ul><h3 id="2-ç»„ä»¶å®ä¾‹çš„ä¸‰å¤§æ ¸å¿ƒå±æ€§-1-State"><a href="#2-ç»„ä»¶å®ä¾‹çš„ä¸‰å¤§æ ¸å¿ƒå±æ€§-1-State" class="headerlink" title="2.ç»„ä»¶å®ä¾‹çš„ä¸‰å¤§æ ¸å¿ƒå±æ€§ 1: State"></a>2.ç»„ä»¶å®ä¾‹çš„ä¸‰å¤§æ ¸å¿ƒå±æ€§ 1: State</h3><h5 id="ç†è§£ï¼š"><a href="#ç†è§£ï¼š" class="headerlink" title="ç†è§£ï¼š"></a>ç†è§£ï¼š</h5><p>1.state æ˜¯ç»„ä»¶çš„çŠ¶æ€æœºï¼Œé€šè¿‡æ›´æ–°ç»„ä»¶çš„ state æ¥æ›´æ–°å¯¹åº”é¡µé¢æ˜¾ç¤ºï¼ˆé‡æ–°æ¸²æŸ“ï¼‰</p><p>2.state æ˜¯å¯¹è±¡å½¢å¼çš„ï¼Œå¤šä¸ª key-value ç»„åˆ</p><h5 id="å€¼å¾—æ³¨æ„ï¼š"><a href="#å€¼å¾—æ³¨æ„ï¼š" class="headerlink" title="å€¼å¾—æ³¨æ„ï¼š"></a>å€¼å¾—æ³¨æ„ï¼š</h5><blockquote><p>1.ç»„ä»¶ä¸­ render æ–¹æ³•ä¸­çš„ this æ˜¯ç»„ä»¶å®ä¾‹çš„å¯¹è±¡</p><p>2.ç»„ä»¶è‡ªå®šä¹‰æ–¹æ³•ä¸­ï¼Œé»˜è®¤å¼€å¯äº† use strictï¼Œä¸º undefine,è§£å†³ï¼š</p><ul><li><p>bind()ï¼Œå¼ºåˆ¶ç»‘å®šå®ä¾‹å¯¹è±¡çš„ this</p></li><li><p>ç®­å¤´å‡½æ•°</p><p>3.setState()ï¼Œç»„ä»¶çš„æ•°æ®ä¸å¯ä»¥ç›´æ¥æ›´æ”¹ã€‚</p></li></ul></blockquote><p>â€‹</p><h3 id="3-ç»„ä»¶å®ä¾‹çš„ä¸‰å¤§æ ¸å¿ƒå±æ€§-2-props"><a href="#3-ç»„ä»¶å®ä¾‹çš„ä¸‰å¤§æ ¸å¿ƒå±æ€§-2-props" class="headerlink" title="3.ç»„ä»¶å®ä¾‹çš„ä¸‰å¤§æ ¸å¿ƒå±æ€§ 2: props"></a>3.ç»„ä»¶å®ä¾‹çš„ä¸‰å¤§æ ¸å¿ƒå±æ€§ 2: props</h3><h5 id="ç†è§£ï¼š-1"><a href="#ç†è§£ï¼š-1" class="headerlink" title="ç†è§£ï¼š"></a>ç†è§£ï¼š</h5><ol><li>æ¯ä¸ªç»„ä»¶å¯¹è±¡éƒ½ä¼šæœ‰ props å±æ€§</li><li>ç»„ä»¶æ ‡ç­¾çš„æ‰€æœ‰å±æ€§éƒ½ä¿å­˜åœ¨ props ä¸­</li><li>ç”¨ props-type.js å¯¹å±æ€§è¿›è¡Œç±»å‹æ£€æµ‹ï¼Œå¿…è¦æ€§åˆ¤æ–­(React161 å¼€å§‹)</li></ol><h5 id="å€¼å¾—æ³¨æ„ï¼š-1"><a href="#å€¼å¾—æ³¨æ„ï¼š-1" class="headerlink" title="å€¼å¾—æ³¨æ„ï¼š"></a>å€¼å¾—æ³¨æ„ï¼š</h5><blockquote><ul><li>ç»„ä»¶å†…éƒ¨çš„ props æ˜¯åªè¯»å±æ€§çš„</li><li>æœ‰ç»„ä»¶å¤–å‘ç»„ä»¶å†…ä¼ é€’å˜åŒ–çš„æ•°æ®</li></ul></blockquote><h3 id="4-ç»„ä»¶å®ä¾‹çš„ä¸‰å¤§æ ¸å¿ƒå±æ€§-3-refs-ä¸äº‹ä»¶å¤„ç†"><a href="#4-ç»„ä»¶å®ä¾‹çš„ä¸‰å¤§æ ¸å¿ƒå±æ€§-3-refs-ä¸äº‹ä»¶å¤„ç†" class="headerlink" title="4.ç»„ä»¶å®ä¾‹çš„ä¸‰å¤§æ ¸å¿ƒå±æ€§ 3: refs ä¸äº‹ä»¶å¤„ç†"></a>4.ç»„ä»¶å®ä¾‹çš„ä¸‰å¤§æ ¸å¿ƒå±æ€§ 3: refs ä¸äº‹ä»¶å¤„ç†</h3><h5 id="ç†è§£ï¼š-2"><a href="#ç†è§£ï¼š-2" class="headerlink" title="ç†è§£ï¼š"></a>ç†è§£ï¼š</h5><blockquote><p>Refs æä¾›äº†ä¸€ç§æ–¹å¼ï¼Œå…è®¸æˆ‘ä»¬è®¿é—® DOM èŠ‚ç‚¹æˆ–åœ¨ render æ–¹æ³•ä¸­åˆ›å»ºçš„ React å…ƒç´ ã€‚</p></blockquote><h5 id="ä¸‰ç§å½¢å¼åˆ›å»º-ref"><a href="#ä¸‰ç§å½¢å¼åˆ›å»º-ref" class="headerlink" title="ä¸‰ç§å½¢å¼åˆ›å»º ref:"></a>ä¸‰ç§å½¢å¼åˆ›å»º ref:</h5><ol><li><p>å­—ç¬¦ä¸²å½¢å¼çš„ ref</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js">input ref=<span class="hljs-string">&quot;input1&quot;</span> type=<span class="hljs-string">&quot;text&quot;</span><br></code></pre></div></td></tr></table></figure></li><li><p>å›è°ƒå½¢å¼çš„ ref</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js">input ref=&#123;<span class="hljs-function">(<span class="hljs-params">a</span>)=&gt;</span><span class="hljs-variable language_">this</span>.<span class="hljs-property">input1</span> = a&#125; type=<span class="hljs-string">&quot;text&quot;</span><br></code></pre></div></td></tr></table></figure></li><li><p>createRef åˆ›å»º ref å®¹å™¨</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js">input2 = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">createRef</span>()<br>input ref=&#123;<span class="hljs-variable language_">this</span>.<span class="hljs-property">input1</span>&#125; type=<span class="hljs-string">&quot;text&quot;</span><br></code></pre></div></td></tr></table></figure></li></ol><h5 id="äº‹ä»¶å¤„ç†ï¼š"><a href="#äº‹ä»¶å¤„ç†ï¼š" class="headerlink" title="äº‹ä»¶å¤„ç†ï¼š"></a>äº‹ä»¶å¤„ç†ï¼š</h5><ol><li>é€šè¿‡ onXxx å±æ€§æŒ‡å®šäº‹ä»¶å¤„ç†å‡½æ•°ï¼ˆæ³¨æ„å¤§å°å†™ï¼‰<ul><li>React ä½¿ç”¨çš„å¼è‡ªå®šä¹‰(åˆæˆ)äº‹ä»¶ï¼Œè€Œä¸æ˜¯åŸç”Ÿçš„ DOM äº‹ä»¶â€“æ›´å¥½å…¼å®¹æ€§</li><li>React ä¸­çš„äº‹ä»¶é€šè¿‡å§”æ‰˜æ–¹å¼å¤„ç†çš„ï¼ˆå§”æ‰˜ç»™ç»„ä»¶æœ€å¤–å±‚çš„å…ƒç´ ï¼‰â€“æ›´é«˜çš„æ•ˆç‡</li></ul></li><li>é€šè¿‡ event.target å¾—åˆ°å‘ç”Ÿäº‹ä»¶çš„ DOM å¯¹è±¡</li></ol><h3 id="5-ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼š"><a href="#5-ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼š" class="headerlink" title="5.ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼š"></a>5.ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼š</h3><h5 id="æ—§ç‰ˆæœ¬çš„ç”Ÿå‘½å‘¨æœŸï¼š"><a href="#æ—§ç‰ˆæœ¬çš„ç”Ÿå‘½å‘¨æœŸï¼š" class="headerlink" title="æ—§ç‰ˆæœ¬çš„ç”Ÿå‘½å‘¨æœŸï¼š"></a>æ—§ç‰ˆæœ¬çš„ç”Ÿå‘½å‘¨æœŸï¼š</h5><p><img src="C:\Users\DuoRouSai\AppData\Roaming\Typora\typora-user-images\image-20220112113749152.png" alt="image-20220112113749152"></p><h6 id="ç”Ÿå‘½å‘¨æœŸçš„ä¸‰ä¸ªé˜¶æ®µï¼ˆæ—§ï¼‰ï¼š"><a href="#ç”Ÿå‘½å‘¨æœŸçš„ä¸‰ä¸ªé˜¶æ®µï¼ˆæ—§ï¼‰ï¼š" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸçš„ä¸‰ä¸ªé˜¶æ®µï¼ˆæ—§ï¼‰ï¼š"></a>ç”Ÿå‘½å‘¨æœŸçš„ä¸‰ä¸ªé˜¶æ®µï¼ˆæ—§ï¼‰ï¼š</h6><p><img src="C:\Users\DuoRouSai\AppData\Roaming\Typora\typora-user-images\image-20220112114024249.png" alt="image-20220112114024249"></p><h5 id="æ–°ç‰ˆæœ¬ç”Ÿå‘½å‘¨æœŸï¼ˆ-gt-v17-0-0ï¼‰ï¼š"><a href="#æ–°ç‰ˆæœ¬ç”Ÿå‘½å‘¨æœŸï¼ˆ-gt-v17-0-0ï¼‰ï¼š" class="headerlink" title="æ–°ç‰ˆæœ¬ç”Ÿå‘½å‘¨æœŸï¼ˆ&gt;v17.0.0ï¼‰ï¼š"></a>æ–°ç‰ˆæœ¬ç”Ÿå‘½å‘¨æœŸï¼ˆ&gt;v17.0.0ï¼‰ï¼š</h5><p><img src="C:\Users\DuoRouSai\AppData\Roaming\Typora\typora-user-images\image-20220112140120136.png" alt="image-20220112140120136"></p><h6 id="æ–°å¢ç”Ÿå‘½é’©å­ï¼ˆ2-ä¸ªï¼‰ï¼š"><a href="#æ–°å¢ç”Ÿå‘½é’©å­ï¼ˆ2-ä¸ªï¼‰ï¼š" class="headerlink" title="æ–°å¢ç”Ÿå‘½é’©å­ï¼ˆ2 ä¸ªï¼‰ï¼š"></a>æ–°å¢ç”Ÿå‘½é’©å­ï¼ˆ2 ä¸ªï¼‰ï¼š</h6><blockquote><p>getDerivedStateFromPropsï¼šæ­¤æ–¹æ³•é€‚ç”¨äº<a href="https://zh-hans.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html#when-to-use-derived-state">ç½•è§çš„ç”¨ä¾‹</a>ï¼Œå³ state çš„å€¼åœ¨ä»»ä½•æ—¶å€™éƒ½å–å†³äº propsã€‚</p><p>getSnapshotBeforeUpdate()ï¼šå®ƒä½¿å¾—ç»„ä»¶èƒ½åœ¨å‘ç”Ÿæ›´æ”¹ä¹‹å‰ä» DOM ä¸­æ•è·ä¸€äº›ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œæ»šåŠ¨ä½ç½®ï¼‰ã€‚æ­¤ç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„ä»»ä½•è¿”å›å€¼å°†ä½œä¸ºå‚æ•°ä¼ é€’ç»™ <code>componentDidUpdate()</code>ã€‚</p></blockquote><h6 id="å³å°†åºŸå¼ƒç”Ÿå‘½é’©å­ï¼ˆä¸‰ä¸ªï¼‰ï¼šå‡éœ€åœ¨å‰é¢åŠ ä¸Š-UNSAFE-å‰ç¼€"><a href="#å³å°†åºŸå¼ƒç”Ÿå‘½é’©å­ï¼ˆä¸‰ä¸ªï¼‰ï¼šå‡éœ€åœ¨å‰é¢åŠ ä¸Š-UNSAFE-å‰ç¼€" class="headerlink" title="å³å°†åºŸå¼ƒç”Ÿå‘½é’©å­ï¼ˆä¸‰ä¸ªï¼‰ï¼šå‡éœ€åœ¨å‰é¢åŠ ä¸Š UNSAFE_ (å‰ç¼€)"></a>å³å°†åºŸå¼ƒç”Ÿå‘½é’©å­ï¼ˆä¸‰ä¸ªï¼‰ï¼šå‡éœ€åœ¨å‰é¢åŠ ä¸Š UNSAFE_ (å‰ç¼€)</h6><ul><li>componentWillMountï¼ˆï¼‰</li><li>componentWillUpdateï¼ˆï¼‰</li><li>componentWillReceivePropsï¼ˆï¼‰</li></ul><h3 id="6-è™šæ‹Ÿ-DOMï¼Œdiff-ç®—æ³•ï¼š"><a href="#6-è™šæ‹Ÿ-DOMï¼Œdiff-ç®—æ³•ï¼š" class="headerlink" title="6.è™šæ‹Ÿ DOMï¼Œdiff ç®—æ³•ï¼š"></a>6.è™šæ‹Ÿ DOMï¼Œdiff ç®—æ³•ï¼š</h3><p><img src="C:\Users\DuoRouSai\AppData\Roaming\Typora\typora-user-images\image-20220112161357938.png" alt="image-20220112161357938"></p><h2 id="ä¸‰-React-ajax"><a href="#ä¸‰-React-ajax" class="headerlink" title="ä¸‰.React ajax"></a>ä¸‰.React ajax</h2><h3 id="1-react-è„šæ‰‹æ¶é…ç½®ä»£ç†æ€»ç»“"><a href="#1-react-è„šæ‰‹æ¶é…ç½®ä»£ç†æ€»ç»“" class="headerlink" title="1.react è„šæ‰‹æ¶é…ç½®ä»£ç†æ€»ç»“"></a>1.react è„šæ‰‹æ¶é…ç½®ä»£ç†æ€»ç»“</h3><h4 id="æ–¹æ³•ä¸€ï¼š"><a href="#æ–¹æ³•ä¸€ï¼š" class="headerlink" title="æ–¹æ³•ä¸€ï¼š"></a>æ–¹æ³•ä¸€ï¼š</h4><p><img src="C:\Users\DuoRouSai\AppData\Roaming\Typora\typora-user-images\image-20220113230205483.png" alt="image-20220113230205483"></p><h4 id="æ–¹æ³•äºŒï¼š"><a href="#æ–¹æ³•äºŒï¼š" class="headerlink" title="æ–¹æ³•äºŒï¼š"></a>æ–¹æ³•äºŒï¼š</h4><blockquote><p>æ³¨æ„ä» http-proxy-middleware v2.0 å¼€å§‹ä½¿ç”¨ createProxyMiddleware ä»£æ›¿ proxy</p><p><img src="C:\Users\DuoRouSai\AppData\Roaming\Typora\typora-user-images\image-20220113230149722.png" alt="image-20220113230149722"></p></blockquote><h3 id="2-xhrï¼ˆaxiosï¼‰-å’Œ-fetch-çš„åŒºåˆ«"><a href="#2-xhrï¼ˆaxiosï¼‰-å’Œ-fetch-çš„åŒºåˆ«" class="headerlink" title="2.xhrï¼ˆaxiosï¼‰ å’Œ fetch çš„åŒºåˆ«"></a>2.xhrï¼ˆaxiosï¼‰ å’Œ fetch çš„åŒºåˆ«</h3><blockquote><p><strong>xhr ä¸ fetch æ˜¯åŒä¸€çº§åˆ«çš„ ï¼ï¼ï¼</strong></p></blockquote><h5 id="1-ä¼ ç»Ÿçš„-xhr-è¯·æ±‚"><a href="#1-ä¼ ç»Ÿçš„-xhr-è¯·æ±‚" class="headerlink" title="1.ä¼ ç»Ÿçš„ xhr è¯·æ±‚"></a>1.ä¼ ç»Ÿçš„ xhr è¯·æ±‚</h5><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">var</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>()<br>xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;GET&#x27;</span>, url)<br>xhr.<span class="hljs-property">responseType</span> = <span class="hljs-string">&#x27;json&#x27;</span><br><br>xhr.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(xhr.<span class="hljs-property">response</span>)<br>&#125;<br><br>xhr.<span class="hljs-property">onerror</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Oops, error&#x27;</span>)<br>&#125;<br><br>xhr.<span class="hljs-title function_">send</span>()<br></code></pre></div></td></tr></table></figure><h5 id="2-æœªä¼˜åŒ–çš„-fetch-è¯·æ±‚"><a href="#2-æœªä¼˜åŒ–çš„-fetch-è¯·æ±‚" class="headerlink" title="2.æœªä¼˜åŒ–çš„ fetch è¯·æ±‚"></a>2.æœªä¼˜åŒ–çš„ fetch è¯·æ±‚</h5><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-title function_">fetch</span>(url)<br>  .<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>) &#123;<br>    <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">json</span>()<br>  &#125;)<br>  .<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)<br>  &#125;)<br>  .<span class="hljs-title function_">catch</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Oops, error&#x27;</span>)<br>  &#125;)<br></code></pre></div></td></tr></table></figure><h5 id="3-ä¼˜åŒ–åçš„-fetch-è¯·æ±‚"><a href="#3-ä¼˜åŒ–åçš„-fetch-è¯·æ±‚" class="headerlink" title="3.ä¼˜åŒ–åçš„ fetch è¯·æ±‚"></a>3.ä¼˜åŒ–åçš„ fetch è¯·æ±‚</h5><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">try</span> &#123;<br>  <span class="hljs-keyword">let</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(url)<br>  <span class="hljs-keyword">let</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>()<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data)<br>&#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Oops, error&#x27;</span>, e)<br>&#125;<br><span class="hljs-comment">// æ³¨ï¼šè¿™æ®µä»£ç å¦‚æœæƒ³è¿è¡Œï¼Œå¤–é¢éœ€è¦åŒ…ä¸€ä¸ª async function</span><br></code></pre></div></td></tr></table></figure><h3 id="3-PubSubJs-æ¶ˆæ¯è®¢é˜…-ä¸-å‘å¸ƒæœºåˆ¶"><a href="#3-PubSubJs-æ¶ˆæ¯è®¢é˜…-ä¸-å‘å¸ƒæœºåˆ¶" class="headerlink" title="3.PubSubJs æ¶ˆæ¯è®¢é˜… ä¸ å‘å¸ƒæœºåˆ¶"></a>3.PubSubJs æ¶ˆæ¯è®¢é˜… ä¸ å‘å¸ƒæœºåˆ¶</h3><p><img src="C:\Users\DuoRouSai\AppData\Roaming\Typora\typora-user-images\image-20220114154029332.png" alt="image-20220114154029332"></p><h5 id="ä½¿ç”¨è¿‡ç¨‹ï¼š"><a href="#ä½¿ç”¨è¿‡ç¨‹ï¼š" class="headerlink" title="ä½¿ç”¨è¿‡ç¨‹ï¼š"></a>ä½¿ç”¨è¿‡ç¨‹ï¼š</h5><p>å¯¼å…¥ pubsub.js æ¨¡å—</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">PubSub</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pubsub-js&#x27;</span><br></code></pre></div></td></tr></table></figure><p>åœ¨éœ€è¦ æ¶ˆæ¯è®¢é˜… çš„ç»„ä»¶ï¼Œè®¢é˜…</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">var</span> token = <span class="hljs-title class_">PubSub</span>.<span class="hljs-title function_">subscribe</span>(<span class="hljs-string">&#x27;MY TOPIC&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">msg, data</span>) =&gt;</span> &#123;&#125;)<br></code></pre></div></td></tr></table></figure><p>åœ¨éœ€è¦ å‘å¸ƒ ç»„ä»¶ä¸­ï¼Œå‘å¸ƒæ¶ˆæ¯ï¼ˆmsg:æ¶ˆæ¯ï¼Œdata:æ•°æ®ï¼‰</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-title class_">PubSub</span>.<span class="hljs-title function_">publish</span>(<span class="hljs-string">&#x27;MY TOPIC&#x27;</span>, <span class="hljs-string">&#x27;hello world!&#x27;</span>)<br></code></pre></div></td></tr></table></figure><p>æ¶ˆæ¯è®¢é˜…çš„ç»„ä»¶å¾…é”€æ¯åï¼Œå–æ¶ˆè®¢é˜…</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-title class_">PubSub</span>.<span class="hljs-title function_">unsubscribe</span>(token)<br></code></pre></div></td></tr></table></figure><h2 id="å››-React-è·¯ç”±"><a href="#å››-React-è·¯ç”±" class="headerlink" title="å››.React è·¯ç”±"></a>å››.React è·¯ç”±</h2><h3 id="1-Spa-ç†è§£"><a href="#1-Spa-ç†è§£" class="headerlink" title="1.Spa ç†è§£"></a>1.Spa ç†è§£</h3><p><img src="C:\Users\DuoRouSai\AppData\Roaming\Typora\typora-user-images\image-20220114155209771.png" alt="image-20220114155209771"></p><h3 id="2-è·¯ç”±çš„ç†è§£"><a href="#2-è·¯ç”±çš„ç†è§£" class="headerlink" title="2.è·¯ç”±çš„ç†è§£"></a>2.è·¯ç”±çš„ç†è§£</h3><ol><li><p>ä»€ä¹ˆæ˜¯è·¯ç”±ï¼Ÿ</p><p><img src="C:\Users\DuoRouSai\AppData\Roaming\Typora\typora-user-images\image-20220114155416804.png" alt="image-20220114155416804"></p></li><li><p>è·¯ç”±åˆ†ç±»</p><ul><li><p>åç«¯è·¯ç”±</p><p><img src="C:\Users\DuoRouSai\AppData\Roaming\Typora\typora-user-images\image-20220114160524889.png" alt="image-20220114160524889"></p></li><li><p>å‰ç«¯è·¯ç”±</p><p>æ–¹å¼ä¸€ï¼šH5 æ¨å‡ºæ¥çš„ history æ¨¡å¼(æ—§çš„æµè§ˆå™¨ä¸å…¼å®¹)</p><p>æ–¹å¼äºŒï¼šhash å€¼ï¼ˆé”šç‚¹ï¼‰</p><p><img src="C:\Users\DuoRouSai\AppData\Roaming\Typora\typora-user-images\image-20220114160544635.png" alt="image-20220114160544635"></p></li></ul></li></ol><h3 id="3-è·¯ç”±åŸºæœ¬ä½¿ç”¨ï¼š"><a href="#3-è·¯ç”±åŸºæœ¬ä½¿ç”¨ï¼š" class="headerlink" title="3.è·¯ç”±åŸºæœ¬ä½¿ç”¨ï¼š"></a>3.è·¯ç”±åŸºæœ¬ä½¿ç”¨ï¼š</h3><h2 id="äº”-Redux-çŠ¶æ€ç®¡ç†"><a href="#äº”-Redux-çŠ¶æ€ç®¡ç†" class="headerlink" title="äº”.Redux çŠ¶æ€ç®¡ç†"></a>äº”.Redux çŠ¶æ€ç®¡ç†</h2><h3 id="1-redux-åŸç†å›¾"><a href="#1-redux-åŸç†å›¾" class="headerlink" title="1.redux åŸç†å›¾"></a>1.redux åŸç†å›¾</h3><p><img src="C:\Users\DuoRouSai\AppData\Roaming\Typora\typora-user-images\image-20220126180325926.png" alt="image-20220126180325926"></p><h2 id="2-react-redux-åŸç†å›¾"><a href="#2-react-redux-åŸç†å›¾" class="headerlink" title="2.react-redux åŸç†å›¾"></a>2.react-redux åŸç†å›¾</h2><p><img src="C:\Users\DuoRouSai\AppData\Roaming\Typora\typora-user-images\image-20220126180413848.png" alt="image-20220126180413848"></p>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
    </categories>
    
    
    <tags>
      
      <tag>React</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯å·¥ç¨‹åŒ–--æ‰¹é‡å¯¼å…¥æ¨¡å—</title>
    <link href="/2022/03/18/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96--%E6%89%B9%E9%87%8F%E5%AF%BC%E5%85%A5%E6%A8%A1%E5%9D%97/"/>
    <url>/2022/03/18/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96--%E6%89%B9%E9%87%8F%E5%AF%BC%E5%85%A5%E6%A8%A1%E5%9D%97/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰ç«¯å·¥ç¨‹åŒ–â€“æ‰¹é‡å¯¼å…¥æ¨¡å—"><a href="#å‰ç«¯å·¥ç¨‹åŒ–â€“æ‰¹é‡å¯¼å…¥æ¨¡å—" class="headerlink" title="å‰ç«¯å·¥ç¨‹åŒ–â€“æ‰¹é‡å¯¼å…¥æ¨¡å—"></a>å‰ç«¯å·¥ç¨‹åŒ–â€“æ‰¹é‡å¯¼å…¥æ¨¡å—</h2><h3 id="01-èµ·å› "><a href="#01-èµ·å› " class="headerlink" title="01 èµ·å› "></a>01 èµ·å› </h3><blockquote><p>å‰ç«¯é¡¹ç›®ä¸­ï¼Œå¯èƒ½éšç€é¡¹ç›®çš„åºå¤§çš„ï¼Œæ¨¡å—éšä¹‹é¡¹ç›®ä½“é‡è€Œå˜å¤šï¼Œæ¯”å¦‚è¯´ service æ¨¡å—ä¸‹æœ‰ 100+ æ¨¡å—ï¼Œæ‰‹åŠ¨å¼•å…¥å®åœ¨æµªè´¹æ—¶é—´äº†ï¼Œæ‰€ä»¥ç¨‹åºçŒ¿èƒ½ç”¨æŠ€æœ¯å·æ‡’ï¼Œå°±ä¸è¦æ‰‹å·¥ã€‚</p></blockquote><h3 id="02-å…·ä½“å®ç°"><a href="#02-å…·ä½“å®ç°" class="headerlink" title="02 å…·ä½“å®ç°"></a>02 å…·ä½“å®ç°</h3><blockquote><p><a href="https://webpack.docschina.org/guides/dependency-management/#requirecontext">å®˜æ–¹æ–‡æ¡£åœ¨è¿™é‡Œ~~~</a></p></blockquote><p>è¿™è¾¹å…·ä½“è¯­æ³•å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼Œä¸‹è¾¹å…·ä½“æ˜¯å…·ä½“å®ç°ï¼š</p><p>æ¯”å¦‚ï¼š</p><p><code>service</code> æ¨¡å—ä¸‹æœ‰ä¸ª<code>modules</code>ï¼Œå­˜æ”¾ <code>a.js, b.js, c.js</code></p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// service/index.js</span><br><span class="hljs-comment">// å‰ç«¯å·¥ç¨‹åŒ–é‡Œé¢å¸¸ç”¨çš„æ‰¹é‡å¯¼å…¥æ–‡ä»¶</span><br><span class="hljs-keyword">const</span> requireContext = <span class="hljs-built_in">require</span>.<span class="hljs-title function_">context</span>(<span class="hljs-string">&#x27;./modules&#x27;</span>, <span class="hljs-literal">false</span>, <span class="hljs-regexp">/\.js$/</span>)<br><span class="hljs-comment">// ç”¨äºå­˜æ”¾æ¨¡å—çš„æ•°ç»„</span><br><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">MODULES</span> = []<br><span class="hljs-keyword">const</span> requireContextKeys = requireContext.<span class="hljs-title function_">keys</span>()<br><br><span class="hljs-comment">// æ ¹æ®ä¸Šé¢æ‰¹é‡å¯¼å…¥çš„æ–‡ä»¶è¯»å–é‡Œé¢å®šä¹‰çš„æ¨¡å—åˆ° MOUDULES æ•°ç»„ä¸­</span><br>requireContextKeys.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> <span class="hljs-variable language_">module</span> = requireContext(item)<br>  <span class="hljs-variable constant_">MODULES</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">module</span>.<span class="hljs-property">Service</span>)<br>&#125;)<br></code></pre></div></td></tr></table></figure><p>é€šè¿‡ <code>clog</code> æ‰“å° <code>MODULES</code> æ•°ç»„</p><p><img src="https://i.ibb.co/YZz7vXL/image-20220314121929909.png"></p>]]></content>
    
    
    <categories>
      
      <category>Webpack</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰ç«¯å·¥ç¨‹åŒ–</tag>
      
      <tag>Webpack</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JavaScript äº‹ä»¶å¾ªç¯</title>
    <link href="/2022/03/18/JavaScript%20%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF/"/>
    <url>/2022/03/18/JavaScript%20%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF/</url>
    
    <content type="html"><![CDATA[<h2 id="JavaScript-äº‹ä»¶å¾ªç¯"><a href="#JavaScript-äº‹ä»¶å¾ªç¯" class="headerlink" title="JavaScript äº‹ä»¶å¾ªç¯"></a>JavaScript äº‹ä»¶å¾ªç¯</h2><p>å” å” åŸºç¡€ğŸ˜Š</p><p>ä¼—æ‰€å‘¨çŸ¥ <code>js</code> æ˜¯å•çº¿ç¨‹çš„ï¼Œè‡³äºä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹çš„ï¼Ÿ</p><p>ç­”ï¼š <code>js</code>ä½œä¸ºè„šæœ¬è¯­è¨€ï¼Œå…¶ä¸»è¦è´Ÿè´£ <code>æ“ä½œDOM</code> å’Œ <code>ç”¨æˆ·äº¤äº’</code> ã€‚å‡å¦‚å˜æˆå¤šçº¿ç¨‹çš„è¯ï¼Œä¸€ä¸ªçº¿ç¨‹åœ¨ç»™æŸä¸ª<code>DOM</code> æ·»åŠ å†…å®¹ ï¼Œè€Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨åˆ é™¤è¿™ä¸ª <code>DOM</code> ä¸€åˆ‡å°±ä¹±å¥—äº†ã€‚</p><h3 id="01-åŒæ­¥ä»»åŠ¡å’Œå¼‚æ­¥ä»»åŠ¡"><a href="#01-åŒæ­¥ä»»åŠ¡å’Œå¼‚æ­¥ä»»åŠ¡" class="headerlink" title="01 åŒæ­¥ä»»åŠ¡å’Œå¼‚æ­¥ä»»åŠ¡"></a>01 åŒæ­¥ä»»åŠ¡å’Œå¼‚æ­¥ä»»åŠ¡</h3><p>â€‹        <strong>è™½ç„¶ <code>js</code> æ˜¯å•çº¿ç¨‹ï¼Œä½†æ˜¯å¼•å…¥ä¸¤ä¸ªæ¦‚å¿µï¼Œä¸€ä¸ªæ˜¯<code>åŒæ­¥</code>ï¼Œå¦å¤–ä¸€ä¸ª<code>å¼‚æ­¥</code>ã€‚</strong></p><ul><li>åŒæ­¥ä»»åŠ¡ï¼š</li></ul><p>ä»£ç æ˜¯æŒ‰ç…§<code>æ‰§è¡Œæ ˆ</code>é¡ºåºæ‰§è¡Œä¸‹æ¥çš„ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Hello&quot;</span>)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;DouR&quot;</span>)<br><span class="hljs-comment">// console:</span><br><span class="hljs-comment">// 1ï¼šHello </span><br><span class="hljs-comment">// 2ï¼šDouR</span><br></code></pre></div></td></tr></table></figure><ul><li>å¼‚æ­¥ä»»åŠ¡ï¼š</li></ul><p>å¼‚æ­¥æ“ä½œï¼Œæ¯”å¦‚ï¼š<code>setTimeout</code>ï¼Œ<code>Promise</code>ï¼Œ<code>Ajax</code>â€¦ç­‰ã€‚å½“é¡ºåºæ‰§è¡Œ <code>æ‰§è¡Œæ ˆ</code> ä»£ç æ—¶ï¼Œé‡åˆ°å¼‚æ­¥æ“ä½œï¼Œå¯ä»¥æŠŠå®ƒä»¬çœ‹åšæ¯”è¾ƒè€—æ—¶çš„å·¥ä½œï¼Œæ”¾å…¥<code>ä»»åŠ¡é˜Ÿåˆ—</code>ä¸­å»ï¼Œæ¥ç€æ‰§è¡Œä»£ç ï¼Œç­‰æ‰§è¡Œå®ŒåŒæ­¥ä»£ç ååœ¨æ‰§è¡Œ<code>ä»»åŠ¡é˜Ÿåˆ—</code> çš„ä»»åŠ¡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>&#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;Hello&quot;</span>)<br>&#125;)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;DouR&quot;</span>)<br><span class="hljs-comment">// console:</span><br><span class="hljs-comment">// 1: DouR</span><br><span class="hljs-comment">// 2: Hello </span><br></code></pre></div></td></tr></table></figure><p>å¯ä»¥å¾ˆæ¸…æ™°çœ‹åˆ°å…ˆæ‰“å° <code>DouR</code> </p><h3 id="02-Event-Loop"><a href="#02-Event-Loop" class="headerlink" title="02 Event Loop"></a>02 Event Loop</h3><p>äº‹ä»¶å¾ªç¯å°±æ˜¯ <code>å…¥æ ˆå‡ºæ ˆ</code> çš„è¿‡ç¨‹ï¼Œä¸Šé¢æåˆ°çš„å¼‚æ­¥ä»»åŠ¡ï¼Œå¯ä»¥åˆ†æˆ <code>å®ä»»åŠ¡ï¼ˆMacrotaskï¼‰</code>  å’Œ  <code>å¾®ä»»åŠ¡ï¼ˆMicrotaskï¼‰</code></p><p><strong>å®ä»»åŠ¡ï¼š</strong>setTimeout, setInterval, setImmediate, I/O, UI render</p><p><strong>å¾®ä»»åŠ¡ï¼š</strong>process.nextTick, Promises, Object.observe, MutationObserver(H5 æ–°ç‰¹æ€§)</p><p><strong>æ¯ä¸€æ¬¡ Event Loop è§¦å‘æ—¶ï¼š</strong></p><ol><li>é¦–å…ˆæ‰§è¡Œ<code>ä¸»æ‰§è¡Œæ ˆ</code>ä»»åŠ¡ï¼Œä¾‹å¦‚ script ä»»åŠ¡</li><li>åˆ†åˆ«å°† <code>å®ä»»åŠ¡</code> å’Œ <code>å¾®ä»»åŠ¡</code> ,å‹å…¥<code>å®ä»»åŠ¡é˜Ÿåˆ—</code> å’Œ <code>å¾®ä»»åŠ¡é˜Ÿåˆ—</code></li><li>æ¥ç€ï¼Œå…ˆå–å‡º <code>å¾®ä»»åŠ¡é˜Ÿåˆ—</code> æ‰§è¡Œç›´è‡³æ¸…ç©ºï¼ˆæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œç¢°åˆ°<code>å¾®ä»»åŠ¡</code>æˆ–è€…<code>å®ä»»åŠ¡</code> åˆ†åˆ«å‹å…¥é˜Ÿåˆ—ä¸­å»ï¼Œç”¨äºä¸‹ä¸€è½® Event loopæ‰§è¡Œï¼‰</li><li>â€”â€” æ–°çš„ä¸€è½® Event Loopâ€”â€”</li><li>å–å‡º <code>å®ä»»åŠ¡é˜Ÿåˆ—</code> æ‰§è¡Œç›´è‡³æ¸…ç©º </li><li>å–å‡º <code>å¾®ä»»åŠ¡é˜Ÿåˆ—</code> æ‰§è¡Œç›´è‡³æ¸…ç©º </li><li>5ã€6é‡å¤</li></ol><p><strong>è¯•è¯•è¿™ä¸ªæ —å­ï¼š</strong></p><figure class="highlight arcade"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs arcade"><span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;global&#x27;</span>)<br><br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>;i &lt;= <span class="hljs-number">5</span>;i ++) &#123;<br>  setTimeout(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(i)<br>  &#125;,i*<span class="hljs-number">1000</span>)<br>  <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(i)<br>&#125;<br><br><span class="hljs-keyword">new</span> Promise(<span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) &#123;<br>  <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;promise1&#x27;</span>)<br>  resolve()<br> &#125;).then(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;then1&#x27;</span>)<br>&#125;)<br><br>setTimeout(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;timeout2&#x27;</span>)<br>  <span class="hljs-keyword">new</span> Promise(<span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) &#123;<br>    <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;timeout2_promise&#x27;</span>)<br>    resolve()<br>  &#125;).then(<span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-built_in">console</span>.<span class="hljs-built_in">log</span>(<span class="hljs-string">&#x27;timeout2_then&#x27;</span>)<br>  &#125;)<br>&#125;, <span class="hljs-number">1000</span>)<br><br></code></pre></div></td></tr></table></figure><p><strong>ç»“æœï¼š</strong></p><p><img src="https://i.ibb.co/9YbnGCm/image-20220308213843024.png" alt="image-20220308213843024"></p><p><strong>è¯´ä¸ªå†·çŸ¥è¯†ï¼Œæµè§ˆå™¨çš„äº‹ä»¶å¾ªç¯ å’Œ Nodeäº‹ä»¶å¾ªç¯ä¸ä¸€è‡´</strong><a href="https://juejin.cn/post/6844903574560833550">æµè§ˆå™¨å’ŒNodeä¸åŒçš„äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰ - æ˜é‡‘ (juejin.cn)</a></p>]]></content>
    
    
    <categories>
      
      <category>JavaScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Style-Components  æµ…ä½“éªŒ</title>
    <link href="/2022/03/07/Style-Component%20%20%E6%B5%85%E4%BD%93%E9%AA%8C/"/>
    <url>/2022/03/07/Style-Component%20%20%E6%B5%85%E4%BD%93%E9%AA%8C/</url>
    
    <content type="html"><![CDATA[<h2 id="Style-Components-æµ…ä½“éªŒ"><a href="#Style-Components-æµ…ä½“éªŒ" class="headerlink" title="Style-Components  æµ…ä½“éªŒ"></a>Style-Components  æµ…ä½“éªŒ</h2><p><img src="https://styled-components.com/icon.png"></p><blockquote><p>å½“ä½ è¿˜åœ¨çƒ¦æ¼ä½ çš„ <code>css</code> ä¸ºå•¥æ€»æ˜¯ä¼šå½±å“åˆ°å…¶ä»–çš„ç»„ä»¶ï¼Œå¯ä»¥è€ƒè™‘ä¸‹ <code>style-component</code> äº†ï¼å®˜æ–¹ icon å°±å¾ˆé­”æ€§</p></blockquote><h3 id="01-å®‰è£…"><a href="#01-å®‰è£…" class="headerlink" title="01 å®‰è£…"></a>01 å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">$ npm install --save styled-components<br></code></pre></div></td></tr></table></figure><h3 id="02-ç®€å•ä½¿ç”¨ä¸‹"><a href="#02-ç®€å•ä½¿ç”¨ä¸‹" class="headerlink" title="02 ç®€å•ä½¿ç”¨ä¸‹"></a>02 ç®€å•ä½¿ç”¨ä¸‹</h3><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ª <code>style.js</code> æ¥ç¼–å†™ <code>css</code>, å¯¹ï¼ä½ æ²¡æœ‰å¬é”™ï¼Œ<code>css</code> å†™åœ¨ <code>js</code> ä¸­ã€‚</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// style.js</span><br><span class="hljs-keyword">import</span> styled <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;styled-components&quot;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">HelloDiv</span> = styled.<span class="hljs-property">div</span><span class="hljs-string">`</span><br><span class="hljs-string">    width: 200px;</span><br><span class="hljs-string">    text-align: center;</span><br><span class="hljs-string">    background-color: orange;</span><br><span class="hljs-string">    color: yellow;</span><br><span class="hljs-string">    .box &#123;</span><br><span class="hljs-string">        color: blue;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">`</span><br></code></pre></div></td></tr></table></figure><p>å†ç„¶åï¼ŒæŠŠ <code>style.js</code> å¼•å…¥åˆ° <code>Hello.jsx</code> ï¼Œä½¿ç”¨ <code>HelloDiv</code> ä½œä¸ºæ ‡ç­¾åï¼Œå°±ä¼šå¾—åˆ°ä¸€ä¸ªè¯­ä¹‰åŒ–çš„è‡ªå®šä¹‰æ ‡ç­¾ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// Hello.jsx</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">HelloDiv</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./style&quot;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Hello</span> () &#123;<br>    <span class="hljs-keyword">return</span>(<br>        <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">HelloDiv</span>&gt;</span></span><br><span class="language-xml">             Hello style-components</span><br><span class="language-xml">             <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;box&quot;</span>&gt;</span></span><br><span class="language-xml">                 æˆ‘æ˜¯ box</span><br><span class="language-xml">             <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">HelloDiv</span>&gt;</span></span><br>    )<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç„¶åï¼Œå’±ä»¬æ‰“å¼€æ§åˆ¶å°ç§ç§ï¼Œç»™å’± <code> Helloç»„ä»¶</code> èµ·äº†å•¥æ ‡ç­¾å</p><p><img src="https://i.ibb.co/BGLrtbd/image-20220302113342382.png"></p><p>ç¥å¥‡ä¸ï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒï¼Œå†™çš„æ ·å¼å½±å“åˆ°å…¶ä»–çš„ç»„ä»¶å•¦â€¦</p><h3 id="03-æ‰©å±•ï¼šThemeProvider"><a href="#03-æ‰©å±•ï¼šThemeProvider" class="headerlink" title="03 æ‰©å±•ï¼šThemeProvider"></a>03 æ‰©å±•ï¼šThemeProvider</h3><blockquote><p>å‡å¦‚ä½ é¡¹ç›®å½“ä¸‹æˆ–è€…æœªæ¥æœ‰å®šåˆ¶åŒ– <code>theme</code> çš„éœ€æ±‚ï¼Œå¿«æ¥çœ‹è¿™ï¼Œæ¥å¯¹åœ°å•¦ï¼</p></blockquote><p><strong>ä½¿ç”¨æ–¹å¼ï¼š</strong></p><p>é¦–å…ˆä½ éœ€è¦å®šä¹‰ä¸€ä¸ªå­˜æ”¾å®šä¹‰å„ç§å„æ ·çš„ä¸»é¢˜æ ·å¼ <code>theme.js</code></p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// theme.js</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-attr">c_blue</span>: <span class="hljs-string">&quot;#3B81F7&quot;</span>, *<span class="hljs-comment">// è“è‰²*</span><br>  <span class="hljs-attr">c_yellow</span>: <span class="hljs-string">&quot;#FFA800&quot;</span>, *<span class="hljs-comment">// é»„è‰²*</span><br>  <span class="hljs-attr">c_red</span>: <span class="hljs-string">&quot;#FF2121&quot;</span>, *<span class="hljs-comment">// çº¢è‰²*</span><br>  <span class="hljs-attr">c_green</span>: <span class="hljs-string">&quot;#07C160&quot;</span>, *<span class="hljs-comment">// ç»¿è‰²*</span><br>  <span class="hljs-attr">c_white</span>: <span class="hljs-string">&quot;#FFFFFF&quot;</span>, *<span class="hljs-comment">// ç™½è‰²*</span><br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç„¶åï¼Œåœ¨ä½ é¡¹ç›®æœ€æœ€æœ€..æœ€æ ¹æ ‡ç­¾ä¸‹ï¼Œä½¿ç”¨  <code>styled-components</code> æä¾›çš„ ThemeProvider æ ‡ç­¾åŒ…è£¹èµ·æ¥ï¼Œå†æŠŠä½ å®šä¹‰å¥½çš„ <code>theme</code> çš„ä½œä¸º <code>props</code> å¼•å…¥è¿›å»</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// src/index.jsx</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">ThemeProvider</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;styled-components&quot;</span><br><span class="hljs-keyword">import</span> theme <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./theme&quot;</span><br><br><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<br>  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">React.StrictMode</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">ThemeProvider</span>  <span class="hljs-attr">theme</span>=<span class="hljs-string">&#123;</span> <span class="hljs-attr">theme</span> &#125;&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeProvider</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">React.StrictMode</span>&gt;</span></span>,<br>  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;root&#x27;</span>)<br>);<br><br></code></pre></div></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œä½ å°±æ„‰å¿«åœ°ä½¿ç”¨ä½ åœ¨ <code>theme.js</code>  å®šä¹‰çš„é¢œè‰²</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// Hello/style.js</span><br><span class="hljs-keyword">import</span> styled <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;styled-components&quot;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">HelloDiv</span> = styled.<span class="hljs-property">div</span><span class="hljs-string">`</span><br><span class="hljs-string">    width: 200px;</span><br><span class="hljs-string">    text-align: center;</span><br><span class="hljs-string">    background-color: <span class="hljs-subst">$&#123;p =&gt; p.theme.c_orange&#125;</span>;</span><br><span class="hljs-string">    color: <span class="hljs-subst">$&#123;p =&gt; p.theme.c_yellow&#125;</span> ;</span><br><span class="hljs-string">    .box &#123;</span><br><span class="hljs-string">        color:<span class="hljs-subst">$&#123;p =&gt; p.theme.c_blue&#125;</span> ;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">`</span><br></code></pre></div></td></tr></table></figure><h3 id="04æ‰©å±•ï¼šcreateGlobalStyle"><a href="#04æ‰©å±•ï¼šcreateGlobalStyle" class="headerlink" title="04æ‰©å±•ï¼šcreateGlobalStyle"></a>04æ‰©å±•ï¼šcreateGlobalStyle</h3><blockquote><p>ç”¨äºè¦†ç›–å…¨å±€æ ·å¼ï¼Œæ¯”å¦‚æƒ³ä¿®æ”¹UI æ¡†æ¶é»˜è®¤çš„æ ·å¼â€¦</p></blockquote><p><strong>ä½¿ç”¨æ–¹å¼ï¼š</strong></p><p>è¿™è¾¹ä»¥ä¿®æ”¹ <code>antd</code> çš„ <code>&lt;Button /&gt;</code> ç»„ä»¶ä¸ºä¾‹ </p><p><img src="https://i.ibb.co/0Ck5WF8/image-20220307170932506.png" alt="image-20220307170932506"></p><p>é¦–å…ˆï¼Œä½¿ç”¨ <code>style-components</code> çš„ <code>createGlobalStyle</code> API åˆ›å»ºä¸€ä¸ªéœ€è¦è¦†ç›–çš„æ ·å¼</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// style.js</span><br><span class="hljs-keyword">import</span> &#123;createGlobalStyle&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;styled-components&quot;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">StyledIndex</span> = createGlobalStyle<span class="hljs-string">`</span><br><span class="hljs-string">    .ant-btn-primary &#123;</span><br><span class="hljs-string">        background-color: orange;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">`</span><br></code></pre></div></td></tr></table></figure><p>æ¥ç€ï¼Œå¼•ç”¨éœ€è¦çš„è¦†ç›–çš„æ ·å¼çš„ç»„ä»¶ä¸­å»</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// index.js</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">StyledIndex</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./style.js&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Button</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;antd&#x27;</span>;<br><br><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<br>  <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">StyledIndex</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">StyledIndex</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;primary&quot;</span>&gt;</span>Primary Button<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/&gt;</span></span>,<br>  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;container&#x27;</span>),<br>);<br></code></pre></div></td></tr></table></figure><p>å½“ç»„ä»¶è¢« render çš„æ—¶å€™ï¼Œè¯»åˆ° <code>StyledIndex</code> å°±ä¼šè¢«æ³¨å…¥å…¨å±€æ ·å¼ä¸­å»ï¼Œå˜æˆä¸‹é¢è¿™æ ·â€¦</p><p><img src="https://i.ibb.co/DLJr0vK/image-20220307170743466.png" alt="image-20220307170743466"></p><p><strong>è¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯ä½ åªæ˜¯æƒ³å•ç‹¬å®šåˆ¶ï¼Œä½†ä¸å½±å“åˆ°å…¶ä»–ç»„ä»¶çš„æ ·å¼ï¼Œå¯ä»¥è¿™æ ·åšï¼š</strong></p><p>å®šä¹‰ <code>MyButtonç»„ä»¶</code></p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// MyButton.jsx</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">StyledIndex</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./style.js&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Button</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;antd&#x27;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">MyButton</span> (props) &#123;<br>    <span class="hljs-keyword">return</span> (<br>      <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">StyledIndex</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">StyledIndex</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;primary&quot;</span> &#123;<span class="hljs-attr">...props</span>&#125; <span class="hljs-attr">className</span>=<span class="hljs-string">&#123;</span>`<span class="hljs-attr">mybtu</span> $&#123;<span class="hljs-attr">props.className</span> || &#x27;&#x27;&#125;`&#125;&gt;</span>MyButton<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;/&gt;</span></span><br>    )<br>&#125;<br></code></pre></div></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// style.js</span><br><span class="hljs-keyword">import</span> &#123;createGlobalStyle&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;styled-components&quot;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">StyledIndex</span> = createGlobalStyle<span class="hljs-string">`</span><br><span class="hljs-string">// ç”¨ mybtu ç±»ååŒ…è£¹èµ·æ¥</span><br><span class="hljs-string">    .mybtu &#123;</span><br><span class="hljs-string">      &amp;.ant-btn-primary &#123;</span><br><span class="hljs-string">          background-color: orange;</span><br><span class="hljs-string">      &#125;</span><br><span class="hljs-string">    &#125;</span><br><span class="hljs-string">`</span><br></code></pre></div></td></tr></table></figure><p>ç„¶åå¼•å…¥åˆ° <code>index.js</code> å°±ä¼šå¾—åˆ°ï¼š</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// index.js</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Button</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;antd&#x27;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-title class_">MyButton</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./MyButton.jsx&quot;</span><br><br><span class="hljs-title class_">ReactDOM</span>.<span class="hljs-title function_">render</span>(<br>  <span class="language-xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="language-xml">     <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;primary&quot;</span>&gt;</span>Primary Button<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span><br><span class="language-xml">     <span class="hljs-tag">&lt;<span class="hljs-name">MyButton</span> /&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/&gt;</span></span>,<br>  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;container&#x27;</span>),<br>);<br></code></pre></div></td></tr></table></figure><p><img src="https://i.ibb.co/16Y1019/image-20220307171756082.png" alt="image-20220307171756082"></p><h3 id="05-åé¢çš„å­¦ä¹ åˆ°åœ¨ç»§ç»­æ›´æ–°"><a href="#05-åé¢çš„å­¦ä¹ åˆ°åœ¨ç»§ç»­æ›´æ–°" class="headerlink" title="05 åé¢çš„å­¦ä¹ åˆ°åœ¨ç»§ç»­æ›´æ–°"></a>05 åé¢çš„å­¦ä¹ åˆ°åœ¨ç»§ç»­æ›´æ–°</h3><p>ğŸŒŠç¿»æ»šå§åæµªâ€¦</p>]]></content>
    
    
    <categories>
      
      <category>CSS</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CSS</tag>
      
      <tag>Style-Components</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>React Hook åˆä½“éªŒ</title>
    <link href="/2022/03/02/React%20Hook%20%E5%88%9D%E4%BD%93%E9%AA%8C/"/>
    <url>/2022/03/02/React%20Hook%20%E5%88%9D%E4%BD%93%E9%AA%8C/</url>
    
    <content type="html"><![CDATA[<h1 id="React-Hook-åˆä½“éªŒ"><a href="#React-Hook-åˆä½“éªŒ" class="headerlink" title="React Hook åˆä½“éªŒ"></a>React Hook åˆä½“éªŒ</h1><h2 id="1-Hook-ç®€ä»‹"><a href="#1-Hook-ç®€ä»‹" class="headerlink" title="1.Hook ç®€ä»‹"></a>1.Hook ç®€ä»‹</h2><p>Hook æ˜¯ä¸€äº›å¯ä»¥è®©ä½ åœ¨å‡½æ•°ç»„ä»¶é‡Œâ€œé’©å…¥â€ React state åŠç”Ÿå‘½å‘¨æœŸç­‰ç‰¹æ€§çš„å‡½æ•°ã€‚Hook ä¸èƒ½åœ¨ class ç»„ä»¶ä¸­ä½¿ç”¨ â€”â€” è¿™ä½¿å¾—ä½ ä¸ä½¿ç”¨ class ä¹Ÿèƒ½ä½¿ç”¨ Reactã€‚</p><h2 id="2-åŠ¨æœº"><a href="#2-åŠ¨æœº" class="headerlink" title="2.åŠ¨æœº"></a>2.åŠ¨æœº</h2><p><a href="https://react.docschina.org/docs/hooks-intro.html#motivation">å®˜æ–¹è§£é‡Šï¼š</a></p><ol><li>ç»„ä»¶ä¹‹é—´å¤ç”¨çŠ¶æ€é€»è¾‘å¾ˆéš¾</li><li>å¤æ‚ç»„ä»¶å˜å¾—éš¾ä»¥ç†è§£</li><li>éš¾ä»¥ç†è§£çš„ class</li></ol><h2 id="3-Hook-è§„åˆ™"><a href="#3-Hook-è§„åˆ™" class="headerlink" title="3.Hook è§„åˆ™"></a>3.Hook è§„åˆ™</h2><h4 id="åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨-Hook"><a href="#åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨-Hook" class="headerlink" title="åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨ Hook"></a>åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨ Hook</h4><blockquote><p><strong>ä¸è¦åœ¨å¾ªç¯ï¼Œæ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hookï¼Œ</strong> ç¡®ä¿æ€»æ˜¯åœ¨ä½ çš„ React å‡½æ•°çš„æœ€é¡¶å±‚è°ƒç”¨ä»–ä»¬ã€‚</p></blockquote><h4 id="åªåœ¨-React-å‡½æ•°ä¸­è°ƒç”¨-Hook"><a href="#åªåœ¨-React-å‡½æ•°ä¸­è°ƒç”¨-Hook" class="headerlink" title="åªåœ¨ React å‡½æ•°ä¸­è°ƒç”¨ Hook"></a>åªåœ¨ React å‡½æ•°ä¸­è°ƒç”¨ Hook</h4><p><strong>ä¸è¦åœ¨æ™®é€šçš„ JavaScript å‡½æ•°ä¸­è°ƒç”¨ Hookã€‚</strong>ä½ å¯ä»¥ï¼š</p><ul><li>âœ… åœ¨ React çš„å‡½æ•°ç»„ä»¶ä¸­è°ƒç”¨ Hook</li><li>âœ… åœ¨è‡ªå®šä¹‰ Hook ä¸­è°ƒç”¨å…¶ä»– Hook</li></ul><h2 id="4-åŸºç¡€-Hook"><a href="#4-åŸºç¡€-Hook" class="headerlink" title="4.åŸºç¡€ Hook"></a>4.åŸºç¡€ Hook</h2><h3 id="useState"><a href="#useState" class="headerlink" title="useState"></a>useState</h3><p>function ç»„ä»¶ç¤ºä¾‹ï¼š</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Example</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">// å£°æ˜ä¸€ä¸ªå« &quot;count&quot; çš„ state å˜é‡</span><br>  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>)<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>You clicked &#123;count&#125; times<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> setCount(count + 1)&#125;&gt;Click me<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  )<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç­‰ä»·çš„ Class ç¤ºä¾‹ï¼š</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Example</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) &#123;<br>    <span class="hljs-variable language_">super</span>(props)<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = &#123;<br>      <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> (<br>      <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>You clicked &#123;this.state.count&#125; times<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> this.setState(&#123; count: this.state.count + 1 &#125;)&#125;&gt;</span><br><span class="language-xml">          Click me</span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>    )<br>  &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><h3 id="useEffect"><a href="#useEffect" class="headerlink" title="useEffect"></a>useEffect</h3><blockquote><p><em>Effect Hook</em> å¯ä»¥è®©ä½ åœ¨å‡½æ•°ç»„ä»¶ä¸­æ‰§è¡Œå‰¯ä½œç”¨æ“ä½œ</p></blockquote><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, &#123; useState, useEffect &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Example</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>)<br><br>  <span class="hljs-comment">// Similar to componentDidMount and componentDidUpdate:</span><br>  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-comment">// Update the document title using the browser API</span><br>    <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">`You clicked <span class="hljs-subst">$&#123;count&#125;</span> times`</span><br>  &#125;)<br>  <span class="hljs-keyword">return</span> (<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>You clicked &#123;count&#125; times<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> setCount(count + 1)&#125;&gt;Click me<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br>  )<br>&#125;<br></code></pre></div></td></tr></table></figure><blockquote><p>æç¤º</p><p>å¦‚æœä½ ç†Ÿæ‚‰ React class çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œä½ å¯ä»¥æŠŠ <code>useEffect</code> Hook çœ‹åš <code>componentDidMount</code>ï¼Œ<code>componentDidUpdate</code> å’Œ <code>componentWillUnmount</code> è¿™ä¸‰ä¸ªå‡½æ•°çš„ç»„åˆã€‚</p></blockquote><h4 id="æ— éœ€æ¸…é™¤çš„-effect"><a href="#æ— éœ€æ¸…é™¤çš„-effect" class="headerlink" title="æ— éœ€æ¸…é™¤çš„ effect"></a>æ— éœ€æ¸…é™¤çš„ effect</h4><p>ä½¿ç”¨ class çš„ç¤ºä¾‹ï¼š</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// å®æ—¶æ›´æ–°æ ‡ç­¾é¡µ title</span><br><span class="hljs-title function_">componentDidMount</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">`You clicked <span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.state.count&#125;</span> times`</span>;<br>&#125;<br><span class="hljs-title function_">componentDidUpdate</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">`You clicked <span class="hljs-subst">$&#123;<span class="hljs-variable language_">this</span>.state.count&#125;</span> times`</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å½“ä½ ä½¿ç”¨ hookï¼š</p><figure class="highlight jsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs jsx"><span class="hljs-comment">// å½“ç»„ä»¶é‡æ–°æ¸²æŸ“ä¹‹åå°±ä¼šæ‰§è¡Œ</span><br><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">`You clicked <span class="hljs-subst">$&#123;count&#125;</span> times`</span><br>&#125;)<br></code></pre></div></td></tr></table></figure><h4 id="éœ€è¦æ¸…é™¤çš„-effect"><a href="#éœ€è¦æ¸…é™¤çš„-effect" class="headerlink" title="éœ€è¦æ¸…é™¤çš„ effect"></a>éœ€è¦æ¸…é™¤çš„ effect</h4><p>ä½¿ç”¨ class çš„ç¤ºä¾‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// é€šå¸¸ä¼šåœ¨ componentDidMount ä¸­è®¾ç½®è®¢é˜…ï¼Œå¹¶åœ¨ componentWillUnmount ä¸­æ¸…é™¤å®ƒã€‚ä¾‹å¦‚ï¼šè®¢é˜…-å‘å¸ƒ</span><br><span class="hljs-title function_">componentDidMount</span>(<span class="hljs-params"></span>) &#123;<br>     <span class="hljs-title class_">ChatAPI</span>.<span class="hljs-title function_">subscribeToFriendStatus</span>(<br>         <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>.<span class="hljs-property">friend</span>.<span class="hljs-property">id</span>,<br>     );<br> &#125;<br><span class="hljs-title function_">componentWillUnmount</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-title class_">ChatAPI</span>.<span class="hljs-title function_">unsubscribeFromFriendStatus</span>(<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>.<span class="hljs-property">friend</span>.<span class="hljs-property">id</span>,<br>    );<br>&#125;<br></code></pre></div></td></tr></table></figure><p>å½“ä½ ä½¿ç”¨ hookï¼š</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// effect ä¸­è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè¿™æ˜¯ effect å¯é€‰çš„æ¸…é™¤æœºåˆ¶ã€‚æ¯ä¸ª effect éƒ½å¯ä»¥è¿”å›ä¸€ä¸ªæ¸…é™¤å‡½æ•°ã€‚React ä¼šåœ¨ç»„ä»¶å¸è½½çš„æ—¶å€™æ‰§è¡Œæ¸…é™¤æ“ä½œã€‚æ­£å¦‚ä¹‹å‰å­¦åˆ°çš„ï¼Œeffect åœ¨æ¯æ¬¡æ¸²æŸ“çš„æ—¶å€™éƒ½ä¼šæ‰§è¡Œã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ React ä¼šåœ¨æ‰§è¡Œå½“å‰ effect ä¹‹å‰å¯¹ä¸Šä¸€ä¸ª effect è¿›è¡Œæ¸…é™¤ã€‚</span><br><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-title class_">ChatAPI</span>.<span class="hljs-title function_">subscribeToFriendStatus</span>(props.<span class="hljs-property">friend</span>.<span class="hljs-property">id</span>)<br>  <span class="hljs-comment">// æ¸…é™¤è®¢é˜…</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-title class_">ChatAPI</span>.<span class="hljs-title function_">unsubscribeFromFriendStatus</span>(props.<span class="hljs-property">friend</span>.<span class="hljs-property">id</span>)<br>  &#125;<br>&#125;)<br></code></pre></div></td></tr></table></figure><h2 id="5-é¢å¤–çš„-Hook"><a href="#5-é¢å¤–çš„-Hook" class="headerlink" title="5.é¢å¤–çš„ Hook"></a>5.é¢å¤–çš„ Hook</h2><h2 id="6-è‡ªå®šä¹‰-Hook"><a href="#6-è‡ªå®šä¹‰-Hook" class="headerlink" title="6.è‡ªå®šä¹‰ Hook"></a>6.è‡ªå®šä¹‰ Hook</h2>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
    </categories>
    
    
    <tags>
      
      <tag>React</tag>
      
      <tag>React-Hook</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>npx åˆ‡æ¢ä¸åŒç‰ˆæœ¬çš„ node ğŸ˜²</title>
    <link href="/2022/02/25/npx%20%E5%88%87%E6%8D%A2%E4%B8%8D%E5%90%8C%E7%89%88%E6%9C%AC%E7%9A%84%20node%20%F0%9F%98%B2/"/>
    <url>/2022/02/25/npx%20%E5%88%87%E6%8D%A2%E4%B8%8D%E5%90%8C%E7%89%88%E6%9C%AC%E7%9A%84%20node%20%F0%9F%98%B2/</url>
    
    <content type="html"><![CDATA[<h2 id="npx-åˆ‡æ¢ä¸åŒç‰ˆæœ¬çš„-node-ğŸ˜²"><a href="#npx-åˆ‡æ¢ä¸åŒç‰ˆæœ¬çš„-node-ğŸ˜²" class="headerlink" title="npx åˆ‡æ¢ä¸åŒç‰ˆæœ¬çš„ node ğŸ˜²"></a>npx åˆ‡æ¢ä¸åŒç‰ˆæœ¬çš„ node ğŸ˜²</h2><p>å¶ç„¶å‘ç° <code>node</code> çš„ <code>npx</code> å¯ä»¥åˆ‡æ¢ä¸åŒç‰ˆæœ¬çš„ <code>node</code>,å¦¥å¦¥çš„ node ç‰ˆæœ¬ç®¡ç†å·¥å…·ã€‚ä¹‹å‰ä¹Ÿè¯•è¿‡ <code>nvm</code> ï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œä¸ªäººæ„Ÿè§‰ <code>npx</code> æ›´æ–¹ä¾¿ç‚¹ã€‚</p><h3 id="01-åŸç†"><a href="#01-åŸç†" class="headerlink" title="01 åŸç†"></a>01 åŸç†</h3><blockquote><p>åˆ©ç”¨ npx å¯ä»¥ä¸‹è½½æ¨¡å—è¿™ä¸ªç‰¹ç‚¹ï¼Œå¯ä»¥æŒ‡å®šæŸä¸ªç‰ˆæœ¬çš„ Node è¿è¡Œè„šæœ¬ã€‚å®ƒçš„çªé—¨å°±æ˜¯ä½¿ç”¨ npm çš„ <a href="https://www.npmjs.com/package/node">node æ¨¡å—</a>ã€‚</p></blockquote><p>å…·ä½“çš„ <code>npx</code> è¯­æ³•ï¼Œå¯ä»¥å‚è€ƒé˜®ä¸€å³°è€å¸ˆï¼Œ[æ­¤å¤„](<a href="http://www.ruanyifeng.com/blog/2019/02/npx.html">npx ä½¿ç”¨æ•™ç¨‹ - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿— (ruanyifeng.com)</a>)</p><h3 id="02-ç¤ºä¾‹"><a href="#02-ç¤ºä¾‹" class="headerlink" title="02 ç¤ºä¾‹"></a>02 ç¤ºä¾‹</h3><p>æ¨¡æ‹Ÿä¸€ä¸ªéœ€è¦ <code>node@12.xx.xx</code> æ‰èƒ½å¯åŠ¨çš„é¡¹ç›®</p><p>ä½¿ç”¨ npx ä¸‹è½½å¯¹åº” node ç‰ˆæœ¬æ¨¡å—</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">$ npx node@12.9.1 -v<br>v12.9.1<br></code></pre></div></td></tr></table></figure><p>æ‰¾åˆ°éœ€è¦å¯åŠ¨é¡¹ç›®çš„ç›®å½•ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">$ npx -p node@12.9.1 npm start<br></code></pre></div></td></tr></table></figure><p>é¡¹ç›®å¯åŠ¨æˆåŠŸâ€¦</p>]]></content>
    
    
    <categories>
      
      <category>Node</category>
      
    </categories>
    
    
    <tags>
      
      <tag>npx</tag>
      
      <tag>node</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TypeScript é‚£äº›äº‹å„¿</title>
    <link href="/2022/02/21/TypeScript%20%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/"/>
    <url>/2022/02/21/TypeScript%20%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/</url>
    
    <content type="html"><![CDATA[<h2 id="TypeScript-é‚£äº›äº‹å„¿"><a href="#TypeScript-é‚£äº›äº‹å„¿" class="headerlink" title="TypeScript é‚£äº›äº‹å„¿"></a>TypeScript é‚£äº›äº‹å„¿</h2><h3 id="01-å˜é‡ç±»å‹-ğŸ˜Š"><a href="#01-å˜é‡ç±»å‹-ğŸ˜Š" class="headerlink" title="01 å˜é‡ç±»å‹ ğŸ˜Š"></a>01 å˜é‡ç±»å‹ ğŸ˜Š</h3><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">let</span> å˜é‡å : å˜é‡ç±»å‹ = value<br><span class="hljs-keyword">function</span> (<span class="hljs-params"> å˜é‡åï¼šå˜é‡ç±»å‹ </span>): å˜é‡ç±»å‹&#123;&#125;<br></code></pre></div></td></tr></table></figure><h4 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h4><table><thead><tr><th>ç±»å‹</th><th>ä¾‹å­</th><th align="center">æè¿°</th></tr></thead><tbody><tr><td>number</td><td>1,22,2.5</td><td align="center">ä»»æ„æ•°å­—</td></tr><tr><td>string</td><td>â€˜DuoRâ€™,â€bbbâ€</td><td align="center">ä»»æ„å­—ç¬¦ä¸²</td></tr><tr><td>boolean</td><td>true,false</td><td align="center"></td></tr><tr><td>å­—é¢é‡</td><td>å…¶æœ¬èº«</td><td align="center">é™åˆ¶å˜é‡çš„å€¼å°±æ˜¯è¯¥å­—é¢é‡çš„å€¼</td></tr><tr><td>any</td><td>*</td><td align="center">ä»»æ„ç±»å‹</td></tr><tr><td>unknown</td><td>*</td><td align="center">ç±»å‹å®‰å…¨çš„ any</td></tr><tr><td>void</td><td>ç©ºå€¼ undefined</td><td align="center">æ²¡æœ‰å€¼</td></tr><tr><td>never</td><td>æ²¡æœ‰å€¼</td><td align="center">ä¸èƒ½æ˜¯ä»»ä½•å€¼</td></tr><tr><td>object</td><td>å¯¹è±¡å€¼</td><td align="center">js Object</td></tr><tr><td>array</td><td>[1,2,3,]</td><td align="center">js array</td></tr><tr><td>tuple</td><td>[4,5]</td><td align="center">å…ƒç»„ï¼Œè¡¨ç¤ºä¸€ä¸ªå·²çŸ¥å…ƒç´ æ•°é‡å’Œç±»å‹çš„æ•°ç»„</td></tr><tr><td>enum</td><td>enum{A,B}</td><td align="center">æšä¸¾</td></tr><tr><td>è”åˆå£°æ˜</td><td>boolean | string</td><td align="center">å¯ä»¥æ˜¯ boolean å’Œ string ç±»å‹</td></tr></tbody></table><ul><li><p>å˜é‡ç±»å‹ä¹‹é—´æ˜¯ä¸å¯ä»¥äº’ç›¸èµ‹å€¼çš„ï¼Œå¦åˆ™ä¼šæŠ¥é”™</p></li><li><p>å£°æ˜å’Œèµ‹å€¼æ˜¯åŒæ—¶è¿›è¡Œçš„ï¼ŒTS å¯ä»¥è‡ªåŠ¨å¯¹ç±»å‹è¿›è¡Œæ£€æµ‹,å¯ä»¥çœç•¥å®šä¹‰ç±»å‹çš„æ­¥éª¤</p></li><li><p>ç±»å‹æ–­è¨€ï¼Œ<code>å˜é‡1 = &lt;å˜é‡ç±»å‹&gt; å˜é‡å2 æˆ– å˜é‡1 = å˜é‡å2 as å˜é‡ç±»å‹</code></p></li><li><p>ç±»å‹çš„åˆ«å, <code>type è‡ªå®šä¹‰ç±»å‹å = å˜é‡ç±»å‹ï¼ˆ|ï¼Œ&amp;ï¼‰</code></p></li><li><p>typescrpt 3.4 å¼•å…¥ readonly, ä¿®é¥°åï¼Œå˜é‡åªè¯»:</p></li></ul><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-attr">arr</span>: readonly string[]= [<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>]<br></code></pre></div></td></tr></table></figure><p><strong>æ³¨æ„ç‚¹ï¼š</strong></p><p>a. åœ¨ <code>tsconfig.json</code> æŒ‡å®šäº†<code>&quot;strictNullChecks&quot;:false</code>ï¼Œ<code>undefined</code> ä¸ <code>null</code> æ˜¯å¯ä»¥èµ‹å€¼åˆ°å…¶ä»–ç±»å‹çš„ï¼ˆstring/numâ€¦ï¼‰,å¦åˆ™ï¼Œ<code>null</code> å’Œ <code>undefined</code> åªèƒ½èµ‹å€¼ç»™ <code>void</code> å’Œå®ƒä»¬å„è‡ªçš„ç±»å‹ã€‚</p><p>b. <code>number</code> å’Œ <code>bigint</code> éƒ½æ˜¯è¡¨ç¤ºæ•°å­—ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªç±»<code>ç›¸äº’ä¸å…¼å®¹çš„</code></p><h4 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h4><figure class="highlight tsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tsx"><span class="hljs-comment">// å‡½æ•°å£°æ˜</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">sum</span>(<span class="hljs-params">num1: <span class="hljs-built_in">number</span>, num2: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> &#123;<br>  <span class="hljs-keyword">return</span> num1 + num2<br>&#125;<br><br><span class="hljs-comment">// å‡½æ•°è¡¨è¾¾å¼</span><br><span class="hljs-title function_">sum</span>(<span class="hljs-number">98</span>, <span class="hljs-number">29</span>)<br><br><span class="hljs-keyword">let</span> sub = (<span class="hljs-attr">num1</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">num2</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> &#123;<br>  <span class="hljs-keyword">return</span> num1 - num2<br>&#125;<br><span class="hljs-title function_">sub</span>(<span class="hljs-number">98</span>, <span class="hljs-number">29</span>)<br><br><span class="hljs-comment">// å‡½æ•°é‡è½½</span><br><span class="hljs-keyword">type</span> <span class="hljs-title class_">Types</span> = <span class="hljs-built_in">number</span> | <span class="hljs-built_in">string</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">string</span>, b: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">string</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">string</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">string</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">string</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: Types, b: Types</span>) &#123;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> a === <span class="hljs-string">&#x27;string&#x27;</span> || <span class="hljs-keyword">typeof</span> b === <span class="hljs-string">&#x27;string&#x27;</span>) &#123;<br>    <span class="hljs-keyword">return</span> a.<span class="hljs-title function_">toString</span>() + b.<span class="hljs-title function_">toString</span>()<br>  &#125;<br>  <span class="hljs-keyword">return</span> a + b<br>&#125;<br><span class="hljs-title function_">add</span>(<span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-string">&#x27;2&#x27;</span>).<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></div></td></tr></table></figure><h4 id="ç‰¹åˆ«çš„ç±»å‹"><a href="#ç‰¹åˆ«çš„ç±»å‹" class="headerlink" title="ç‰¹åˆ«çš„ç±»å‹"></a>ç‰¹åˆ«çš„ç±»å‹</h4><h5 id="never"><a href="#never" class="headerlink" title="never"></a>never</h5><blockquote><p>è¡¨ç¤ºçš„æ˜¯é‚£äº›æ°¸ä¸å­˜åœ¨çš„å€¼çš„ç±»å‹</p></blockquote><p>ä¸¤ç§æƒ…å†µï¼š</p><figure class="highlight tsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tsx"><span class="hljs-comment">// å¼‚å¸¸</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">err</span>(<span class="hljs-params">msg: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">never</span> &#123;<br>  <span class="hljs-comment">// OK</span><br>  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(msg)<br>&#125;<br><br><span class="hljs-comment">// æ­»å¾ªç¯</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">loopForever</span>(<span class="hljs-params"></span>): <span class="hljs-built_in">never</span> &#123;<br>  <span class="hljs-comment">// OK</span><br>  <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>ç‰¹åˆ«ç”¨æ³•ï¼š</p><figure class="highlight tsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tsx"><span class="hljs-comment">// åˆ©ç”¨ never ç±»å‹çš„ç‰¹æ€§æ¥å®ç°å…¨é¢æ€§æ£€æŸ¥</span><br><span class="hljs-keyword">type</span> <span class="hljs-title class_">Foo</span> = <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">controlFlowAnalysisWithNever</span>(<span class="hljs-params">foo: Foo</span>) &#123;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> foo === <span class="hljs-string">&#x27;string&#x27;</span>) &#123;<br>    <span class="hljs-comment">// è¿™é‡Œ foo è¢«æ”¶çª„ä¸º string ç±»å‹</span><br>  &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> foo === <span class="hljs-string">&#x27;number&#x27;</span>) &#123;<br>    <span class="hljs-comment">// è¿™é‡Œ foo è¢«æ”¶çª„ä¸º number ç±»å‹</span><br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">// foo åœ¨è¿™é‡Œæ˜¯ never</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-attr">check</span>: <span class="hljs-built_in">never</span> = foo<br>  &#125;<br>&#125;<br><span class="hljs-comment">// å‡å¦‚å“ªä¸€å¤©Fooæ–°å¢booleanï¼Œtså°±ä¼šæŠ›å‡ºä¸€ä¸ªäº§ç”Ÿä¸€ä¸ªç¼–è¯‘é”™è¯¯ã€‚ç¡®ä¿ controlFlowAnalysisWithNever æ–¹æ³•æ€»æ˜¯ç©·å°½äº† Foo çš„æ‰€æœ‰å¯èƒ½ç±»å‹ã€‚</span><br><span class="hljs-keyword">type</span> <span class="hljs-title class_">Foo</span> = <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span> | <span class="hljs-built_in">boolean</span><br><span class="hljs-comment">// ä½¿ç”¨ never é¿å…å‡ºç°æ–°å¢äº†è”åˆç±»å‹æ²¡æœ‰å¯¹åº”çš„å®ç°ï¼Œç›®çš„å°±æ˜¯å†™å‡ºç±»å‹ç»å¯¹å®‰å…¨çš„ä»£ç ã€‚</span><br></code></pre></div></td></tr></table></figure><h5 id="unknown"><a href="#unknown" class="headerlink" title="unknown"></a>unknown</h5><blockquote><p>unknown<code>ä¸</code>any<code>çš„æœ€å¤§åŒºåˆ«æ˜¯ï¼š ä»»ä½•ç±»å‹çš„å€¼å¯ä»¥èµ‹å€¼ç»™</code>any<code>ï¼ŒåŒæ—¶</code>any<code>ç±»å‹çš„å€¼ä¹Ÿå¯ä»¥èµ‹å€¼ç»™ä»»ä½•ç±»å‹ã€‚</code>unknown<code> ä»»ä½•ç±»å‹çš„å€¼éƒ½å¯ä»¥èµ‹å€¼ç»™å®ƒï¼Œä½†å®ƒåªèƒ½èµ‹å€¼ç»™</code>unknown<code>å’Œ</code>any</p></blockquote><figure class="highlight tsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tsx"><span class="hljs-comment">// è¿™ç§æœºåˆ¶èµ·åˆ°äº†å¾ˆå¼ºçš„é¢„é˜²æ€§ï¼Œæ›´å®‰å…¨ï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬å¿…é¡»ç¼©å°ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨typeofã€ç±»å‹æ–­è¨€ç­‰æ–¹å¼æ¥ç¼©å°æœªçŸ¥èŒƒå›´ï¼š</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getDogName</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">let</span> <span class="hljs-attr">x</span>: unknown<br>  <span class="hljs-keyword">return</span> x<br>&#125;<br><span class="hljs-keyword">const</span> dogName = <span class="hljs-title function_">getDogName</span>()<br><span class="hljs-comment">// ç›´æ¥ä½¿ç”¨</span><br><span class="hljs-keyword">const</span> upName = dogName.<span class="hljs-title function_">toLowerCase</span>() <span class="hljs-comment">// Error</span><br><span class="hljs-comment">// typeof</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> dogName === <span class="hljs-string">&#x27;string&#x27;</span>) &#123;<br>  <span class="hljs-keyword">const</span> upName = dogName.<span class="hljs-title function_">toLowerCase</span>() <span class="hljs-comment">// OK</span><br>&#125;<br><span class="hljs-comment">// ç±»å‹æ–­è¨€</span><br><span class="hljs-keyword">const</span> upName = (dogName <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>).<span class="hljs-title function_">toLowerCase</span>() <span class="hljs-comment">// OK</span><br></code></pre></div></td></tr></table></figure><h5 id="Numberã€Stringã€Booleanã€Symbol"><a href="#Numberã€Stringã€Booleanã€Symbol" class="headerlink" title="Numberã€Stringã€Booleanã€Symbol"></a>Numberã€Stringã€Booleanã€Symbol</h5><blockquote><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹åˆå­¦ TypeScript æ—¶ï¼Œå¾ˆå®¹æ˜“å’ŒåŸå§‹ç±»å‹ numberã€stringã€booleanã€symbol æ··æ·†çš„é¦–å­—æ¯å¤§å†™çš„ Numberã€Stringã€Booleanã€Symbol ç±»å‹ï¼Œåè€…æ˜¯ç›¸åº”åŸå§‹ç±»å‹çš„<code>åŒ…è£…å¯¹è±¡</code>ï¼Œå§‘ä¸”æŠŠå®ƒä»¬ç§°ä¹‹ä¸ºå¯¹è±¡ç±»å‹ã€‚</p></blockquote><p>ä»ç±»å‹å…¼å®¹æ€§ä¸Šçœ‹ï¼ŒåŸå§‹ç±»å‹å…¼å®¹å¯¹åº”çš„å¯¹è±¡ç±»å‹ï¼Œåè¿‡æ¥å¯¹è±¡ç±»å‹ä¸å…¼å®¹å¯¹åº”çš„åŸå§‹ç±»å‹ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸ªå…·ä½“çš„ç¤ºä¾‹ï¼š</p><figure class="highlight tsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tsx"><span class="hljs-keyword">let</span> <span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span><br><span class="hljs-keyword">let</span> <span class="hljs-title class_">Num</span>: <span class="hljs-title class_">Number</span><br><span class="hljs-title class_">Num</span> = num <span class="hljs-comment">// ok</span><br>num = <span class="hljs-title class_">Num</span> <span class="hljs-comment">// ts(2322)æŠ¥é”™</span><br></code></pre></div></td></tr></table></figure><p><strong>æ­¤ï¼Œæˆ‘ä»¬éœ€è¦é“­è®°ä¸è¦ä½¿ç”¨å¯¹è±¡ç±»å‹æ¥æ³¨è§£å€¼çš„ç±»å‹ï¼Œå› ä¸ºè¿™æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚</strong></p><h5 id="objectã€Object-å’Œ"><a href="#objectã€Object-å’Œ" class="headerlink" title="objectã€Object å’Œ {}"></a>objectã€Object å’Œ {}</h5><blockquote><p>å¦å¤–ï¼Œobjectï¼ˆé¦–å­—æ¯å°å†™ï¼Œä»¥ä¸‹ç§°â€œå° objectâ€ï¼‰ã€Objectï¼ˆé¦–å­—æ¯å¤§å†™ï¼Œä»¥ä¸‹ç§°â€œå¤§ Objectâ€ï¼‰å’Œ {}ï¼ˆä»¥ä¸‹ç§°â€œç©ºå¯¹è±¡â€ï¼‰</p></blockquote><p>å° object ä»£è¡¨çš„æ˜¯æ‰€æœ‰éåŸå§‹ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¸èƒ½æŠŠ numberã€stringã€booleanã€symbol ç­‰ åŸå§‹ç±»å‹èµ‹å€¼ç»™ objectã€‚åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œ<code>null</code> å’Œ <code>undefined</code> ç±»å‹ä¹Ÿä¸èƒ½èµ‹ç»™ objectã€‚</p><figure class="highlight tsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tsx"><span class="hljs-comment">// object</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">lowerCaseObject</span>: <span class="hljs-built_in">object</span><br>lowerCaseObject = <span class="hljs-number">1</span> <span class="hljs-comment">// ts(2322)</span><br>lowerCaseObject = <span class="hljs-string">&#x27;a&#x27;</span> <span class="hljs-comment">// ts(2322)</span><br>lowerCaseObject = <span class="hljs-literal">true</span> <span class="hljs-comment">// ts(2322)</span><br>lowerCaseObject = <span class="hljs-literal">null</span> <span class="hljs-comment">// ts(2322)</span><br>lowerCaseObject = <span class="hljs-literal">undefined</span> <span class="hljs-comment">// ts(2322)</span><br>lowerCaseObject = &#123;&#125; <span class="hljs-comment">// ok</span><br></code></pre></div></td></tr></table></figure><p>å¤§ Object ä»£è¡¨æ‰€æœ‰æ‹¥æœ‰ toStringã€hasOwnProperty æ–¹æ³•çš„ç±»å‹ï¼Œæ‰€ä»¥æ‰€æœ‰åŸå§‹ç±»å‹ã€éåŸå§‹ç±»å‹éƒ½å¯ä»¥èµ‹ç»™ Objectã€‚åŒæ ·ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œnull å’Œ undefined ç±»å‹ä¹Ÿä¸èƒ½èµ‹ç»™ Objectã€‚</p><figure class="highlight tsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tsx"><span class="hljs-comment">// Object</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">upperCaseObject</span>: <span class="hljs-title class_">Object</span><br>upperCaseObject = <span class="hljs-number">1</span> <span class="hljs-comment">// ok</span><br>upperCaseObject = <span class="hljs-string">&#x27;a&#x27;</span> <span class="hljs-comment">// ok</span><br>upperCaseObject = <span class="hljs-literal">true</span> <span class="hljs-comment">// ok</span><br>upperCaseObject = <span class="hljs-literal">null</span> <span class="hljs-comment">// ts(2322)</span><br>upperCaseObject = <span class="hljs-literal">undefined</span> <span class="hljs-comment">// ts(2322)</span><br>upperCaseObject = &#123;&#125; <span class="hljs-comment">// ok</span><br></code></pre></div></td></tr></table></figure><p><strong>ç»¼ä¸Šç»“è®ºï¼š{}ã€å¤§ Object æ˜¯æ¯”å° object æ›´å®½æ³›çš„ç±»å‹ï¼ˆleast specificï¼‰ï¼Œ{} å’Œå¤§ Object å¯ä»¥äº’ç›¸ä»£æ›¿ï¼Œç”¨æ¥è¡¨ç¤ºåŸå§‹ç±»å‹ï¼ˆnullã€undefined é™¤å¤–ï¼‰å’ŒéåŸå§‹ç±»å‹ï¼›è€Œå° object åˆ™è¡¨ç¤ºéåŸå§‹ç±»å‹ã€‚</strong></p><h5 id="å­—é¢é‡"><a href="#å­—é¢é‡" class="headerlink" title="å­—é¢é‡"></a>å­—é¢é‡</h5><blockquote><p>åœ¨ TypeScript ä¸­ï¼Œå­—é¢é‡ä¸ä»…å¯ä»¥è¡¨ç¤ºå€¼ï¼Œè¿˜å¯ä»¥è¡¨ç¤ºç±»å‹ï¼Œå³æ‰€è°“çš„å­—é¢é‡ç±»å‹ã€‚</p></blockquote><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// ç›®å‰ï¼ŒTypeScript æ”¯æŒ 3 ç§å­—é¢é‡ç±»å‹ï¼šå­—ç¬¦ä¸²å­—é¢é‡ç±»å‹ã€æ•°å­—å­—é¢é‡ç±»å‹ã€å¸ƒå°”å­—é¢é‡ç±»å‹</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">specifiedStr</span>: <span class="hljs-string">&#x27;this is string&#x27;</span> = <span class="hljs-string">&#x27;this is string&#x27;</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">specifiedNum</span>: <span class="hljs-number">1</span> = <span class="hljs-number">1</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">specifiedBoolean</span>: <span class="hljs-literal">true</span> = <span class="hljs-literal">true</span><br></code></pre></div></td></tr></table></figure><p>åº”ç”¨åœºæ™¯ï¼š</p><p>æ¯”å¦‚å£°æ˜å¦‚ä¸‹æ‰€ç¤ºçš„ä¸€ä¸ªç±»å‹ Configï¼š</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js">interface <span class="hljs-title class_">Config</span> &#123;<br>  <span class="hljs-attr">size</span>: <span class="hljs-string">&#x27;small&#x27;</span> | <span class="hljs-string">&#x27;big&#x27;</span>;<br>  <span class="hljs-attr">isEnable</span>: <span class="hljs-literal">true</span> | <span class="hljs-literal">false</span>;<br>  <span class="hljs-attr">margin</span>: <span class="hljs-number">0</span> | <span class="hljs-number">2</span> | <span class="hljs-number">4</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>éœ€è¦æ³¨æ„ :</p><p>åœ¨ç¼ºçœç±»å‹æ³¨è§£çš„æƒ…å†µä¸‹ï¼ŒTypeScript æ¨æ–­å‡ºå®ƒçš„ç±»å‹ç›´æ¥ç”±èµ‹å€¼å­—é¢é‡çš„ç±»å‹å†³å®š</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> str = <span class="hljs-string">&#x27;this is string&#x27;</span> <span class="hljs-comment">// str: &#x27;this is string&#x27;</span><br><span class="hljs-keyword">const</span> num = <span class="hljs-number">1</span> <span class="hljs-comment">// num: 1</span><br><span class="hljs-keyword">const</span> bool = <span class="hljs-literal">true</span> <span class="hljs-comment">// bool: true</span><br></code></pre></div></td></tr></table></figure><h3 id="02-ts-ä¸“ä¸šåè¯-ğŸ§"><a href="#02-ts-ä¸“ä¸šåè¯-ğŸ§" class="headerlink" title="02 ts ä¸“ä¸šåè¯ ğŸ§"></a>02 ts ä¸“ä¸šåè¯ ğŸ§</h3><h4 id="ç±»å‹æ¨æ–­"><a href="#ç±»å‹æ¨æ–­" class="headerlink" title="ç±»å‹æ¨æ–­"></a>ç±»å‹æ¨æ–­</h4><blockquote><p>åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼ŒTypeScript ä¼šæ ¹æ®ä¸Šä¸‹æ–‡ç¯å¢ƒè‡ªåŠ¨æ¨æ–­å‡ºå˜é‡çš„ç±»å‹ï¼Œæ— é¡»æˆ‘ä»¬å†å†™æ˜ç±»å‹æ³¨è§£ã€‚</p></blockquote><figure class="highlight tsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tsx"><span class="hljs-keyword">let</span> <span class="hljs-attr">str</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">&#x27;I am a string&#x27;</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">bool</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">true</span><br><span class="hljs-comment">// ç®€åŒ–å -----&gt;</span><br><span class="hljs-keyword">let</span> str = <span class="hljs-string">&#x27;I am a string&#x27;</span><br><span class="hljs-keyword">let</span> num = <span class="hljs-number">1</span><br><span class="hljs-keyword">let</span> bool = <span class="hljs-literal">true</span><br></code></pre></div></td></tr></table></figure><p>æˆ‘ä»¬æŠŠ TypeScript è¿™ç§åŸºäºèµ‹å€¼è¡¨è¾¾å¼æ¨æ–­ç±»å‹çš„èƒ½åŠ›ç§°ä¹‹ä¸º<code>ç±»å‹æ¨æ–­</code></p><p>åœ¨ TypeScript ä¸­ï¼Œå…·æœ‰åˆå§‹åŒ–å€¼çš„å˜é‡ã€æœ‰é»˜è®¤å€¼çš„å‡½æ•°å‚æ•°ã€å‡½æ•°è¿”å›çš„ç±»å‹éƒ½å¯ä»¥æ ¹æ®ä¸Šä¸‹æ–‡æ¨æ–­å‡ºæ¥ã€‚æ¯”å¦‚æˆ‘ä»¬èƒ½æ ¹æ® return è¯­å¥æ¨æ–­å‡½æ•°è¿”å›çš„ç±»å‹ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š</p><figure class="highlight tsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tsx"><span class="hljs-comment">/** æ ¹æ®å‚æ•°çš„ç±»å‹ï¼Œæ¨æ–­å‡ºè¿”å›å€¼çš„ç±»å‹ä¹Ÿæ˜¯ number */</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">add1</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>) &#123;<br>  <span class="hljs-keyword">return</span> a + b<br>&#125;<br><span class="hljs-keyword">const</span> x1 = <span class="hljs-title function_">add1</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>) <span class="hljs-comment">// æ¨æ–­å‡º x1 çš„ç±»å‹ä¹Ÿæ˜¯ number</span><br><br><span class="hljs-comment">/** æ¨æ–­å‚æ•° b çš„ç±»å‹æ˜¯æ•°å­—æˆ–è€… undefinedï¼Œè¿”å›å€¼çš„ç±»å‹ä¹Ÿæ˜¯æ•°å­— */</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">add2</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b = <span class="hljs-number">1</span></span>) &#123;<br>  <span class="hljs-keyword">return</span> a + b<br>&#125;<br><span class="hljs-keyword">const</span> x2 = <span class="hljs-title function_">add2</span>(<span class="hljs-number">1</span>)<br><span class="hljs-keyword">const</span> x3 = <span class="hljs-title function_">add2</span>(<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;1&#x27;</span>) <span class="hljs-comment">// ts(2345) Argument of type &quot;1&quot; is not assignable to parameter of type &#x27;number | undefined</span><br></code></pre></div></td></tr></table></figure><p>ä½†ï¼å¦‚æœå®šä¹‰çš„æ—¶å€™æ²¡æœ‰èµ‹å€¼ï¼Œä¸ç®¡ä¹‹åæœ‰æ²¡æœ‰èµ‹å€¼ï¼Œéƒ½ä¼šè¢«æ¨æ–­æˆ any ç±»å‹è€Œå®Œå…¨ä¸è¢«ç±»å‹æ£€æŸ¥ã€‚</p><h4 id="ç±»å‹æ–­è¨€"><a href="#ç±»å‹æ–­è¨€" class="headerlink" title="ç±»å‹æ–­è¨€"></a>ç±»å‹æ–­è¨€</h4><p>TypeScript ç±»å‹æ£€æµ‹æ— æ³•åšåˆ°ç»å¯¹æ™ºèƒ½ï¼Œæ¯•ç«Ÿç¨‹åºä¸èƒ½åƒäººä¸€æ ·æ€è€ƒã€‚æœ‰æ—¶ä¼šç¢°åˆ°æˆ‘ä»¬æ¯” TypeScript æ›´æ¸…æ¥šå®é™…ç±»å‹çš„æƒ…å†µï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š</p><figure class="highlight tsx"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs tsx"><span class="hljs-keyword">const</span> <span class="hljs-attr">arrayNumber</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<br><span class="hljs-keyword">const</span> <span class="hljs-attr">greaterThan2</span>: <span class="hljs-built_in">number</span> = arrayNumber.<span class="hljs-title function_">find</span>(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num &gt; <span class="hljs-number">2</span>) <span class="hljs-comment">// æç¤º ts(2322),æœ‰å¯èƒ½æ˜¯ undefinded æˆ– number</span><br><br><span class="hljs-comment">// åŠ å…¥ç±»å‹æ£€æµ‹</span><br><br><span class="hljs-keyword">const</span> <span class="hljs-attr">arrayNumber</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<br><span class="hljs-keyword">const</span> <span class="hljs-attr">greaterThan2</span>: <span class="hljs-built_in">number</span> = arrayNumber.<span class="hljs-title function_">find</span>(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num &gt; <span class="hljs-number">2</span>) <span class="hljs-keyword">as</span> <span class="hljs-built_in">number</span> <span class="hljs-comment">// ok</span><br></code></pre></div></td></tr></table></figure><h5 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h5><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">let</span> <span class="hljs-attr">str</span>: string = <span class="hljs-string">&quot;æˆ‘æ˜¯string&quot;</span><br><span class="hljs-comment">// ç›¸å½“äºè·³è¿‡ç±»å‹æ£€æµ‹</span><br><span class="hljs-comment">// 01 å°–æ‹¬å·</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>: number = &lt;number&gt;str;<br><span class="hljs-comment">// 02 as è¯­æ³•</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>: number = str <span class="hljs-keyword">as</span> number;<br></code></pre></div></td></tr></table></figure><h5 id="éç©ºæ–­è¨€"><a href="#éç©ºæ–­è¨€" class="headerlink" title="éç©ºæ–­è¨€"></a>éç©ºæ–­è¨€</h5><p>åœ¨ä¸Šä¸‹æ–‡ä¸­å½“ç±»å‹æ£€æŸ¥å™¨æ— æ³•æ–­å®šç±»å‹æ—¶,å¯ä»¥ä½¿ç”¨ <code>&quot;!&quot;</code>æ–­è¨€æ“ä½œå¯¹è±¡é null æˆ– undefined</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-comment">// ç¤ºä¾‹1</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">str</span>: <span class="hljs-literal">null</span> | <span class="hljs-literal">undefined</span> | string;<br>str.<span class="hljs-title function_">toString</span>() <span class="hljs-comment">// error</span><br>str!.<span class="hljs-title function_">toString</span>() <span class="hljs-comment">// ok</span><br><span class="hljs-comment">// ç¤ºä¾‹2</span><br>type <span class="hljs-title class_">Foo</span> = <span class="hljs-function">() =&gt;</span> number<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">myFun</span>(<span class="hljs-params">foo: Foo || <span class="hljs-literal">undefined</span></span>) &#123;<br>    <span class="hljs-title function_">foo</span>();<span class="hljs-comment">// error</span><br>    foo!(); <span class="hljs-comment">//ok</span><br>&#125;<br></code></pre></div></td></tr></table></figure><h5 id="ç¡®å®šèµ‹å€¼æ–­è¨€"><a href="#ç¡®å®šèµ‹å€¼æ–­è¨€" class="headerlink" title="ç¡®å®šèµ‹å€¼æ–­è¨€"></a>ç¡®å®šèµ‹å€¼æ–­è¨€</h5><p>å…è®¸åœ¨å®ä¾‹å±æ€§å’Œå˜é‡å£°æ˜åé¢æ”¾ç½®ä¸€ä¸ª <code>&quot;!&quot;</code> å·,ä»è€Œå‘Šè¯‰ TypeScript è¯¥å±æ€§ä¼šè¢«æ˜ç¡®åœ°èµ‹å€¼ã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£å®ƒçš„ä½œç”¨ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸ªå…·ä½“çš„ä¾‹å­ï¼š</p><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">let</span> <span class="hljs-attr">x</span>: number;<br><span class="hljs-title function_">initialize</span>();<br><br><span class="hljs-comment">// Variable &#x27;x&#x27; is used before being assigned.(2454) å¾ˆæ˜æ˜¾è¯¥å¼‚å¸¸ä¿¡æ¯æ˜¯è¯´å˜é‡ x åœ¨èµ‹å€¼å‰è¢«ä½¿ç”¨</span><br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">2</span> * x); <span class="hljs-comment">// Error</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">initialize</span>(<span class="hljs-params"></span>) &#123;<br>  x = <span class="hljs-number">10</span>;<br>&#125;<br><br><span class="hljs-comment">// è§£å†³è¯¥é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç¡®å®šèµ‹å€¼æ–­è¨€ï¼š</span><br><span class="hljs-keyword">let</span> x!: number;<br><span class="hljs-title function_">initialize</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-number">2</span> * x); <span class="hljs-comment">// Ok</span><br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">initialize</span>(<span class="hljs-params"></span>) &#123;<br>  x = <span class="hljs-number">10</span>;<br>&#125;<br></code></pre></div></td></tr></table></figure><p>é€šè¿‡ <code>let x!: number;</code> ç¡®å®šèµ‹å€¼æ–­è¨€ï¼ŒTypeScript ç¼–è¯‘å™¨å°±ä¼šçŸ¥é“è¯¥å±æ€§ä¼šè¢«æ˜ç¡®åœ°èµ‹å€¼ã€‚</p><h4 id="ç±»å‹æ‹“å®½ï¼ˆType-Wideningï¼‰"><a href="#ç±»å‹æ‹“å®½ï¼ˆType-Wideningï¼‰" class="headerlink" title="ç±»å‹æ‹“å®½ï¼ˆType Wideningï¼‰"></a>ç±»å‹æ‹“å®½ï¼ˆType Wideningï¼‰</h4><h4 id="ç±»å‹ç¼©å°ï¼ˆType-Narrowingï¼‰"><a href="#ç±»å‹ç¼©å°ï¼ˆType-Narrowingï¼‰" class="headerlink" title="ç±»å‹ç¼©å°ï¼ˆType Narrowingï¼‰"></a>ç±»å‹ç¼©å°ï¼ˆType Narrowingï¼‰</h4><h3 id="03-ç¼–è¯‘é€‰é¡¹-tsconfig-jsonğŸ’•"><a href="#03-ç¼–è¯‘é€‰é¡¹-tsconfig-jsonğŸ’•" class="headerlink" title="03 ç¼–è¯‘é€‰é¡¹ tsconfig.jsonğŸ’•"></a>03 ç¼–è¯‘é€‰é¡¹ tsconfig.jsonğŸ’•</h3><h4 id="ç¼–è¯‘é€‰é¡¹"><a href="#ç¼–è¯‘é€‰é¡¹" class="headerlink" title="ç¼–è¯‘é€‰é¡¹"></a>ç¼–è¯‘é€‰é¡¹</h4><h5 id="include"><a href="#include" class="headerlink" title="include"></a>include</h5><p>ç¤ºä¾‹ï¼š [path1,path2â€¦]</p><p>ä½œç”¨ï¼šè§„å®šéœ€è¦ç¼–è¯‘çš„è·¯å¾„</p><h5 id="exclude"><a href="#exclude" class="headerlink" title="exclude"></a>exclude</h5><p>ç¤ºä¾‹ï¼š [path1,path2â€¦]</p><p>ä½œç”¨ï¼šæ’é™¤è§„å®šä¸éœ€è¦ç¼–è¯‘çš„è·¯å¾„</p><h5 id="compilerOptions"><a href="#compilerOptions" class="headerlink" title="compilerOptions"></a><a href="https://www.tslang.cn/docs/handbook/compiler-options.html">compilerOptions</a></h5><p>å¸¸è§çš„ç¼–è¯‘é€‰é¡¹ï¼š</p><table><thead><tr><th>é€‰é¡¹</th><th>ç±»å‹</th><th>é»˜è®¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>target</td><td>string</td><td>â€œES3â€</td><td>æŒ‡å®š<code>ECMAScript</code>ç›®æ ‡ç‰ˆæœ¬</td></tr><tr><td>module</td><td>string</td><td>target === â€œES6â€ ? â€œES6â€ : â€œcommonjsâ€</td><td>æŒ‡å®šç”Ÿæˆå“ªä¸ªæ¨¡å—ç³»ç»Ÿä»£ç </td></tr><tr><td>lib</td><td>string[]</td><td></td><td>ç¼–è¯‘è¿‡ç¨‹ä¸­éœ€è¦å¼•å…¥çš„åº“æ–‡ä»¶çš„åˆ—è¡¨ã€‚</td></tr><tr><td>outDir</td><td>string</td><td></td><td>é‡å®šå‘è¾“å‡ºç›®å½•ã€‚</td></tr><tr><td>outFile</td><td>string</td><td></td><td>å°†è¾“å‡ºæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶ã€‚</td></tr><tr><td>removeComments</td><td>boolean</td><td>false</td><td>ç¼–è¯‘åç§»é™¤æ³¨é‡Š</td></tr><tr><td>allowJs</td><td>boolean</td><td>false</td><td>æ˜¯å¦ç¼–è¯‘ js æ–‡ä»¶</td></tr><tr><td>checkJs</td><td>boolean</td><td>false</td><td>åœ¨ <code>.js</code>æ–‡ä»¶ä¸­æŠ¥å‘Šé”™è¯¯ã€‚ä¸ <code>--allowJs</code>é…åˆä½¿ç”¨ã€‚</td></tr><tr><td>noEmitOnError</td><td>boolean</td><td>false</td><td>ç¼–è¯‘ï¼Œä½†ä¸ç”Ÿæˆç¼–è¯‘åçš„æ–‡ä»¶</td></tr><tr><td>noEmitOnError</td><td>boolean</td><td>false</td><td>æŠ¥é”™æ—¶ä¸ç”Ÿæˆè¾“å‡ºæ–‡ä»¶</td></tr><tr><td>alwaysStrict</td><td>boolean</td><td>false</td><td>ä»¥ä¸¥æ ¼æ¨¡å¼è§£æå¹¶ä¸ºæ¯ä¸ªæºæ–‡ä»¶ç”Ÿæˆ <code>&quot;use strict&quot;</code>è¯­å¥</td></tr><tr><td>noImplicitAny</td><td>boolean</td><td>false</td><td>åœ¨è¡¨è¾¾å¼å’Œå£°æ˜ä¸Šæœ‰éšå«çš„ <code>any</code>ç±»å‹æ—¶æŠ¥é”™ã€‚</td></tr></tbody></table><h3 id="03-ä½¿ç”¨-webpack-æ‰“åŒ…-ts-ä»£ç -ğŸ“¦"><a href="#03-ä½¿ç”¨-webpack-æ‰“åŒ…-ts-ä»£ç -ğŸ“¦" class="headerlink" title="03 ä½¿ç”¨ webpack æ‰“åŒ… ts ä»£ç  ğŸ“¦"></a>03 ä½¿ç”¨ webpack æ‰“åŒ… ts ä»£ç  ğŸ“¦</h3><h4 id="webpack-é…ç½®"><a href="#webpack-é…ç½®" class="headerlink" title="webpack é…ç½®"></a>webpack é…ç½®</h4><figure class="highlight js"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><span class="hljs-comment">// HTMLæ¨¡æ¿, è‡ªåŠ¨å°†æ‰“åŒ…å¥½çš„æ¨¡å—å¾—å¼•å…¥åˆ° htmlå†…</span><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>)<br><span class="hljs-comment">// è‡ªåŠ¨æ¸…ç† dist æ–‡ä»¶ç›®å½•ä¸‹çš„è€æ–‡ä»¶</span><br><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">CleanWebpackPlugin</span> &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;clean-webpack-plugin&#x27;</span>)<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-comment">// å¼€å‘æ¨¡å¼ä¸‹</span><br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>  <span class="hljs-comment">// å…¥å£</span><br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/index.ts&#x27;</span>,<br>  <span class="hljs-comment">// å‡ºå£</span><br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;bundle.js&#x27;</span>,<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>),<br>    <span class="hljs-attr">environment</span>: &#123;<br>      <span class="hljs-comment">// ç”¨äºå…¼å®¹ IE æµè§ˆå™¨</span><br>      <span class="hljs-attr">arrowFunction</span>: <span class="hljs-literal">false</span>,<br>    &#125;,<br>  &#125;,<br>  <span class="hljs-comment">// æ¨¡å—</span><br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      <span class="hljs-comment">// ç”¨äºè§£æ ts æ–‡ä»¶æ ¼å¼è§„åˆ™</span><br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.ts$/</span>,<br>        <span class="hljs-attr">use</span>: [<br>          <span class="hljs-comment">// é…ç½® Babel</span><br>          &#123;<br>            <span class="hljs-comment">// loder</span><br>            <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;babel-loader&#x27;</span>,<br>            <span class="hljs-comment">// è®¾ç½® babel</span><br>            <span class="hljs-attr">options</span>: &#123;<br>              <span class="hljs-comment">// è®¾ç½®é¢„å®šä¹‰å¾—ç¯å¢ƒ</span><br>              <span class="hljs-attr">presets</span>: [<br>                [<br>                  <span class="hljs-comment">// æŒ‡å®šç¯å¢ƒå¾—æ’ä»¶</span><br>                  <span class="hljs-string">&#x27;@babel/preset-env&#x27;</span>,<br>                  <span class="hljs-comment">// é…ç½®ä¿¡æ¯</span><br>                  &#123;<br>                    <span class="hljs-comment">// éœ€è¦å…¼å®¹ç›®æ ‡æµè§ˆå™¨</span><br>                    <span class="hljs-attr">targets</span>: &#123;<br>                      <span class="hljs-attr">ie</span>: <span class="hljs-number">11</span>,<br>                    &#125;,<br>                    <span class="hljs-comment">// æŒ‡å®šcore.jsçš„ç‰ˆæœ¬</span><br>                    <span class="hljs-attr">corejs</span>: <span class="hljs-string">&#x27;3&#x27;</span>,<br>                    <span class="hljs-comment">// ä½¿ç”¨corejsæ–¹å¼ &quot;usage&quot;,è¡¨ç¤ºæŒ‰éœ€åŠ è½½</span><br>                    <span class="hljs-attr">useBuiltIns</span>: <span class="hljs-string">&#x27;usage&#x27;</span>,<br>                  &#125;,<br>                ],<br>              ],<br>            &#125;,<br>          &#125;,<br>          <span class="hljs-string">&#x27;ts-loader&#x27;</span>,<br>        ],<br>        <span class="hljs-comment">// æ’é™¤çš„æ–‡ä»¶</span><br>        <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span>,<br>      &#125;,<br>    ],<br>  &#125;,<br><br>  <span class="hljs-comment">// é…ç½® Webpack æ’ä»¶</span><br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">CleanWebpackPlugin</span>(),<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>((options = &#123; <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;./src/index.html&#x27;</span> &#125;)),<br>  ],<br><br>  <span class="hljs-comment">// é…ç½® webpack-dev-server</span><br>  <span class="hljs-attr">devServer</span>: &#123;<br>    <span class="hljs-attr">static</span>: &#123;<br>      <span class="hljs-attr">directory</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;public&#x27;</span>),<br>    &#125;,<br>    <span class="hljs-attr">port</span>: <span class="hljs-number">8081</span>,<br>  &#125;,<br><br>  <span class="hljs-comment">// ç”¨æ¥è®¾ç½®å¼•ç”¨æ¨¡å—</span><br>  <span class="hljs-attr">resolve</span>: &#123;<br>    <span class="hljs-comment">// æ‰©å±• ts å¯ä»¥ä½¿ç”¨æ¨¡å—</span><br>    <span class="hljs-attr">extensions</span>: [<span class="hljs-string">&#x27;.ts&#x27;</span>, <span class="hljs-string">&#x27;.js&#x27;</span>],<br>  &#125;,<br>&#125;<br></code></pre></div></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>TypeScript</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JavaScript</tag>
      
      <tag>TypeScript</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é…ç½® Gitlab, Github, Gitee çš„ç¯å¢ƒ</title>
    <link href="/2022/02/15/%E9%85%8D%E7%BD%AE%20Gitlab,%20Github,%20Gitee%20%E7%9A%84%E7%8E%AF%E5%A2%83/"/>
    <url>/2022/02/15/%E9%85%8D%E7%BD%AE%20Gitlab,%20Github,%20Gitee%20%E7%9A%84%E7%8E%AF%E5%A2%83/</url>
    
    <content type="html"><![CDATA[<h2 id="é…ç½®-Gitlab-Github-Gitee-çš„ç¯å¢ƒ"><a href="#é…ç½®-Gitlab-Github-Gitee-çš„ç¯å¢ƒ" class="headerlink" title="é…ç½® Gitlab, Github, Gitee çš„ç¯å¢ƒ"></a>é…ç½® Gitlab, Github, Gitee çš„ç¯å¢ƒ</h2><h3 id="01-é—®é¢˜æè¿°ï¼š"><a href="#01-é—®é¢˜æè¿°ï¼š" class="headerlink" title="01 é—®é¢˜æè¿°ï¼š"></a>01 é—®é¢˜æè¿°ï¼š</h3><p>ä½¿ç”¨ Hexo æ­å»ºæ’­å®¢ï¼Œé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼ŒGithub å’Œ Gitlab çš„ç”¨æˆ·åå’Œé‚®ç®±éƒ½ä¸ä¸€æ ·ï¼Œæ‰€ä»¥æ¯æ¬¡ä»£ç  push,é‚®ç®±å’Œç”¨æˆ·åéƒ½å¾—æ”¹äº†æ”¹å»ã€‚å› æ­¤å°±éœ€è¦é…ç½®ä¸‰è€…å…±å­˜çš„ Git ç¯å¢ƒã€‚</p><h3 id="02-è§£å†³é—®é¢˜ï¼š"><a href="#02-è§£å†³é—®é¢˜ï¼š" class="headerlink" title="02 è§£å†³é—®é¢˜ï¼š"></a>02 è§£å†³é—®é¢˜ï¼š</h3><p>ä¸‹é¢è¿™ä¸ªé“¾æ¥æ˜¯æˆ‘åœ¨ç½‘ä¸Šæ‰¾åˆ°çš„ä¸é”™çš„è§£å†³æ–¹æ¡ˆã€‚</p><p><a href="https://www.cnblogs.com/tooyi/p/13677190.html">é…ç½® github å’Œ gitee(ç äº‘)çš„ Git ç¯å¢ƒ</a></p><h3 id="03-è¡¥å……-config-æ–‡ä»¶å¸¸è§é…ç½®é¡¹ï¼š"><a href="#03-è¡¥å……-config-æ–‡ä»¶å¸¸è§é…ç½®é¡¹ï¼š" class="headerlink" title="03 è¡¥å…… config æ–‡ä»¶å¸¸è§é…ç½®é¡¹ï¼š"></a>03 è¡¥å…… config æ–‡ä»¶å¸¸è§é…ç½®é¡¹ï¼š</h3><figure class="highlight ini"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ini"><span class="hljs-comment">#é…ç½®ç¤ºä¾‹</span><br><span class="hljs-comment">#Host åé¢æ˜¯åˆ«å</span><br><span class="hljs-comment">#HostName ä¸ºIP</span><br><span class="hljs-comment">#Portä¸ºç«¯å£</span><br><span class="hljs-comment">#Userä¸ºç”¨æˆ·å</span><br><span class="hljs-comment">#IdentityFileä¸ºè‡ªå·±IDç§é’¥</span><br><span class="hljs-comment">#PreferredAuthentications publickey  # é¦–é€‰è®¤è¯æ–¹å¼</span><br></code></pre></div></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><blockquote><p>aa å…¬å¸</p><p>gitlab åœ°å€ï¼šhttp:// xx.xx.xx.xx</p><p>email: <a href="mailto:&#x78;&#x69;&#x61;&#111;&#109;&#x69;&#x6e;&#103;&#64;&#x61;&#x61;&#x2e;&#x63;&#111;&#109;">&#x78;&#x69;&#x61;&#111;&#109;&#x69;&#x6e;&#103;&#64;&#x61;&#x61;&#x2e;&#x63;&#111;&#109;</a></p><p>name: xiaoming</p></blockquote><figure class="highlight ini"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs ini"><span class="hljs-comment">#gitLab</span><br>Host xx.xx.xx.xx<br>HostName xx.xx.xx.xx<br>User xiaoming<br>    IdentityFile ~/.ssh/id_rsa.gitlab<br>    PreferredAuthentications publickey<br></code></pre></div></td></tr></table></figure><p>æµ‹è¯•ä¸€ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">$ ssh -T git@xx.xx.xx.xx<br>// OK: Welcome to GitLab, @xiaoming!<br></code></pre></div></td></tr></table></figure><p>ç»“å°¾ï¼š</p><p>åœ¨é¡¹ç›® git ä»“åº“ä¸‹,å®šä¹‰è‡ªå·±çš„ <code>ç”¨æˆ·å</code> å’Œ <code>email</code></p><figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">$ git config --<span class="hljs-built_in">local</span> user.name <span class="hljs-string">&quot;xiaoming&quot;</span><br><br>$ git config --<span class="hljs-built_in">local</span> user.email <span class="hljs-string">&quot;xiaoming@aa.com&quot;</span><br></code></pre></div></td></tr></table></figure><p>æœ€åå°±å¯ä»¥æ„‰å¿«æäº¤ä»£ç äº†â€¦</p>]]></content>
    
    
    <categories>
      
      <category>Windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Hexo</tag>
      
      <tag>ssh</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
